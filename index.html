<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üå°Ô∏è Â§ñÊ∞óÊ∏©„É¢„Éã„Çø„Éº</title>
    <meta name="description" content="„É™„Ç¢„É´„Çø„Ç§„É†Â§ñÊ∞óÊ∏©„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ">
    <meta name="robots" content="noindex, nofollow">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üå°Ô∏è</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.2.0/dist/chartjs-plugin-zoom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <style>
        :root {
            --bg-primary: #030712;
            --bg-secondary: #0f172a;
            --bg-card: rgba(15, 23, 42, 0.85);
            --border-color: rgba(99, 102, 241, 0.12);
            --border-glow: rgba(99, 102, 241, 0.4);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #64748b;
            --accent-orange: #fb923c;
            --accent-red: #f87171;
            --accent-blue: #60a5fa;
            --accent-cyan: #22d3ee;
            --accent-green: #4ade80;
            --accent-purple: #a78bfa;
            --shadow-glow: 0 0 60px rgba(99, 102, 241, 0.2);
            --shadow-card: 0 4px 24px rgba(0, 0, 0, 0.4);
            --temp-hue: 30;
        }

        /* Light Mode - Premium Design */
        html.light-mode {
            --bg-primary: linear-gradient(180deg, #dbeafe 0%, #e0f2fe 50%, #f0f9ff 100%);
            --bg-secondary: #ffffff;
            --bg-card: rgba(255, 255, 255, 0.85);
            --border-color: rgba(59, 130, 246, 0.15);
            --border-glow: rgba(59, 130, 246, 0.3);
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --shadow-glow: 0 0 60px rgba(59, 130, 246, 0.15);
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.08), 0 2px 8px rgba(0, 0, 0, 0.04);
        }

        html.light-mode body {
            background: linear-gradient(180deg, #dbeafe 0%, #e0f2fe 50%, #f0f9ff 100%);
            background-attachment: fixed;
        }

        html.light-mode .bg-orb {
            opacity: 0.4;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.3) 0%, transparent 70%);
        }

        html.light-mode .grid-pattern {
            opacity: 0.02;
        }

        /* =====================================================
           DESIGN IMPROVEMENTS - Transitions & Hover Effects
           ===================================================== */

        /* Smooth theme transition for all elements */
        *,
        *::before,
        *::after {
            transition: background-color 0.4s ease, border-color 0.4s ease, box-shadow 0.4s ease;
        }

        /* Prevent pinch-zoom on mobile */
        html,
        body {
            touch-action: manipulation;
            -ms-touch-action: manipulation;
        }

        /* Card Hover Effects */
        .weather-hero-section,
        .comment-card,
        .precipitation-card,
        .ai-advisor-section,
        .chart-section,
        .mini-stats>div,
        .footer-stat {
            transition: transform 0.3s ease, box-shadow 0.3s ease, background-color 0.4s ease, border-color 0.4s ease;
        }

        .weather-hero-section:hover,
        .comment-card:hover,
        .precipitation-card:hover,
        .ai-advisor-section:hover,
        .chart-section:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-card), 0 12px 40px rgba(99, 102, 241, 0.15);
        }

        html.light-mode .weather-hero-section:hover,
        html.light-mode .comment-card:hover,
        html.light-mode .precipitation-card:hover,
        html.light-mode .ai-advisor-section:hover,
        html.light-mode .chart-section:hover {
            box-shadow: 0 12px 40px rgba(59, 130, 246, 0.12), 0 4px 12px rgba(0, 0, 0, 0.06);
        }

        .mini-stats>div:hover,
        .footer-stat:hover {
            transform: translateY(-1px) scale(1.02);
        }

        /* Enhanced Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg,
                    var(--bg-card) 25%,
                    rgba(99, 102, 241, 0.1) 50%,
                    var(--bg-card) 75%);
            background-size: 200% 100%;
            animation: skeleton-shimmer 1.5s ease-in-out infinite;
            border-radius: 8px;
        }

        @keyframes skeleton-shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        html.light-mode .skeleton {
            background: linear-gradient(90deg,
                    rgba(241, 245, 249, 0.8) 25%,
                    rgba(59, 130, 246, 0.08) 50%,
                    rgba(241, 245, 249, 0.8) 75%);
            background-size: 200% 100%;
        }

        /* Chart improvements */
        canvas {
            transition: opacity 0.3s ease;
        }

        /* Button and interactive elements */
        button,
        .clickable,
        [onclick] {
            transition: transform 0.2s ease, opacity 0.2s ease, background-color 0.3s ease;
        }

        button:active,
        .clickable:active {
            transform: scale(0.97);
        }

        /* Focus states for accessibility */
        button:focus-visible,
        a:focus-visible {
            outline: 2px solid var(--accent-blue);
            outline-offset: 2px;
        }

        /* Performance: GPU acceleration for animated elements */
        .bg-orb,
        .effect-rain,
        .effect-snow,
        .weather-hero-section {
            will-change: transform, opacity;
            backface-visibility: hidden;
        }

        /* Pull to Refresh */
        .pull-to-refresh {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 0;
            background: var(--bg-card);
            border-radius: 12px;
            margin-bottom: 0;
            height: 0;
            opacity: 0;
            overflow: hidden;
            transition: all 0.3s ease;
            pointer-events: none;
        }

        .pull-to-refresh.visible {
            opacity: 1;
            height: auto;
            padding: 12px;
            margin-bottom: 8px;
        }

        .pull-to-refresh.refreshing .pull-spinner {
            animation: spin 1s linear infinite;
        }

        .pull-spinner {
            font-size: 1.2rem;
            color: var(--accent-blue);
        }

        .pull-to-refresh span {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        @keyframes spin {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        /* Theme Toggle Button */
        .theme-toggle {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 100px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .theme-toggle:hover {
            border-color: var(--border-glow);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-primary);
            line-height: 1.5;
            overflow-x: hidden;
            transition: background 1s ease;
        }

        /* Dynamic Temperature Background */
        .background-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
            transition: all 2s ease;
        }

        .bg-orb {
            position: absolute;
            border-radius: 50%;
            filter: blur(120px);
            animation: float 20s ease-in-out infinite;
            transition: background 2s ease, opacity 2s ease;
        }

        .bg-orb-1 {
            width: 800px;
            height: 800px;
            background: radial-gradient(circle, hsla(var(--temp-hue), 90%, 60%, 0.2) 0%, transparent 70%);
            top: -300px;
            right: -200px;
        }

        .bg-orb-2 {
            width: 600px;
            height: 600px;
            background: radial-gradient(circle, hsla(calc(var(--temp-hue) + 180), 70%, 50%, 0.15) 0%, transparent 70%);
            bottom: -200px;
            left: -100px;
            animation-delay: -10s;
        }

        @keyframes float {

            0%,
            100% {
                transform: translate(0, 0) scale(1);
            }

            33% {
                transform: translate(30px, -30px) scale(1.05);
            }

            66% {
                transform: translate(-20px, 20px) scale(0.95);
            }
        }

        /* Grid Pattern */
        .grid-pattern {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(rgba(99, 102, 241, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(99, 102, 241, 0.03) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none;
            z-index: -2;
        }

        /* Weather Effects Container */
        .weather-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        /* --- Starry Night Effect --- */
        .effect-stars {
            background-image:
                radial-gradient(1px 1px at 10% 10%, #fff, transparent),
                radial-gradient(1px 1px at 20% 40%, #fff, transparent),
                radial-gradient(1px 1px at 30% 70%, #fff, transparent),
                radial-gradient(2px 2px at 40% 20%, #fff, transparent),
                radial-gradient(1px 1px at 50% 50%, #fff, transparent),
                radial-gradient(2px 2px at 60% 80%, #fff, transparent),
                radial-gradient(1px 1px at 70% 30%, #fff, transparent),
                radial-gradient(1px 1px at 80% 60%, #fff, transparent),
                radial-gradient(2px 2px at 90% 10%, #fff, transparent),
                radial-gradient(1px 1px at 5% 90%, #fff, transparent);
            background-size: 500px 500px;
            opacity: 0;
            transition: opacity 2s ease;
            animation: twinkle 4s infinite alternate;
        }

        .effect-stars::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                radial-gradient(1px 1px at 15% 15%, #fff, transparent),
                radial-gradient(2px 2px at 25% 45%, #fff, transparent),
                radial-gradient(1px 1px at 35% 75%, #fff, transparent),
                radial-gradient(1px 1px at 45% 25%, #fff, transparent),
                radial-gradient(2px 2px at 55% 55%, #fff, transparent),
                radial-gradient(1px 1px at 65% 85%, #fff, transparent),
                radial-gradient(2px 2px at 75% 35%, #fff, transparent),
                radial-gradient(1px 1px at 85% 65%, #fff, transparent);
            background-size: 400px 400px;
            animation: twinkle 6s infinite alternate-reverse;
        }

        @keyframes twinkle {
            0% {
                opacity: 0.3;
                transform: translateY(0);
            }

            100% {
                opacity: 0.8;
                transform: translateY(-2px);
            }
        }

        /* --- Rain Effect (Enhanced Multi-Layer Parallax) --- */
        .effect-rain {
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* Base layer (middle distance) */
        .effect-rain::before {
            content: '';
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 200%;
            background-image:
                repeating-linear-gradient(100deg,
                    transparent,
                    transparent 5px,
                    rgba(174, 194, 224, 0.15) 5px,
                    rgba(174, 194, 224, 0.15) 6px);
            background-size: 100% 100%;
            transform: skewX(-10deg);
            animation: rain-fall-mid 0.7s linear infinite;
            pointer-events: none;
        }

        /* Front layer (closest, fastest, thicker) */
        .effect-rain::after {
            content: '';
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 200%;
            background-image:
                repeating-linear-gradient(100deg,
                    transparent,
                    transparent 8px,
                    rgba(174, 194, 224, 0.25) 8px,
                    rgba(174, 194, 224, 0.25) 10px);
            background-size: 100% 100%;
            transform: skewX(-12deg);
            animation: rain-fall-front 0.5s linear infinite;
            pointer-events: none;
        }

        /* Back layer (farthest, slowest, thinner, blurred) via extra element */
        .effect-rain-back {
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 200%;
            background-image:
                repeating-linear-gradient(100deg,
                    transparent,
                    transparent 3px,
                    rgba(174, 194, 224, 0.08) 3px,
                    rgba(174, 194, 224, 0.08) 4px);
            background-size: 100% 100%;
            transform: skewX(-8deg);
            filter: blur(1px);
            animation: rain-fall-back 1.2s linear infinite;
            pointer-events: none;
            opacity: 0;
            transition: opacity 1s ease;
        }

        .effect-rain.active,
        .effect-rain.active::before,
        .effect-rain.active::after {
            opacity: 1;
        }

        .effect-rain-back.active {
            opacity: 0.7;
        }

        @keyframes rain-fall-front {
            0% {
                transform: skewX(-12deg) translateY(-50%);
            }

            100% {
                transform: skewX(-12deg) translateY(0%);
            }
        }

        @keyframes rain-fall-mid {
            0% {
                transform: skewX(-10deg) translateY(-50%);
            }

            100% {
                transform: skewX(-10deg) translateY(0%);
            }
        }

        @keyframes rain-fall-back {
            0% {
                transform: skewX(-8deg) translateY(-50%);
            }

            100% {
                transform: skewX(-8deg) translateY(0%);
            }
        }

        /* --- Heavy Rain (more intense) --- */
        .effect-rain.heavy::before {
            animation-duration: 0.5s;
        }

        .effect-rain.heavy::after {
            animation-duration: 0.35s;
            background-image:
                repeating-linear-gradient(100deg,
                    transparent,
                    transparent 6px,
                    rgba(174, 194, 224, 0.35) 6px,
                    rgba(174, 194, 224, 0.35) 9px);
        }

        /* --- Lightning Flash Effect --- */
        .lightning-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0);
            pointer-events: none;
            z-index: 1000;
            transition: background 0.1s ease;
        }

        .lightning-flash.active {
            animation: lightning 0.3s ease-out;
        }

        @keyframes lightning {
            0% {
                background: rgba(200, 220, 255, 0);
            }

            10% {
                background: rgba(200, 220, 255, 0.9);
            }

            20% {
                background: rgba(200, 220, 255, 0.2);
            }

            30% {
                background: rgba(200, 220, 255, 0.8);
            }

            50% {
                background: rgba(200, 220, 255, 0.1);
            }

            100% {
                background: rgba(200, 220, 255, 0);
            }
        }

        /* --- Wet Window Blur Effect (during rain) --- */
        .weather-effects.rainy .bg-orb {
            filter: blur(150px);
            transition: filter 2s ease;
        }

        .weather-effects.rainy~.grid-pattern {
            opacity: 0.02;
            filter: blur(1px);
        }

        /* --- Snow Effect --- */
        .effect-snow {
            background-image:
                radial-gradient(3px 3px at 20% 30%, rgba(255, 255, 255, 0.8), transparent),
                radial-gradient(2px 2px at 40% 70%, rgba(255, 255, 255, 0.8), transparent),
                radial-gradient(4px 4px at 60% 20%, rgba(255, 255, 255, 0.8), transparent),
                radial-gradient(3px 3px at 80% 60%, rgba(255, 255, 255, 0.8), transparent);
            background-size: 200px 200px;
            opacity: 0;
            transition: opacity 2s ease;
        }

        .effect-snow.active {
            animation: snow-fall 8s linear infinite;
        }

        @keyframes snow-fall {
            0% {
                transform: translateY(-200px);
            }

            100% {
                transform: translateY(200px);
            }
        }

        /* --- Clouds/Fog Effect --- */
        .effect-clouds {
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 60%);
            background-size: 200% 100%;
            filter: blur(40px);
            opacity: 0;
            transition: opacity 2s ease;
            transform-origin: center;
        }

        .effect-clouds.active {
            animation: cloud-drift 30s linear infinite alternate;
        }

        @keyframes cloud-drift {
            0% {
                transform: translateX(-10%);
            }

            100% {
                transform: translateX(10%);
            }
        }

        /* --- Sun Glow/Flare Effect --- */
        .effect-sun {
            background: radial-gradient(circle at 80% 10%, rgba(255, 200, 0, 0.15) 0%, rgba(255, 200, 0, 0.05) 30%, transparent 70%);
            mix-blend-mode: screen;
            opacity: 0;
            transition: opacity 2s ease;
        }

        .effect-sun.active {
            animation: sun-pulse 10s ease-in-out infinite alternate;
        }

        @keyframes sun-pulse {
            0% {
                transform: scale(1);
                opacity: 0.6;
            }

            100% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        /* Dark/Light Mode Adaptations */
        html.light-mode .effect-stars {
            display: none;
        }

        /* No stars in day */
        html.light-mode .effect-rain {
            background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(51, 65, 85, 0.15) 50%, rgba(0, 0, 0, 0) 100%);
        }

        html.light-mode .effect-snow {
            background-image:
                radial-gradient(3px 3px at 20% 30%, rgba(203, 213, 225, 0.6), transparent),
                radial-gradient(2px 2px at 40% 70%, rgba(203, 213, 225, 0.6), transparent),
                radial-gradient(4px 4px at 60% 20%, rgba(203, 213, 225, 0.6), transparent),
                radial-gradient(3px 3px at 80% 60%, rgba(203, 213, 225, 0.6), transparent);
        }

        /* Glassmorphism Refinement */
        .stat-card,
        .chart-card,
        .footer-stats {
            background: var(--bg-card);
            border: 1px solid rgba(255, 255, 255, 0.08);
            /* Softer border */
            box-shadow:
                0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            /* Inner highlight */
        }

        html.light-mode .stat-card,
        html.light-mode .chart-card,
        html.light-mode .footer-stats {
            border-color: rgba(99, 102, 241, 0.1);
            box-shadow:
                0 4px 20px rgba(0, 0, 0, 0.03),
                0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .container {
            max-width: 1440px;
            margin: 0 auto;
            padding: 32px;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: nowrap;
            gap: 8px;
        }

        .status-info {
            display: flex;
            align-items: center;
            gap: 6px;
            flex-wrap: nowrap;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .status-info::-webkit-scrollbar {
            display: none;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 4px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            white-space: nowrap;
            flex-shrink: 0;
        }

        .status-item strong {
            color: var(--text-primary);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            background: #22c55e;
            border-radius: 50%;
            animation: pulse-dot 2s infinite;
        }

        @keyframes pulse-dot {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        html.light-mode .status-item {
            background: rgba(241, 245, 249, 0.9);
            border-color: rgba(203, 213, 225, 0.5);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .logo-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 0 20px hsla(var(--temp-hue), 90%, 60%, 0.5));
            transition: filter 2s ease;
        }

        .logo h1 {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, hsl(var(--temp-hue), 90%, 65%) 0%, hsl(calc(var(--temp-hue) + 30), 80%, 60%) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            transition: background 2s ease;
        }

        /* Weather Hero Section (Redesigned) */
        .weather-hero {
            text-align: center;
            margin-top: 12px;
            margin-bottom: 20px;
            padding: 24px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            backdrop-filter: blur(12px);
        }

        html.light-mode .weather-hero {
            /* Base background with frost-based gray tint overlay */
            background: linear-gradient(rgba(180, 190, 200, calc(0.15 * var(--frost-intensity, 0))),
                    rgba(180, 190, 200, calc(0.15 * var(--frost-intensity, 0)))), rgba(241, 245, 249, 0.85);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border-color: rgba(203, 213, 225, calc(0.5 + 0.3 * var(--frost-intensity, 0)));
            backdrop-filter: blur(8px);
        }

        html.light-mode .weather-hero-info {
            /* Add slight gray overlay based on frost */
            background: linear-gradient(rgba(160, 180, 200, calc(0.1 * var(--frost-intensity, 0))),
                    rgba(160, 180, 200, calc(0.1 * var(--frost-intensity, 0)))), linear-gradient(135deg, rgba(59, 130, 246, 0.08) 0%, rgba(147, 197, 253, 0.12) 100%);
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        html.light-mode .weather-hero-icon {
            filter: drop-shadow(0 4px 12px rgba(251, 191, 36, 0.4));
        }

        html.light-mode .hero-temp-value {
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        /* Sunrise/Sunset display */
        .sun-times {
            position: absolute;
            top: 16px;
            right: 16px;
            display: flex;
            flex-direction: column;
            gap: 8px;
            text-align: right;
        }

        .sun-time-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .sun-icon {
            font-size: 1rem;
        }

        .sun-label {
            font-size: 0.7rem;
            opacity: 0.7;
        }

        .sun-value {
            font-weight: 500;
            color: var(--text-primary);
        }

        .weather-hero-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            margin-bottom: 16px;
        }

        .weather-hero-icon {
            font-size: 4rem;
            line-height: 1;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .weather-hero-temp {
            display: flex;
            align-items: flex-start;
            justify-content: center;
        }

        .hero-temp-value {
            font-size: 5rem;
            font-weight: 500;
            line-height: 1;
            /* Default color, will be overridden by JS for gradient effect */
            color: var(--text-primary);
            transition: color 0.5s ease, transform 0.3s ease, filter 0.3s ease;
        }

        /* Temperature update animation */
        .hero-temp-value.temp-updated {
            animation: tempPulse 1s ease-out;
        }

        @keyframes tempPulse {
            0% {
                transform: scale(1);
                filter: brightness(1) drop-shadow(0 0 0 transparent);
            }

            20% {
                transform: scale(1.15);
                filter: brightness(1.4) drop-shadow(0 0 30px rgba(255, 200, 100, 0.8));
            }

            50% {
                transform: scale(1.08);
                filter: brightness(1.2) drop-shadow(0 0 20px rgba(255, 200, 100, 0.5));
            }

            100% {
                transform: scale(1);
                filter: brightness(1) drop-shadow(0 0 0 transparent);
            }
        }

        /* Temperature color classes - gradient based on --temp-hue */
        .hero-temp-value.temp-freezing,
        .hero-temp-value.temp-cold,
        .hero-temp-value.temp-cool,
        .hero-temp-value.temp-mild,
        .hero-temp-value.temp-warm,
        .hero-temp-value.temp-hot,
        .hero-temp-value.temp-extreme {
            background: linear-gradient(135deg,
                    hsl(var(--temp-hue), 85%, 60%) 0%,
                    hsl(calc(var(--temp-hue) + 25), 80%, 55%) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            transition: background 2s ease;
        }

        /* Gradual frost effect using --frost-intensity (0 to 1) */
        /* Starts subtle at 5¬∞C, becomes fully white/frosty at -10¬∞C */
        .hero-temp-value.temp-cold,
        .hero-temp-value.temp-freezing {
            /* Dynamic white glow based on frost intensity */
            filter: drop-shadow(0 0 calc(15px * var(--frost-intensity, 0)) rgba(255, 255, 255, calc(0.8 * var(--frost-intensity, 0)))) drop-shadow(0 0 calc(30px * var(--frost-intensity, 0)) rgba(200, 230, 255, calc(0.6 * var(--frost-intensity, 0)))) drop-shadow(0 0 calc(50px * var(--frost-intensity, 0)) rgba(180, 220, 255, calc(0.4 * var(--frost-intensity, 0))));
        }

        /* < 0‚ÑÉ - add extra frosty white tint to gradient */
        .hero-temp-value.temp-freezing {
            /* Whiter gradient for freezing temperatures */
            background: linear-gradient(135deg,
                    hsl(200, calc(70% - 30% * var(--frost-intensity, 0)), calc(60% + 20% * var(--frost-intensity, 0))) 0%,
                    hsl(210, calc(60% - 25% * var(--frost-intensity, 0)), calc(55% + 25% * var(--frost-intensity, 0))) 50%,
                    hsl(220, calc(50% - 20% * var(--frost-intensity, 0)), calc(65% + 20% * var(--frost-intensity, 0))) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* > 30‚ÑÉ - extra glow for extreme heat */
        .hero-temp-value.temp-extreme {
            filter: drop-shadow(0 0 20px hsla(var(--temp-hue), 80%, 60%, 0.6));
        }

        .hero-temp-unit {
            font-size: 1.5rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-top: 12px;
            margin-left: 2px;
        }

        /* Decimal part styling - same size as integer */
        .temp-decimal {
            /* Same font-size as parent, no special styling */
        }

        /* Weather icon (no animation) */
        .weather-hero-icon {
            font-size: 4rem;
            line-height: 1;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
        }

        .weather-hero-condition {
            font-size: 1.2rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-top: 4px;
        }

        .weather-hero-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0;
            padding: 12px 16px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
            margin-top: 8px;
        }

        .weather-hero-info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 16px;
            min-width: 60px;
        }

        .weather-hero-info-item .info-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-bottom: 2px;
        }

        .weather-hero-info-item .info-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .weather-hero-info-item .info-unit {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .weather-hero-info-divider {
            width: 1px;
            height: 32px;
            background: rgba(148, 163, 184, 0.2);
        }

        /* Comment Card Section */
        .comment-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 16px 20px;
            margin-bottom: 24px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.5s ease;
        }

        .comment-card.show {
            opacity: 1;
            transform: translateY(0);
        }

        .comment-label {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .comment-content {
            font-size: 0.95rem;
            color: var(--text-primary);
            line-height: 1.6;
            white-space: normal;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        html.light-mode .comment-card {
            background: rgba(241, 245, 249, 0.85);
            border-color: rgba(203, 213, 225, 0.5);
        }

        /* Precipitation Chart Card */
        .precipitation-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .precipitation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .precipitation-title {
            font-size: 0.95rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .precipitation-time {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .precipitation-chart-container {
            height: 120px;
            position: relative;
        }

        .precipitation-legend {
            display: flex;
            justify-content: center;
            gap: 16px;
            margin-top: 8px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .legend-obs {
            color: #60a5fa;
        }

        .legend-forecast {
            color: #93c5fd;
        }

        html.light-mode .precipitation-card {
            background: rgba(241, 245, 249, 0.85);
            border-color: rgba(203, 213, 225, 0.5);
        }

        .rain-alert {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 12px;
            padding: 10px 14px;
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(99, 102, 241, 0.15));
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 10px;
            font-size: 0.85rem;
            color: var(--text-primary);
            animation: rain-pulse 2s ease-in-out infinite;
        }

        @keyframes rain-pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .rain-alert-icon {
            font-size: 1.1rem;
        }

        .rain-alert.raining {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.15), rgba(22, 163, 74, 0.15));
            border-color: rgba(34, 197, 94, 0.3);
        }

        html.light-mode .rain-alert {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(99, 102, 241, 0.1));
        }

        /* Moon Card Styles */
        .moon-card {
            background: linear-gradient(180deg, rgba(15, 23, 42, 0.98), rgba(10, 14, 26, 0.99));
            border-color: rgba(251, 191, 36, 0.2);
        }

        html.light-mode .moon-card {
            background: linear-gradient(180deg, rgba(255, 251, 235, 0.98), rgba(254, 249, 231, 0.99));
            border-color: rgba(251, 191, 36, 0.3);
        }

        /* Light mode: lighter SVG strokes for moon markers */
        html.light-mode .moon-card circle[stroke="#0f172a"] {
            stroke: rgba(100, 116, 139, 0.4);
            stroke-width: 1;
        }

        html.light-mode .moon-card #moonPosition {
            stroke: rgba(100, 116, 139, 0.3);
            stroke-width: 1;
        }

        /* Light mode: softer text shadow */
        html.light-mode .moon-card text[filter="url(#textShadow)"] {
            filter: none;
        }

        .moon-badge {
            background: linear-gradient(135deg, #fbbf24, #f59e0b) !important;
            color: #1e293b !important;
            font-weight: 600;
        }

        /* Info Bar */
        .moon-info-bar {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 12px;
            padding: 8px 0;
            flex-wrap: wrap;
        }

        .moon-info-group {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .moon-icon {
            font-size: 2rem;
            filter: drop-shadow(0 0 10px rgba(251, 191, 36, 0.4));
        }

        .moon-phase-name {
            font-size: 0.95rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .moon-stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .moon-stat-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #fbbf24;
        }

        .moon-stat-unit {
            font-size: 0.85rem;
            color: #fbbf24;
        }

        /* Main Arc Area */
        .moon-arc-main {
            width: 100%;
        }

        .moon-arc-svg {
            width: 100%;
            height: auto;
            min-height: 200px;
        }

        @media (max-width: 500px) {
            .moon-info-bar {
                gap: 12px;
            }

            .moon-arc-svg {
                min-height: 110px;
            }
        }

        .greeting-text {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .greeting-text .emoji {
            font-size: 1.5rem;
        }

        .weather-comment {
            font-size: 0.95rem;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            max-width: 90%;
            margin: 0 auto;
            line-height: 1.6;
            text-align: center;
        }

        .weather-comment .temp-highlight {
            color: hsl(var(--temp-hue), 85%, 65%);
            font-weight: 700;
            font-size: 1.1rem;
        }

        /* Alert Banner */
        .alert-banner {
            background: linear-gradient(135deg, rgba(251, 146, 60, 0.2) 0%, rgba(251, 146, 60, 0.1) 100%);
            border: 1px solid rgba(251, 146, 60, 0.4);
            border-radius: 12px;
            padding: 12px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: alertPulse 2s ease-in-out infinite;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .alert-banner.alert-warning {
            background: linear-gradient(135deg, rgba(250, 204, 21, 0.2) 0%, rgba(250, 204, 21, 0.1) 100%);
            border-color: rgba(250, 204, 21, 0.4);
        }

        .alert-banner.alert-severe {
            background: linear-gradient(135deg, rgba(248, 113, 113, 0.2) 0%, rgba(248, 113, 113, 0.1) 100%);
            border-color: rgba(248, 113, 113, 0.4);
        }

        .alert-banner.alert-special {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2) 0%, rgba(168, 85, 247, 0.1) 100%);
            border-color: rgba(168, 85, 247, 0.4);
        }

        .alert-icon {
            font-size: 1.3rem;
        }

        #alertText {
            color: var(--text-primary);
            font-weight: 500;
            flex: 1;
        }

        .alert-link-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .alert-banner:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .alert-banner:hover .alert-link-hint {
            opacity: 1;
        }

        /* AI Advisor Section */
        .ai-advisor-section {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(139, 92, 246, 0.15) 50%, rgba(236, 72, 153, 0.1) 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 16px 20px;
            margin-bottom: 20px;
            display: none;
            animation: fadeInUp 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }

        /* Gemini-style border shimmer - traces the outline once */
        .ai-advisor-section.show {
            display: block;
            animation: fadeInUp 0.5s ease-out, aiShimmerBorder 3.5s linear;
        }

        @keyframes aiShimmerBorder {
            0% {
                box-shadow: 0 0 0 0 transparent;
            }

            2% {
                box-shadow: 0 -2px 15px 1px rgba(139, 92, 246, 0.35);
            }

            5% {
                box-shadow: 0 -4px 28px 3px rgba(139, 92, 246, 0.65);
            }

            9% {
                box-shadow: 2px -4px 32px 4px rgba(139, 92, 246, 0.7);
            }

            14% {
                box-shadow: 4px -2px 35px 4px rgba(99, 102, 241, 0.7);
            }

            19% {
                box-shadow: 5px 0px 35px 4px rgba(99, 102, 241, 0.7);
            }

            24% {
                box-shadow: 5px 2px 35px 4px rgba(129, 140, 248, 0.65);
            }

            29% {
                box-shadow: 4px 4px 32px 4px rgba(167, 139, 250, 0.65);
            }

            34% {
                box-shadow: 2px 5px 35px 4px rgba(192, 132, 252, 0.65);
            }

            39% {
                box-shadow: 0px 5px 35px 4px rgba(236, 72, 153, 0.65);
            }

            44% {
                box-shadow: -2px 5px 35px 4px rgba(236, 72, 153, 0.7);
            }

            49% {
                box-shadow: -4px 4px 32px 4px rgba(192, 132, 252, 0.65);
            }

            54% {
                box-shadow: -5px 2px 35px 4px rgba(167, 139, 250, 0.65);
            }

            59% {
                box-shadow: -5px 0px 35px 4px rgba(139, 92, 246, 0.7);
            }

            64% {
                box-shadow: -4px -2px 35px 4px rgba(139, 92, 246, 0.7);
            }

            69% {
                box-shadow: -2px -4px 32px 4px rgba(139, 92, 246, 0.65);
            }

            74% {
                box-shadow: 0px -4px 28px 3px rgba(139, 92, 246, 0.55);
            }

            80% {
                box-shadow: 0px -3px 22px 2px rgba(139, 92, 246, 0.4);
            }

            86% {
                box-shadow: 0px -2px 16px 1px rgba(139, 92, 246, 0.3);
            }

            92% {
                box-shadow: 0px -1px 10px 0px rgba(139, 92, 246, 0.18);
            }

            96% {
                box-shadow: 0px 0px 5px 0px rgba(139, 92, 246, 0.08);
            }

            100% {
                box-shadow: 0 0 0 0 transparent;
            }
        }

        .ai-advisor-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .ai-advisor-icon {
            font-size: 1.2rem;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-advisor-label {
            font-weight: 600;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-advisor-time {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-left: auto;
        }

        .ai-advisor-content {
            font-size: 1rem;
            line-height: 1.6;
            color: var(--text-primary);
        }

        .ai-advisor-text {
            display: inline;
        }

        .ai-advisor-expand {
            display: inline-block;
            background: none;
            border: none;
            color: var(--accent-blue);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            padding: 0;
            margin-left: 8px;
        }

        .ai-advisor-expand:hover {
            text-decoration: underline;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes alertPulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.8;
            }
        }

        .status-info {
            display: flex;
            gap: 20px;
            font-size: 0.85rem;
            color: var(--text-muted);
            flex-wrap: wrap;
            align-items: center;
        }



        .status-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: var(--bg-card);
            border-radius: 100px;
            border: 1px solid var(--border-color);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-green);
            box-shadow: 0 0 12px var(--accent-green);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        /* Skeleton Loading */
        .skeleton {
            background: linear-gradient(90deg, rgba(100, 116, 139, 0.2) 25%, rgba(100, 116, 139, 0.4) 50%, rgba(100, 116, 139, 0.2) 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
            border-radius: 8px;
            display: inline-block;
        }

        @keyframes shimmer {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }

        /* Main Stats Grid */
        .main-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .stat-card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 28px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-card);
        }

        .stat-card:hover {
            transform: translateY(-6px);
            border-color: var(--border-glow);
            box-shadow: var(--shadow-glow), var(--shadow-card);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stat-card.temp::before {
            background: linear-gradient(90deg, hsl(var(--temp-hue), 90%, 60%), hsl(calc(var(--temp-hue) + 30), 80%, 55%));
            transition: background 2s ease;
        }

        .stat-card.humidity::before {
            background: linear-gradient(135deg, #60a5fa 0%, #22d3ee 100%);
        }

        .stat-card.high::before {
            background: #f87171;
        }

        .stat-card.low::before {
            background: #22d3ee;
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .stat-icon {
            font-size: 1.5rem;
        }

        .comfort-badge {
            font-size: 0.65rem;
            padding: 4px 10px;
            border-radius: 100px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.5s ease;
        }

        .comfort-badge.show {
            opacity: 1;
            transform: translateY(0);
        }

        .comfort-badge.hot {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
        }

        .comfort-badge.warm {
            background: rgba(251, 146, 60, 0.2);
            color: #fb923c;
        }

        .comfort-badge.comfort {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .comfort-badge.cool {
            background: rgba(96, 165, 250, 0.2);
            color: #60a5fa;
        }

        .comfort-badge.cold {
            background: rgba(34, 211, 238, 0.2);
            color: #22d3ee;
        }

        /* UV Badge styles */
        .uv-badge {
            font-size: 0.6rem;
            padding: 3px 8px;
            border-radius: 100px;
            font-weight: 600;
            margin-left: 8px;
        }

        .uv-badge.uv-low {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .uv-badge.uv-moderate {
            background: rgba(250, 204, 21, 0.2);
            color: #facc15;
        }

        .uv-badge.uv-high {
            background: rgba(251, 146, 60, 0.2);
            color: #fb923c;
        }

        .uv-badge.uv-very-high {
            background: rgba(248, 113, 113, 0.2);
            color: #f87171;
        }

        .uv-badge.uv-extreme {
            background: rgba(168, 85, 247, 0.2);
            color: #a855f7;
        }

        .stat-value.feels-like {
            color: #94a3b8;
        }

        .stat-value.uv {
            color: #94a3b8;
        }

        .stat-label {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-secondary);
            letter-spacing: 0.5px;
            margin-bottom: 12px;
        }

        .stat-value {
            font-size: 3.2rem;
            font-weight: 800;
            line-height: 1;
            display: flex;
            align-items: baseline;
            gap: 4px;
            transition: color 2s ease, text-shadow 2s ease;
        }

        .stat-value.temp {
            color: hsl(var(--temp-hue), 85%, 65%);
            text-shadow: 0 0 40px hsla(var(--temp-hue), 90%, 60%, 0.4);
        }

        .stat-value.humidity {
            color: var(--accent-cyan);
            text-shadow: 0 0 40px rgba(34, 211, 238, 0.3);
        }

        .stat-value.high {
            color: var(--accent-red);
            text-shadow: 0 0 40px rgba(248, 113, 113, 0.3);
        }

        .stat-value.low {
            color: var(--accent-blue);
            text-shadow: 0 0 40px rgba(96, 165, 250, 0.3);
        }

        .stat-unit {
            font-size: 1.5rem;
            font-weight: 600;
            opacity: 0.8;
        }

        /* Charts Grid */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }

        .chart-card {
            background: var(--bg-card);
            border-radius: 24px;
            padding: 28px;
            border: 1px solid var(--border-color);
            backdrop-filter: blur(20px);
            box-shadow: var(--shadow-card);
            transition: all 0.3s ease;
        }

        .chart-card:hover {
            border-color: rgba(99, 102, 241, 0.25);
        }

        .chart-card.full-width {
            grid-column: span 2;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            gap: 8px;
        }

        /* Drag handle */
        .drag-handle {
            cursor: grab;
            opacity: 0.4;
            font-size: 1.2rem;
            padding: 4px 8px;
            border-radius: 6px;
            transition: opacity 0.2s ease, background-color 0.2s ease;
            user-select: none;
        }

        .drag-handle:hover {
            opacity: 0.8;
            background: rgba(99, 102, 241, 0.1);
        }

        .drag-handle:active {
            cursor: grabbing;
        }

        /* Dragging states */
        .chart-card.dragging {
            opacity: 0.5;
            transform: scale(0.98);
            box-shadow: 0 8px 32px rgba(99, 102, 241, 0.3);
        }

        .chart-card.drag-over {
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px var(--accent-blue), var(--shadow-card);
        }

        .chart-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-badge {
            font-size: 0.65rem;
            padding: 6px 14px;
            border-radius: 100px;
            background: rgba(139, 92, 246, 0.15);
            color: var(--accent-purple);
            font-weight: 600;
            border: 1px solid rgba(139, 92, 246, 0.2);
        }

        .chart-container {
            height: 300px;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .chart-container canvas {
            width: 100% !important;
            height: 100% !important;
        }

        .chart-skeleton {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            transition: opacity 0.5s ease;
        }

        .chart-skeleton.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Footer Stats */
        .footer-stats {
            display: flex;
            justify-content: center;
            gap: 48px;
            margin-top: 32px;
            padding: 24px 40px;
            background: var(--bg-card);
            border-radius: 20px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-card);
            flex-wrap: wrap;
        }

        .footer-stat {
            text-align: center;
        }

        .footer-stat-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .footer-stat-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-secondary);
        }

        .footer-stat-value.highlight {
            color: var(--accent-orange);
            text-shadow: 0 0 20px rgba(251, 146, 60, 0.3);
        }

        .footer-stat-value.cool {
            color: var(--accent-blue);
        }

        .version-info {
            text-align: center;
            font-size: 0.65rem;
            color: var(--text-muted);
            opacity: 0.5;
            margin-top: 16px;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 1024px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .chart-card.full-width {
                grid-column: span 1;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            header {
                flex-direction: column;
                align-items: flex-start;
            }

            .main-stats {
                gap: 16px;
            }

            .stat-card {
                padding: 20px;
                border-radius: 20px;
            }

            .stat-value {
                font-size: 2.5rem;
            }

            .stat-unit {
                font-size: 1.2rem;
            }

            .chart-container {
                height: 250px;
            }

            .footer-stats {
                gap: 24px;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .main-stats {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }

            .stat-card {
                padding: 16px;
            }

            .stat-value {
                font-size: 2rem;
            }

            .stat-unit {
                font-size: 1rem;
            }

            .logo h1 {
                font-size: 1.3rem;
            }

            .chart-container {
                height: 200px;
            }
        }

        /* =====================================================
           MOON CARD STYLES - Premium Design
           ===================================================== */

        .chart-card.moon-card {
            background: linear-gradient(135deg,
                    rgba(15, 23, 42, 0.95) 0%,
                    rgba(30, 41, 59, 0.9) 50%,
                    rgba(15, 23, 42, 0.95) 100%);
            border: 1px solid rgba(251, 191, 36, 0.15);
            position: relative;
            overflow: hidden;
        }

        .chart-card.moon-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg,
                    transparent 0%,
                    rgba(251, 191, 36, 0.6) 50%,
                    transparent 100%);
        }

        .chart-card.moon-card:hover {
            border-color: rgba(251, 191, 36, 0.3);
            box-shadow: 0 8px 32px rgba(251, 191, 36, 0.1);
        }

        html.light-mode .chart-card.moon-card {
            background: linear-gradient(135deg,
                    rgba(255, 255, 255, 0.95) 0%,
                    rgba(254, 252, 232, 0.9) 50%,
                    rgba(255, 255, 255, 0.95) 100%);
            border-color: rgba(217, 119, 6, 0.2);
        }

        /* Moon Info Bar */
        .moon-info-bar {
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 12px 16px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            gap: 8px;
        }

        html.light-mode .moon-info-bar {
            background: rgba(251, 191, 36, 0.08);
        }

        .moon-info-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .moon-icon {
            font-size: 2rem;
            filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.5));
            animation: moonPulse 4s ease-in-out infinite;
        }

        @keyframes moonPulse {

            0%,
            100% {
                filter: drop-shadow(0 0 8px rgba(251, 191, 36, 0.5));
            }

            50% {
                filter: drop-shadow(0 0 16px rgba(251, 191, 36, 0.8));
            }
        }

        .moon-phase-name {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .moon-stat-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .moon-stat-value {
            font-size: 1.6rem;
            font-weight: 700;
            color: #fbbf24;
            font-feature-settings: 'tnum';
            line-height: 1;
        }

        .moon-stat-unit {
            font-size: 0.9rem;
            color: var(--text-muted);
            margin-left: 2px;
            vertical-align: baseline;
        }

        html.light-mode .moon-stat-value {
            color: #d97706;
        }

        /* Moon Arc Visualization */
        .moon-arc-main {
            padding: 8px;
            margin-top: 8px;
        }

        .moon-arc-svg {
            width: 100%;
            border-radius: 8px;
            background: radial-gradient(ellipse at center bottom,
                    rgba(30, 41, 59, 0.5) 0%,
                    transparent 70%);
        }

        html.light-mode .moon-arc-svg {
            background: radial-gradient(ellipse at center bottom,
                    rgba(251, 191, 36, 0.05) 0%,
                    transparent 70%);
        }

        /* Moon Badge (Next Phase) */
        .moon-badge {
            background: rgba(15, 23, 42, 0.95) !important;
            color: #fbbf24 !important;
            border: 2px solid rgba(251, 191, 36, 0.5) !important;
            font-weight: 700;
            font-size: 0.85rem;
            padding: 4px 12px !important;
            text-shadow: 0 0 8px rgba(251, 191, 36, 0.5);
        }

        html.light-mode .moon-badge {
            background: rgba(255, 255, 255, 0.95) !important;
            color: #d97706 !important;
            border-color: rgba(217, 119, 6, 0.5) !important;
            text-shadow: none;
        }

        /* SVG Moon Marker Animation */
        #moonPosition {
            transition: cx 0.5s ease-out, cy 0.5s ease-out, fill 0.3s ease, opacity 0.3s ease;
        }

        #moonGlowCircle {
            transition: cx 0.5s ease-out, cy 0.5s ease-out, opacity 0.3s ease;
        }

        #moonCurrentInfoGroup {
            transition: transform 0.5s ease-out, opacity 0.3s ease;
        }

        /* =====================================================
           CARD DRAG & DROP - Premium Experience
           ===================================================== */

        /* Drag Handle */
        .drag-handle {
            cursor: grab;
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.2s ease;
            opacity: 0.5;
            font-size: 1.1rem;
            user-select: none;
            -webkit-user-select: none;
            touch-action: none;
        }

        .drag-handle:hover {
            opacity: 1;
            background: rgba(99, 102, 241, 0.2);
            transform: scale(1.1);
        }

        .drag-handle:active {
            cursor: grabbing;
            transform: scale(0.95);
        }

        /* Card in normal state */
        .chart-card[draggable="true"] {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1),
                box-shadow 0.3s ease,
                opacity 0.3s ease;
            position: relative;
        }

        /* Card being dragged */
        .chart-card.dragging {
            opacity: 0.6;
            transform: scale(0.98) rotate(1deg);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4),
                0 0 30px rgba(99, 102, 241, 0.3);
            z-index: 1000;
            cursor: grabbing;
        }

        /* Card being dragged (touch mode) */
        .chart-card.touch-dragging {
            position: fixed;
            opacity: 0.9;
            transform: scale(1.02);
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.5),
                0 0 40px rgba(99, 102, 241, 0.4);
            z-index: 10000;
            pointer-events: none;
            transition: none;
        }

        /* Drop placeholder */
        .drag-placeholder {
            background: linear-gradient(135deg,
                    rgba(99, 102, 241, 0.1) 0%,
                    rgba(99, 102, 241, 0.05) 100%);
            border: 2px dashed rgba(99, 102, 241, 0.5);
            border-radius: 16px;
            min-height: 200px;
            transition: all 0.3s ease;
            animation: placeholderPulse 1.5s ease-in-out infinite;
        }

        @keyframes placeholderPulse {

            0%,
            100% {
                border-color: rgba(99, 102, 241, 0.3);
                background: rgba(99, 102, 241, 0.05);
            }

            50% {
                border-color: rgba(99, 102, 241, 0.6);
                background: rgba(99, 102, 241, 0.1);
            }
        }

        /* Card drop animation */
        .chart-card.drop-animation {
            animation: cardDrop 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @keyframes cardDrop {
            0% {
                transform: scale(0.95);
                opacity: 0.8;
            }

            50% {
                transform: scale(1.02);
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Drag over state for other cards */
        .chart-card.drag-over {
            transform: translateY(10px);
            opacity: 0.7;
        }

        /* Mobile touch feedback */
        .chart-card.touch-ready {
            animation: touchReady 0.3s ease;
        }

        @keyframes touchReady {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(0.98);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Light mode adjustments */
        html.light-mode .drag-handle:hover {
            background: rgba(59, 130, 246, 0.15);
        }

        html.light-mode .drag-placeholder {
            background: rgba(59, 130, 246, 0.08);
            border-color: rgba(59, 130, 246, 0.4);
        }

        /* Larger touch target on mobile */
        @media (max-width: 768px) {
            .drag-handle {
                padding: 8px 12px;
                font-size: 1.3rem;
            }
        }
    </style>
</head>

<body>
    <div class="background-effects">
        <div class="bg-orb bg-orb-1"></div>
        <div class="bg-orb bg-orb-2"></div>
    </div>
    <!-- Weather effects disabled -->

    <div class="grid-pattern"></div>

    <div class="container">
        <header>
            <div class="logo">
                <span class="logo-icon">üå°Ô∏è</span>
                <h1>Â§ñÊ∞óÊ∏©„É¢„Éã„Çø„Éº</h1>
            </div>
            <div class="status-info">
                <div class="status-item">
                    <div class="status-dot"></div>
                    <span>Êõ¥Êñ∞ <strong id="lastUpdate"><span class="skeleton"
                                style="width:40px;height:14px"></span></strong></span>
                </div>
                <div class="status-item">
                    <span>üìä <strong id="dataCount"><span class="skeleton"
                                style="width:60px;height:14px"></span></strong></span>
                </div>
                <div class="status-item">
                    <span>‚è±Ô∏è Ê¨°Âõû <strong id="nextUpdate"><span class="skeleton"
                                style="width:30px;height:14px"></span></strong></span>
                </div>
                <button id="themeToggle" class="theme-toggle" onclick="toggleTheme()">
                    <span id="themeIcon">üåô</span> <span id="themeText">„ÉÄ„Éº„ÇØ</span>
                </button>
            </div>
        </header>

        <!-- Pull to Refresh Indicator -->
        <div id="pullToRefresh" class="pull-to-refresh">
            <div class="pull-spinner">‚Üª</div>
            <span>Âºï„Å£Âºµ„Å£„Å¶Êõ¥Êñ∞</span>
        </div>

        <!-- Current Weather Hero Section (Redesigned) -->
        <div id="weatherHero" class="weather-hero">
            <div class="sun-times">
                <div class="sun-time-item">
                    <span class="sun-label">Êó•„ÅÆÂá∫</span>
                    <span class="sun-value" id="sunriseTime">--:--</span>
                </div>
                <div class="sun-time-item">
                    <span class="sun-label">Êó•„ÅÆÂÖ•</span>
                    <span class="sun-value" id="sunsetTime">--:--</span>
                </div>
            </div>
            <div class="weather-hero-center">
                <div class="weather-hero-icon" id="heroWeatherIcon">‚òÄÔ∏è</div>
                <div class="weather-hero-temp" id="heroTempContainer">
                    <span id="heroTemp" class="hero-temp-value">--</span>
                    <span class="hero-temp-unit">‚ÑÉ</span>
                </div>
                <div class="weather-hero-condition" id="heroCondition">--</div>
            </div>
            <div class="weather-hero-info">
                <div class="weather-hero-info-item">
                    <span class="info-label">‰ΩìÊÑü</span>
                    <span class="info-value" id="heroFeelsLike">--</span>
                    <span class="info-unit">‚ÑÉ</span>
                </div>
                <div class="weather-hero-info-divider"></div>
                <div class="weather-hero-info-item">
                    <span class="info-label">ÊπøÂ∫¶</span>
                    <span class="info-value" id="heroHumidity">--</span>
                    <span class="info-unit">%</span>
                </div>
                <div class="weather-hero-info-divider"></div>
                <div class="weather-hero-info-item">
                    <span class="info-label">È¢®ÈÄü</span>
                    <span class="info-value" id="heroWind">--</span>
                    <span class="info-unit">m/s</span>
                </div>
                <div class="weather-hero-info-divider"></div>
                <div class="weather-hero-info-item">
                    <span class="info-label">ÈôçÊ∞¥</span>
                    <span class="info-value" id="heroPrecip">--</span>
                    <span class="info-unit">%</span>
                </div>
                <div class="weather-hero-info-divider"></div>
                <div class="weather-hero-info-item">
                    <span class="info-label">Ê∞óÂúß</span>
                    <span class="info-value" id="heroPressure">--</span>
                    <span class="info-unit">hPa</span>
                </div>
            </div>
        </div>

        <div id="greetingSection" class="comment-card">
            <div class="comment-label">üí¨ ‰∏ÄË®Ä„Ç≥„É°„É≥„Éà</div>
            <div class="comment-content" id="weatherComment"></div>
        </div>

        <!-- Precipitation Chart -->
        <div id="precipitationCard" class="precipitation-card" style="display: none;">
            <div class="precipitation-header">
                <span class="precipitation-title">üåßÔ∏è ÈôçÊ∞¥Èáè‰∫àÂ†±</span>
                <span class="precipitation-time" id="precipTime"></span>
            </div>
            <div class="precipitation-chart-container">
                <canvas id="precipChart"></canvas>
            </div>
            <div class="precipitation-legend">
                <span class="legend-item"><span class="legend-obs">‚óè</span> ÂÆüÊ∏¨</span>
                <span class="legend-item"><span class="legend-forecast">‚óã</span> ‰∫àÂ†±</span>
            </div>
            <div id="rainAlert" class="rain-alert" style="display: none;">
                <span id="rainAlertIcon" class="rain-alert-icon">üåßÔ∏è</span>
                <span id="rainAlertText"></span>
            </div>
        </div>

        <!-- Warning/Alert Banner (clickable) -->
        <a id="alertBanner" class="alert-banner"
            href="https://www.jma.go.jp/bosai/warning/#area_type=class20s&area_code=1312200" target="_blank"
            rel="noopener" style="display: none; text-decoration: none;">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span id="alertText"></span>
            <span class="alert-link-hint">üìã Ë©≥Á¥∞</span>
        </a>

        <!-- AI Advisor Section -->
        <div id="aiAdvisorSection" class="ai-advisor-section">
            <div class="ai-advisor-header">
                <span class="ai-advisor-icon">ü§ñ</span>
                <span class="ai-advisor-label">AIÊ∞óË±°„Ç¢„Éâ„Éê„Ç§„Ç∂„Éº</span>
                <span class="ai-advisor-time" id="aiAdvisorTime"></span>
            </div>
            <div class="ai-advisor-content" id="aiAdvisorContent">
                <span class="ai-advisor-text" id="aiAdvisorText">ÂàÜÊûê‰∏≠...</span>
                <button class="ai-advisor-expand" id="aiAdvisorExpand" style="display: none;"
                    onclick="toggleAiAdvisor()">Á∂ö„Åç„ÇíË°®Á§∫</button>
            </div>
        </div>

        <div class="main-stats">
            <div class="stat-card temp">
                <div class="stat-header">
                    <span class="stat-icon">üå°Ô∏è</span>
                    <span id="comfortBadge" class="comfort-badge"></span>
                </div>
                <div class="stat-label">ÁèæÂú®„ÅÆÊ∞óÊ∏©</div>
                <div class="stat-value temp"><span id="currentTemp"><span class="skeleton"
                            style="width:80px;height:40px"></span></span><span class="stat-unit">¬∞C</span></div>
            </div>
            <div class="stat-card humidity">
                <div class="stat-header"><span class="stat-icon">üíß</span></div>
                <div class="stat-label">ÁèæÂú®„ÅÆÊπøÂ∫¶</div>
                <div class="stat-value humidity"><span id="currentHumidity"><span class="skeleton"
                            style="width:60px;height:40px"></span></span><span class="stat-unit">%</span></div>
            </div>
            <div class="stat-card feels-like">
                <div class="stat-header"><span class="stat-icon">üå°Ô∏è</span></div>
                <div class="stat-label">‰ΩìÊÑüÊ∏©Â∫¶</div>
                <div class="stat-value feels-like"><span id="feelsLike"><span class="skeleton"
                            style="width:60px;height:40px"></span></span><span class="stat-unit">¬∞C</span></div>
            </div>
            <div class="stat-card uv">
                <div class="stat-header"><span class="stat-icon">‚òÄÔ∏è</span><span id="uvBadge" class="uv-badge"></span>
                </div>
                <div class="stat-label">Á¥´Â§ñÁ∑öÊåáÊï∞</div>
                <div class="stat-value uv"><span id="uvIndex"><span class="skeleton"
                            style="width:40px;height:40px"></span></span></div>
            </div>
            <div class="stat-card high">
                <div class="stat-header"><span class="stat-icon">üî∫</span></div>
                <div class="stat-label">‰ªäÊó•„ÅÆÊúÄÈ´ò</div>
                <div class="stat-value high"><span id="todayHigh"><span class="skeleton"
                            style="width:80px;height:40px"></span></span><span class="stat-unit">¬∞C</span></div>
            </div>
            <div class="stat-card low">
                <div class="stat-header"><span class="stat-icon">üîª</span></div>
                <div class="stat-label">‰ªäÊó•„ÅÆÊúÄ‰Ωé</div>
                <div class="stat-value low"><span id="todayLow"><span class="skeleton"
                            style="width:80px;height:40px"></span></span><span class="stat-unit">¬∞C</span></div>
            </div>
        </div>

        <div class="charts-grid" id="chartsGrid">
            <div class="chart-card full-width" data-chart-id="chart24h" draggable="true">
                <div class="chart-header">
                    <span class="drag-handle" title="„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰∏¶„Å≥Êõø„Åà">‚†ø</span>
                    <span class="chart-title">üìà Áõ¥Ëøë24ÊôÇÈñì„ÅÆÊ∞óÊ∏©„ÉªÊπøÂ∫¶</span>
                    <span class="chart-badge">1ÂàÜÈñìÈöî</span>
                </div>
                <div class="chart-container">
                    <div id="chartSkeleton1" class="chart-skeleton">
                        <div class="skeleton" style="width:100%;height:100%;border-radius:8px"></div>
                    </div>
                    <canvas id="chart24h"></canvas>
                </div>
            </div>
            <div class="chart-card" data-chart-id="chartWeek" draggable="true">
                <div class="chart-header">
                    <span class="drag-handle" title="„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰∏¶„Å≥Êõø„Åà">‚†ø</span>
                    <span class="chart-title">üìä ÈÄ±ÈñìÊ∞óÊ∏©Êé®Áßª</span>
                    <span class="chart-badge">30ÂàÜÂπ≥Âùá</span>
                </div>
                <div class="chart-container">
                    <div id="chartSkeleton2" class="chart-skeleton">
                        <div class="skeleton" style="width:100%;height:100%;border-radius:8px"></div>
                    </div>
                    <canvas id="chartWeek"></canvas>
                </div>
            </div>

            <!-- Moon Information Card -->
            <div class="chart-card moon-card" data-chart-id="moonCard" draggable="true">
                <div class="chart-header">
                    <span class="drag-handle" title="„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰∏¶„Å≥Êõø„Åà">‚†ø</span>
                    <span class="chart-title">üåô ÊúàÊÉÖÂ†±</span>
                    <span class="chart-badge moon-badge" id="moonNextPhaseText">--</span>
                </div>

                <!-- Info Row: Moon details -->
                <div class="moon-info-bar">
                    <div class="moon-info-group">
                        <span class="moon-icon" id="moonIcon">üåï</span>
                        <span class="moon-phase-name" id="moonPhaseName">--</span>
                    </div>
                    <div class="moon-info-group">
                        <span class="moon-stat-label">ÊúàÈΩ¢</span>
                        <span class="moon-stat-value" id="moonAge">--</span>
                    </div>
                    <div class="moon-info-group">
                        <span class="moon-stat-label">ËºùÈù¢Áéá</span>
                        <span class="moon-stat-value" id="moonIllumination">--</span><span
                            class="moon-stat-unit">%</span>
                    </div>
                </div>

                <!-- Main Arc Visualization -->
                <div class="moon-arc-main">
                    <svg viewBox="0 0 340 200" class="moon-arc-svg" style="min-height: 200px;"
                        preserveAspectRatio="xMidYMid meet">
                        <defs>
                            <radialGradient id="moonGlow" cx="50%" cy="50%" r="50%">
                                <stop offset="0%" stop-color="#fbbf24" stop-opacity="0.7" />
                                <stop offset="100%" stop-color="#fbbf24" stop-opacity="0" />
                            </radialGradient>
                            <linearGradient id="arcGrad" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stop-color="#60a5fa" />
                                <stop offset="50%" stop-color="#fbbf24" />
                                <stop offset="100%" stop-color="#f97316" />
                            </linearGradient>
                            <filter id="textShadow" x="-20%" y="-20%" width="140%" height="140%">
                                <feDropShadow dx="0" dy="1" stdDeviation="1" flood-color="rgba(0,0,0,0.8)" />
                            </filter>
                        </defs>

                        <!-- Horizon line -->
                        <line x1="20" y1="150" x2="320" y2="150" stroke="rgba(148,163,184,0.2)" stroke-width="1"
                            stroke-dasharray="2,2" />
                        <text x="170" y="148" text-anchor="middle" fill="rgba(148,163,184,0.4)" font-size="9">Âú∞Âπ≥Á∑ö</text>

                        <!-- Arc path -->
                        <path d="M 40 150 Q 170 -20 300 150" fill="none" stroke="url(#arcGrad)" stroke-width="3"
                            stroke-linecap="round" />

                        <!-- Rise Group (Left) -->
                        <g class="moon-label-group">
                            <circle cx="40" cy="150" r="5" fill="#60a5fa" stroke="#0f172a" stroke-width="2" />
                            <!-- Labels adjusted: Dir -> Time -> Label -->
                            <text x="40" y="170" text-anchor="middle" fill="#60a5fa" font-size="10" font-weight="600"
                                id="moonRiseDirSvg">--</text>
                            <text x="40" y="184" text-anchor="middle" fill="var(--text-primary)" font-size="13"
                                font-weight="700" id="moonRiseTimeSvg" filter="url(#textShadow)">--:--</text>
                            <text x="40" y="196" text-anchor="middle" fill="var(--text-muted)" font-size="9">Êúà„ÅÆÂá∫</text>
                        </g>

                        <!-- Transit Label (Top Center) -->
                        <text x="170" y="15" text-anchor="middle" fill="#fbbf24" font-size="10" font-weight="500"
                            style="opacity: 0.8;">Âçó‰∏≠</text>

                        <!-- Set Group (Right) -->
                        <g class="moon-label-group">
                            <circle cx="300" cy="150" r="5" fill="#f97316" stroke="#0f172a" stroke-width="2" />
                            <!-- Labels adjusted -->
                            <text x="300" y="170" text-anchor="middle" fill="#f97316" font-size="10" font-weight="600"
                                id="moonSetDirSvg">--</text>
                            <text x="300" y="184" text-anchor="middle" fill="var(--text-primary)" font-size="13"
                                font-weight="700" id="moonSetTimeSvg" filter="url(#textShadow)">--:--</text>
                            <text x="300" y="196" text-anchor="middle" fill="var(--text-muted)" font-size="9">Êúà„ÅÆÂÖ•</text>
                        </g>

                        <!-- Current Moon Marker & Glow -->
                        <circle id="moonGlowCircle" cx="170" cy="70" r="22" fill="url(#moonGlow)" />
                        <circle id="moonPosition" cx="170" cy="70" r="9" fill="#fbbf24" stroke="#0f172a"
                            stroke-width="1.5" />

                        <!-- Current Position Info (Floating) -->
                        <g id="moonCurrentInfoGroup" opacity="0">
                            <rect id="moonInfoBg" x="0" y="0" width="60" height="20" rx="4" fill="rgba(15,23,42,0.8)"
                                stroke="rgba(251,191,36,0.3)" stroke-width="1" />
                            <text id="moonCurrentInfoSvg" x="0" y="0" text-anchor="middle" fill="#fbbf24" font-size="10"
                                font-weight="600" dy="4">--</text>
                        </g>
                    </svg>
                </div>
            </div>

            <div class="chart-card" data-chart-id="chartMonthly" draggable="true">
                <div class="chart-header">
                    <span class="drag-handle" title="„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰∏¶„Å≥Êõø„Åà">‚†ø</span>
                    <span class="chart-title">üìÖ ÊúàÂà• ÊúÄÈ´ò/ÊúÄ‰ΩéÊ∞óÊ∏©</span>
                    <span class="chart-badge">ÂÖ®ÊúüÈñì</span>
                </div>
                <div class="chart-container">
                    <div id="chartSkeleton3" class="chart-skeleton">
                        <div class="skeleton" style="width:100%;height:100%;border-radius:8px"></div>
                    </div>
                    <canvas id="chartMonthly"></canvas>
                </div>
            </div>
            <div class="chart-card full-width" data-chart-id="chartYearly" draggable="true">
                <div class="chart-header">
                    <span class="drag-handle" title="„Éâ„É©„ÉÉ„Ç∞„Åó„Å¶‰∏¶„Å≥Êõø„Åà">‚†ø</span>
                    <span class="chart-title">üóìÔ∏è Êó•Âà• ÊúÄÈ´ò/ÊúÄ‰ΩéÊ∞óÊ∏©</span>
                    <span class="chart-badge">ÂÖ®ÊúüÈñì</span>
                </div>
                <div class="chart-container">
                    <div id="chartSkeleton4" class="chart-skeleton">
                        <div class="skeleton" style="width:100%;height:100%;border-radius:8px"></div>
                    </div>
                    <canvas id="chartYearly"></canvas>
                </div>
            </div>
        </div>

        <div class="footer-stats">
            <div class="footer-stat">
                <div class="footer-stat-label">Âπ¥ÈñìÊúÄÈ´ò</div>
                <div class="footer-stat-value highlight"><span id="yearHigh">--</span>¬∞C</div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">Âπ¥ÈñìÊúÄ‰Ωé</div>
                <div class="footer-stat-value cool"><span id="yearLow">--</span>¬∞C</div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">‰ªäÈÄ±Âπ≥Âùá</div>
                <div class="footer-stat-value"><span id="weekAvg">--</span>¬∞C</div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">ÂâçÈÄ±ÊØî</div>
                <div class="footer-stat-value" id="weekDiff"><span id="weekDiffValue">--</span></div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">24hÊúÄÈ´ò</div>
                <div class="footer-stat-value highlight"><span id="last24hHigh">--</span>¬∞C</div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">24hÊúÄ‰Ωé</div>
                <div class="footer-stat-value cool"><span id="last24hLow">--</span>¬∞C</div>
            </div>
            <div class="footer-stat">
                <div class="footer-stat-label">„Éá„Éº„ÇøÊúüÈñì</div>
                <div class="footer-stat-value">2024/3 „Äú ÁèæÂú®</div>
            </div>
        </div>
        <div class="version-info">v3.3.5 <span style="opacity: 0.5; font-size: 0.75em;">| ÊúÄÁµÇÊõ¥Êñ∞: 2026/01/03 14:02</span>
        </div>
    </div>

    <script>
        // =====================================================
        // SOURCE CODE PROTECTION (deters casual viewing)
        // =====================================================
        (function () {
            // Disable right-click context menu
            document.addEventListener('contextmenu', e => e.preventDefault());

            // Disable keyboard shortcuts (F12, Ctrl+Shift+I, Ctrl+U, Ctrl+S)
            document.addEventListener('keydown', function (e) {
                // F12
                if (e.key === 'F12') { e.preventDefault(); return false; }
                // Ctrl+Shift+I (DevTools)
                if (e.ctrlKey && e.shiftKey && e.key === 'I') { e.preventDefault(); return false; }
                // Ctrl+Shift+J (Console)
                if (e.ctrlKey && e.shiftKey && e.key === 'J') { e.preventDefault(); return false; }
                // Ctrl+U (View Source)
                if (e.ctrlKey && e.key === 'u') { e.preventDefault(); return false; }
                // Ctrl+S (Save)
                if (e.ctrlKey && e.key === 's') { e.preventDefault(); return false; }
            });

            // DevTools detection (checks if window is resized for docked DevTools)
            let devToolsOpen = false;
            const threshold = 160;

            // Create warning overlay
            const createWarningOverlay = () => {
                if (document.getElementById('devtools-warning')) return;
                const overlay = document.createElement('div');
                overlay.id = 'devtools-warning';
                overlay.innerHTML = `
                    <div style="
                        position: fixed; top: 0; left: 0; right: 0; bottom: 0;
                        background: linear-gradient(135deg, rgba(15, 0, 0, 0.98), rgba(30, 0, 0, 0.95));
                        display: flex; flex-direction: column;
                        justify-content: center; align-items: center;
                        z-index: 999999; color: white; font-family: sans-serif;
                        animation: warningPulse 2s ease-in-out infinite;
                    ">
                        <style>
                            @keyframes warningPulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.9; } }
                            @keyframes scanline { 0% { transform: translateY(-100%); } 100% { transform: translateY(100vh); } }
                        </style>
                        <div style="position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, #ef4444, transparent); animation: scanline 2s linear infinite;"></div>
                        <div style="font-size: 100px; margin-bottom: 20px; filter: drop-shadow(0 0 30px rgba(239, 68, 68, 0.8));">‚ö†Ô∏è</div>
                        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px; color: #ef4444; text-shadow: 0 0 20px rgba(239, 68, 68, 0.6);">
                            üîí „Çª„Ç≠„É•„É™„ÉÜ„Ç£Ë≠¶Âëä
                        </div>
                        <div style="font-size: 24px; font-weight: bold; margin-bottom: 20px; color: #fbbf24;">
                            ‰∏çÊ≠£„Ç¢„ÇØ„Çª„Çπ„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„Åü
                        </div>
                        <div style="font-size: 14px; color: #94a3b8; text-align: center; line-height: 2; max-width: 500px; background: rgba(0,0,0,0.5); padding: 20px; border-radius: 10px; border: 1px solid rgba(239, 68, 68, 0.3);">
                            „Åì„ÅÆ„Éö„Éº„Ç∏„ÅÆ„ÇΩ„Éº„Çπ„Ç≥„Éº„Éâ„ÅØËëó‰ΩúÊ®©Ê≥ï„Å´„Çà„Çä‰øùË≠∑„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ<br>
                            <span style="color: #ef4444; font-weight: bold;">‚ö° ÈñãÁô∫ËÄÖ„ÉÑ„Éº„É´„ÅÆ‰ΩøÁî®„ÇíÊ§úÂá∫</span><br><br>
                            üìã „ÅÇ„Å™„Åü„ÅÆIP„Ç¢„Éâ„É¨„Çπ„Éª„Éá„Éê„Ç§„ÇπÊÉÖÂ†±„ÅØË®òÈå≤„Åï„Çå„Åæ„Åó„Åü<br>
                            üì° „Çµ„Éº„Éê„Éº„Å∏„ÅÆ„É≠„Ç∞ÈÄÅ‰ø°: <span style="color: #22c55e;">ÂÆå‰∫Ü</span><br>
                            üîç ‰∏çÊ≠£„Ç¢„ÇØ„Çª„Çπ„Å®„Åó„Å¶Ë™øÊüªÂØæË±°„Å®„Å™„ÇãÂ†¥Âêà„Åå„ÅÇ„Çä„Åæ„Åô<br><br>
                            <span style="color: #fbbf24;">ÈñãÁô∫ËÄÖ„ÉÑ„Éº„É´„ÇíÁõ¥„Å°„Å´Èñâ„Åò„Å¶„Åè„Å†„Åï„ÅÑ</span>
                        </div>
                        <div style="margin-top: 20px; font-size: 11px; color: #64748b;">
                            Session ID: ${Math.random().toString(36).substring(2, 10).toUpperCase()}-${Date.now()}
                        </div>
                    </div>
                `;
                document.body.appendChild(overlay);
            };

            const removeWarningOverlay = () => {
                const overlay = document.getElementById('devtools-warning');
                if (overlay) overlay.remove();
            };

            const checkDevTools = () => {
                const widthDiff = window.outerWidth - window.innerWidth > threshold;
                const heightDiff = window.outerHeight - window.innerHeight > threshold;
                if (widthDiff || heightDiff) {
                    if (!devToolsOpen) {
                        devToolsOpen = true;
                        console.clear();
                        console.log('%c‚ö†Ô∏è ÈñãÁô∫ËÄÖ„ÉÑ„Éº„É´„ÅÆ‰ΩøÁî®„ÅØÊ§úÂá∫„Åï„Çå„Åæ„Åô„ÄÇÈñãÁô∫ËÄÖ„Å´Ëá™Âãï„ÅßÂ†±Âëä„Åï„Çå„Åæ„Åô„ÄÇ', 'color: red; font-size: 20px; font-weight: bold;');
                        createWarningOverlay();
                    }
                } else {
                    if (devToolsOpen) {
                        devToolsOpen = false;
                        removeWarningOverlay();
                    }
                }
            };
            setInterval(checkDevTools, 500);

            // Additional detection using debugger timing
            const detectDebugger = () => {
                const start = performance.now();
                debugger;
                const end = performance.now();
                if (end - start > 100) {
                    createWarningOverlay();
                }
            };
            // Run once on load (will trigger if DevTools is already open)
            setTimeout(detectDebugger, 1000);

            // Disable text selection (optional, can be removed if needed)
            document.addEventListener('selectstart', e => e.preventDefault());

            // Disable pinch-to-zoom on mobile
            document.addEventListener('gesturestart', e => e.preventDefault());
            document.addEventListener('gesturechange', e => e.preventDefault());
            document.addEventListener('gestureend', e => e.preventDefault());

            // Disable double-tap zoom
            let lastTouchEnd = 0;
            document.addEventListener('touchend', e => {
                const now = Date.now();
                if (now - lastTouchEnd <= 300) {
                    e.preventDefault();
                }
                lastTouchEnd = now;
            }, { passive: false });

            // Disable multi-touch zoom
            document.addEventListener('touchstart', e => {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });

            // Clear console on load
            console.clear();
        })();

        const SPREADSHEET_ID = '1nbmJIIUzw8n2PcHp98NaiKnaAVciBx_Egpokjjx7uW8';
        const BASE_URL = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/gviz/tq?tqx=out:csv`;
        const SUMMARY_URL = `${BASE_URL}&sheet=Summary`;
        const DAILY_URL = `${BASE_URL}&sheet=Daily`;
        const RECENT_URL = `${BASE_URL}&sheet=Recent`;
        const WEEKLY_URL = `${BASE_URL}&sheet=Weekly`;

        // ÂÖ®„Éë„É©„É°„Éº„ÇøÂèñÂæó: Ê∞óÂúß„ÄÅÈ¢®Âêë„ÄÅÊó•Â∞ÑÈáè„ÄÅËí∏Áô∫Êï£Èáè„Å™„Å©ÂÖ®„Å¶Âê´„ÇÄ
        const WEATHER_URL = 'https://api.open-meteo.com/v1/forecast?latitude=35.7727&longitude=139.8680' +
            '&current=weather_code,temperature_2m,relative_humidity_2m,dew_point_2m,apparent_temperature,' +
            'precipitation,rain,showers,snowfall,cloud_cover,pressure_msl,surface_pressure,' +
            'wind_speed_10m,wind_direction_10m,wind_gusts_10m,visibility,uv_index,is_day' +
            '&hourly=weather_code,temperature_2m,relative_humidity_2m,dew_point_2m,apparent_temperature,' +
            'precipitation_probability,precipitation,rain,showers,snowfall,cloud_cover,visibility,' +
            'wind_speed_10m,wind_direction_10m,wind_gusts_10m,uv_index,' +
            'temperature_850hPa,temperature_925hPa,wet_bulb_temperature_2m,freezing_level_height,' +
            'cape,soil_temperature_0cm,direct_radiation,diffuse_radiation,et0_fao_evapotranspiration' +
            '&daily=sunrise,sunset,sunshine_duration,uv_index_max,temperature_2m_max,temperature_2m_min,' +
            'precipitation_sum,rain_sum,showers_sum,snowfall_sum,precipitation_probability_max,' +
            'wind_speed_10m_max,wind_gusts_10m_max,wind_direction_10m_dominant,shortwave_radiation_sum' +
            '&forecast_days=2&timezone=Asia%2FTokyo&wind_speed_unit=ms';

        const UPDATE_INTERVAL = 60 * 1000;

        let summaryData = {}, dailyData = [], recentData = [], weeklyData = [], weatherData = null, charts = {}, nextUpdateTime = null;

        // Comment stability system - only change comment when conditions change
        let lastConditionKey = '';  // Previous condition key (temp band, weather, alerts)
        let lastComment = '';       // Previous comment to maintain when conditions unchanged
        let currentAlerts = [];     // Current JMA alerts for comment integration

        // Theme settings: 'auto', 'light', 'dark'
        let themeSetting = localStorage.getItem('theme') || 'auto';
        let notificationsEnabled = localStorage.getItem('notifications') === 'true';
        const TEMP_ALERT_THRESHOLD = 35; // Notify when temp >= this

        // =====================================================
        // PERFORMANCE: LocalStorage Cache System
        // =====================================================
        const CACHE_CONFIG = {
            weather: { key: 'cache_weather', ttl: 5 * 60 * 1000 },      // 5 minutes
            spreadsheet: { key: 'cache_spreadsheet', ttl: 10 * 60 * 1000 }, // 10 minutes
            precipitation: { key: 'cache_precip', ttl: 5 * 60 * 1000 }, // 5 minutes
            alerts: { key: 'cache_alerts', ttl: 30 * 60 * 1000 }        // 30 minutes
        };

        function getFromCache(type) {
            try {
                const config = CACHE_CONFIG[type];
                if (!config) return null;
                const cached = localStorage.getItem(config.key);
                if (!cached) return null;
                const { data, timestamp } = JSON.parse(cached);
                if (Date.now() - timestamp > config.ttl) {
                    localStorage.removeItem(config.key);
                    return null;
                }
                console.log(`[Cache] Hit: ${type}`);
                return data;
            } catch (e) {
                return null;
            }
        }

        function setToCache(type, data) {
            try {
                const config = CACHE_CONFIG[type];
                if (!config) return;
                localStorage.setItem(config.key, JSON.stringify({
                    data,
                    timestamp: Date.now()
                }));
                console.log(`[Cache] Set: ${type}`);
            } catch (e) {
                // LocalStorage full or unavailable
                console.log('[Cache] Storage error:', e.message);
            }
        }

        function clearAllCache() {
            Object.values(CACHE_CONFIG).forEach(config => {
                localStorage.removeItem(config.key);
            });
            console.log('[Cache] Cleared all');
        }

        // PWA Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').catch(e => console.log('SW registration failed:', e));
        }

        // Request notification permission on load
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(p => {
                    if (p === 'granted') {
                        notificationsEnabled = true;
                        localStorage.setItem('notifications', 'true');
                    }
                });
            }
        }

        // Send notification if conditions are met
        function checkAndNotify(temp) {
            if (!notificationsEnabled || Notification.permission !== 'granted') return;
            if (temp >= TEMP_ALERT_THRESHOLD) {
                new Notification('üå°Ô∏è Â§ñÊ∞óÊ∏©„É¢„Éã„Çø„Éº', {
                    body: `${temp.toFixed(1)}¬∞C - ÁåõÊöëË≠¶Â†±ÔºÅÁÜ±‰∏≠Áóá„Å´Ê≥®ÊÑè„Åó„Å¶„Åè„Å†„Åï„ÅÑ`,
                    icon: 'üå°Ô∏è',
                    tag: 'temp-alert'
                });
            } else if (temp <= 0) {
                new Notification('üå°Ô∏è Â§ñÊ∞óÊ∏©„É¢„Éã„Çø„Éº', {
                    body: `${temp.toFixed(1)}¬∞C - Ê∞∑ÁÇπ‰∏ã„Åß„Åô„ÄÇÂáçÁµê„Å´Ê≥®ÊÑè`,
                    icon: '‚ùÑÔ∏è',
                    tag: 'temp-alert'
                });
            }
        }

        // Theme toggle: auto -> light -> dark -> auto
        function toggleTheme() {
            const modes = ['auto', 'light', 'dark'];
            const idx = modes.indexOf(themeSetting);
            themeSetting = modes[(idx + 1) % 3];
            localStorage.setItem('theme', themeSetting);
            applyTheme();
        }

        // Apply theme based on setting (uses sunrise/sunset when available)
        function applyTheme() {
            const now = new Date();
            let isLight = false;

            if (themeSetting === 'light') {
                isLight = true;
            } else if (themeSetting === 'dark') {
                isLight = false;
            } else {
                // Auto mode: use sunrise/sunset if available, fallback to 6-18
                if (weatherData?.sunrise && weatherData?.sunset) {
                    const sunriseTime = new Date(weatherData.sunrise);
                    const sunsetTime = new Date(weatherData.sunset);
                    isLight = (now >= sunriseTime && now < sunsetTime);
                } else {
                    // Fallback: light 6-18, dark otherwise
                    const hour = now.getHours();
                    isLight = (hour >= 6 && hour < 18);
                }
            }

            document.documentElement.classList.toggle('light-mode', isLight);

            // Update button text
            const icon = themeSetting === 'auto' ? 'üîÑ' : (themeSetting === 'light' ? '‚òÄÔ∏è' : 'üåô');
            const text = themeSetting === 'auto' ? 'Ëá™Âãï' : (themeSetting === 'light' ? '„É©„Ç§„Éà' : '„ÉÄ„Éº„ÇØ');
            document.getElementById('themeIcon').textContent = icon;
            document.getElementById('themeText').textContent = text;

            // Update meta theme color
            document.querySelector('meta[name="theme-color"]').content = isLight ? '#f1f5f9' : '#3b82f6';

            // Resize charts after theme change (fixes disappearing charts)
            setTimeout(() => {
                Object.values(charts).forEach(chart => {
                    if (chart && typeof chart.resize === 'function') {
                        chart.resize();
                    }
                });
            }, 100);
        }

        // Initialize theme on load
        applyTheme();

        // Weather effects control based on weather code
        let lightningInterval = null;
        function updateWeatherEffects() {
            if (!weatherData) return;

            const code = weatherData.weatherCode || 0;
            const effectRain = document.getElementById('effectRain');
            const effectRainBack = document.getElementById('effectRainBack');
            const effectSnow = document.getElementById('effectSnow');
            const effectClouds = document.getElementById('effectClouds');
            const effectStars = document.getElementById('effectStars');
            const weatherContainer = document.getElementById('weatherEffectsContainer');
            const lightningFlash = document.getElementById('lightningFlash');

            if (!effectRain || !weatherContainer) return;

            // Reset all effects
            effectRain.classList.remove('active', 'heavy');
            effectRainBack?.classList.remove('active');
            effectSnow?.classList.remove('active');
            effectClouds?.classList.remove('active');
            effectStars?.classList.remove('active');
            weatherContainer.classList.remove('rainy');

            // Clear lightning interval
            if (lightningInterval) {
                clearInterval(lightningInterval);
                lightningInterval = null;
            }

            // Determine weather type from WMO code
            // 0: Clear, 1-3: Cloudy, 45-48: Fog, 51-57: Drizzle, 61-67: Rain, 71-77: Snow, 80-82: Showers, 85-86: Snow showers, 95-99: Thunderstorm

            const isNight = (() => {
                if (weatherData.sunrise && weatherData.sunset) {
                    const now = new Date();
                    return now < new Date(weatherData.sunrise) || now >= new Date(weatherData.sunset);
                }
                const hour = new Date().getHours();
                return hour < 6 || hour >= 18;
            })();

            if (code >= 95) {
                // Thunderstorm - heavy rain + lightning
                effectRain.classList.add('active', 'heavy');
                effectRainBack?.classList.add('active');
                weatherContainer.classList.add('rainy');
                effectRain.style.opacity = '0.8';

                // Random lightning flashes
                lightningInterval = setInterval(() => {
                    if (Math.random() < 0.4) {
                        lightningFlash?.classList.add('active');
                        setTimeout(() => lightningFlash?.classList.remove('active'), 300);
                    }
                }, 3000 + Math.random() * 4000);

            } else if (code >= 80 && code < 95) {
                // Heavy rain showers
                effectRain.classList.add('active', 'heavy');
                effectRainBack?.classList.add('active');
                weatherContainer.classList.add('rainy');
                effectRain.style.opacity = '0.7';

            } else if (code >= 61 && code < 80) {
                // Rain
                const isHeavy = code >= 65;
                effectRain.classList.add('active');
                if (isHeavy) effectRain.classList.add('heavy');
                effectRainBack?.classList.add('active');
                weatherContainer.classList.add('rainy');
                effectRain.style.opacity = isHeavy ? '0.6' : '0.4';

            } else if (code >= 51 && code < 61) {
                // Drizzle - light rain
                effectRain.classList.add('active');
                effectRainBack?.classList.add('active');
                weatherContainer.classList.add('rainy');
                effectRain.style.opacity = '0.3';

            } else if (code >= 71 && code < 78 || code >= 85 && code < 87) {
                // Snow
                effectSnow?.classList.add('active');
                effectSnow.style.opacity = code >= 75 ? '0.8' : '0.5';

            } else if (code >= 45 && code < 49) {
                // Fog
                effectClouds?.classList.add('active');
                effectClouds.style.opacity = '0.4';

            } else if (code >= 1 && code <= 3) {
                // Cloudy - subtle clouds
                effectClouds?.classList.add('active');
                effectClouds.style.opacity = '0.2';

            } else if (code === 0 && isNight) {
                // Clear night - show stars
                effectStars?.classList.add('active');
                effectStars.style.opacity = '0.6';
            }
        }

        function parseSummaryCSV(csv) {
            const lines = csv.trim().split(/\r?\n/);
            const summary = {};
            for (const line of lines) {
                const [label, value] = line.split(',').map(v => v.replace(/"/g, '').trim());
                if (label.includes('‰ªäÊó•„ÅÆÊúÄÈ´ò')) summary.todayHigh = parseFloat(value);
                else if (label.includes('‰ªäÊó•„ÅÆÊúÄ‰Ωé')) summary.todayLow = parseFloat(value);
                else if (label.includes('Âπ¥ÈñìÊúÄÈ´ò')) summary.yearHigh = parseFloat(value);
                else if (label.includes('Âπ¥ÈñìÊúÄ‰Ωé')) summary.yearLow = parseFloat(value);
                else if (label.includes('ÁèæÂú®„ÅÆÊ∞óÊ∏©')) summary.currentTemp = parseFloat(value);
                else if (label.includes('ÁèæÂú®„ÅÆÊπøÂ∫¶')) summary.currentHumidity = parseFloat(value);
                else if (label.includes('„Éá„Éº„Çø‰ª∂Êï∞')) summary.dataCount = parseInt(value);
            }
            return summary;
        }

        function parseDailyCSV(csv) {
            return csv.trim().split(/\r?\n/).slice(1).map(line => {
                const [dateStr, max, min] = line.split(',').map(v => v.replace(/"/g, ''));
                const d = new Date(dateStr);
                return !isNaN(d) && !isNaN(parseFloat(max)) ? { date: d, max: parseFloat(max), min: parseFloat(min) } : null;
            }).filter(Boolean).sort((a, b) => a.date - b.date);
        }

        function parseRecentCSV(csv) {
            return csv.trim().split(/\r?\n/).slice(1).map(line => {
                let [dateStr, temp, humidity] = line.split(',').map(v => v.replace(/"/g, ''));
                dateStr = dateStr.replace(/ (\d):/, ' 0$1:');
                const d = new Date(dateStr.replace(' ', 'T'));
                return !isNaN(d) && !isNaN(parseFloat(temp)) ? { date: d, temperature: parseFloat(temp), humidity: parseFloat(humidity) } : null;
            }).filter(Boolean).sort((a, b) => a.date - b.date);
        }

        async function fetchAll() {
            // Progressive Loading: Phase 1 = 24h priority, Phase 2 = background week data

            // Phase 1: Fast initial display with essential data
            await Promise.all([
                fetch(SUMMARY_URL).then(r => r.text()).then(csv => { summaryData = parseSummaryCSV(csv); updateUI(); }),
                fetch(RECENT_URL).then(r => r.text()).then(csv => { recentData = parseRecentCSV(csv); }),
                fetch(WEATHER_URL).then(r => r.json()).then(data => {
                    const hour = new Date().getHours();
                    const hourlyWeather = data.hourly?.weather_code || [];
                    const hourlyPrecip = data.hourly?.precipitation_probability || [];
                    const hourlyTemp = data.hourly?.temperature_2m || [];

                    // Check if weather will worsen in next 3 hours
                    const futureWeatherCodes = hourlyWeather.slice(hour, hour + 4);
                    const currentCode = data.current?.weather_code || 0;
                    const maxFuturePrecipProb = Math.max(...hourlyPrecip.slice(hour, hour + 4));
                    const willWorsen = futureWeatherCodes.some(c => c >= 51) && currentCode < 51;
                    const willImprove = currentCode >= 51 && futureWeatherCodes.every(c => c < 51);

                    weatherData = {
                        weatherCode: currentCode,
                        precipitation: data.current?.precipitation,
                        windSpeed: data.current?.wind_speed_10m,
                        feelsLike: data.current?.apparent_temperature,
                        uvIndex: data.current?.uv_index ?? data.hourly?.uv_index?.[hour] ?? 0,
                        precipProb: hourlyPrecip[hour] || 0,
                        maxUvToday: data.hourly?.uv_index ? Math.max(...data.hourly.uv_index.slice(0, 24)) : 0,
                        futureWeatherCodes: futureWeatherCodes,
                        maxFuturePrecipProb: maxFuturePrecipProb,
                        willWorsen: willWorsen,
                        willImprove: willImprove,
                        tempIn3Hours: hourlyTemp[hour + 3] || null,
                        sunrise: data.daily?.sunrise?.[0] || null,
                        sunset: data.daily?.sunset?.[0] || null,
                        // Rain/Snow detection data (enhanced)
                        groundTemp: data.current?.temperature_2m ?? hourlyTemp[hour] ?? null,
                        temp850hPa: data.hourly?.temperature_850hPa?.[hour] ?? null,
                        temp925hPa: data.hourly?.temperature_925hPa?.[hour] ?? null,
                        wetBulbTemp: data.hourly?.wet_bulb_temperature_2m?.[hour] ?? null,
                        dewPoint: data.current?.dew_point_2m ?? data.hourly?.dew_point_2m?.[hour] ?? null,
                        freezingLevelHeight: data.hourly?.freezing_level_height?.[hour] ?? null,
                        currentSnowfall: data.current?.snowfall ?? 0,
                        currentRain: data.current?.rain ?? 0,
                        // Hourly data for precipitation chart coloring
                        hourlyTemp850hPa: data.hourly?.temperature_850hPa || [],
                        hourlyTemp925hPa: data.hourly?.temperature_925hPa || [],
                        hourlyWetBulb: data.hourly?.wet_bulb_temperature_2m || [],
                        hourlySnowfall: data.hourly?.snowfall || [],
                        hourlyRain: data.hourly?.rain || [],
                        hourlyFreezingLevel: data.hourly?.freezing_level_height || [],
                        // Cloud cover for weather description
                        cloudCover: data.current?.cloud_cover ?? data.hourly?.cloud_cover?.[hour] ?? null,
                        // Additional data for one-line comments
                        visibility: data.current?.visibility ?? null,  // „É°„Éº„Éà„É´
                        windDirection: data.current?.wind_direction_10m ?? null,  // Â∫¶
                        windGusts: data.current?.wind_gusts_10m ?? null,  // m/s
                        pressureMsl: data.current?.pressure_msl ?? null,  // hPa
                        cape: data.hourly?.cape?.[hour] ?? null  // J/kg - Èõ∑Èõ®„Éù„ÉÜ„É≥„Ç∑„É£„É´
                    };
                    applyTheme();
                    // updateWeatherEffects(); // ‰∏ÄÊó¶ÁÑ°ÂäπÂåñ
                    updateUI();
                }).catch(e => { console.log('Weather API error:', e); weatherData = null; })
            ]);

            // Immediately show 24h chart
            updateCharts();
            loadAIComment();
            loadPrecipitation();
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
            document.querySelectorAll('.chart-skeleton').forEach(el => el.classList.add('hidden'));
            updateDataAnalysis();
            fetchAlerts();
            loadAIComment();

            // Phase 2: Background loading of additional data
            setTimeout(async () => {
                try {
                    // Load daily and weekly data in background
                    const [dailyCsv, weeklyCsv] = await Promise.all([
                        fetch(DAILY_URL).then(r => r.text()),
                        fetch(WEEKLY_URL).then(r => r.text()).catch(() => null)
                    ]);

                    dailyData = parseDailyCSV(dailyCsv);
                    if (weeklyCsv) {
                        const newWeeklyData = parseRecentCSV(weeklyCsv);
                        // Merge weekly data with recent data (avoid duplicates by timestamp)
                        const existingTimestamps = new Set(recentData.map(d => d.date.getTime()));
                        const uniqueWeekly = newWeeklyData.filter(d => !existingTimestamps.has(d.date.getTime()));
                        weeklyData = [...uniqueWeekly, ...recentData].sort((a, b) => a.date - b.date);
                    } else {
                        weeklyData = recentData;
                    }

                    // Update charts with full data
                    updateCharts();
                    // Update footer statistics with weekly data
                    updateDataAnalysis();
                    console.log('Phase 2: Weekly data loaded', weeklyData.length, 'records');
                } catch (e) {
                    console.log('Phase 2 background load error:', e);
                    weeklyData = recentData;
                }
            }, 500); // Start Phase 2 after 500ms
        }

        // Load AI advisor comment from ai_comment.json
        async function loadAIComment() {
            try {
                const resp = await fetch('./ai_comment.json?' + Date.now());
                if (!resp.ok) {
                    // File doesn't exist yet, keep section hidden
                    return;
                }
                const data = await resp.json();

                if (data.advice) {
                    // Convert simple markdown to HTML
                    const html = simpleMarkdownToHtml(data.advice);
                    const textEl = document.getElementById('aiAdvisorText');
                    const expandBtn = document.getElementById('aiAdvisorExpand');

                    // Store full text for later
                    textEl.dataset.fullText = html;

                    // Check if user has already expanded - preserve that state
                    const wasExpanded = textEl.dataset.truncated === 'false' && textEl.dataset.fullText;

                    // Truncate if longer than 150 chars
                    const plainText = data.advice;
                    const TRUNCATE_LENGTH = 150;

                    if (plainText.length > TRUNCATE_LENGTH) {
                        if (wasExpanded) {
                            // User had expanded - keep it expanded with new content
                            textEl.innerHTML = html;
                            textEl.dataset.truncated = 'false';
                            expandBtn.textContent = 'Èñâ„Åò„Çã';
                            expandBtn.style.display = 'inline-block';
                        } else {
                            // Find good break point (word boundary)
                            let breakPoint = TRUNCATE_LENGTH;
                            while (breakPoint > 100 && plainText[breakPoint] !== ' ') {
                                breakPoint--;
                            }
                            const truncatedPlain = plainText.substring(0, breakPoint);
                            const truncatedHtml = simpleMarkdownToHtml(truncatedPlain) + '...';
                            textEl.innerHTML = truncatedHtml;
                            textEl.dataset.truncated = 'true';
                            expandBtn.style.display = 'inline-block';
                        }
                    } else {
                        textEl.innerHTML = html;
                        textEl.dataset.truncated = 'false';
                        expandBtn.style.display = 'none';
                    }

                    // Format time
                    if (data.generated_at) {
                        const genTime = new Date(data.generated_at);
                        const timeStr = genTime.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                        document.getElementById('aiAdvisorTime').textContent = `${timeStr} ÁîüÊàê`;
                    }

                    // Show section
                    document.getElementById('aiAdvisorSection').classList.add('show');
                }
            } catch (e) {
                // ai_comment.json not found or parse error, keep hidden
                console.log('AI comment not available:', e.message);
            }
        }

        // ============================================================
        // Rain/Snow Detection System
        // ============================================================

        /**
         * Determine precipitation type based on multiple factors (Enhanced)
         * Uses: weather code, 850hPa temp, 925hPa temp, wet bulb temp, freezing level, ground temp
         * Also references local sensor temperature for more accuracy
         * @param {number} hourIndex - optional hour index for forecast data
         * @returns {string} 'snow' | 'sleet' | 'rain'
         */
        function getPrecipitationType(hourIndex = null) {
            const wc = weatherData?.weatherCode ?? 0;
            const openMeteoTemp = weatherData?.groundTemp ?? null;

            // Get local sensor temperature from recentData
            // recentData is sorted oldest-first (a.date - b.date), so last element is newest
            const localSensorTemp = recentData?.length > 0 ? recentData[recentData.length - 1]?.temperature : null;

            // Use the lower of Open-Meteo temp and local sensor (more conservative for snow detection)
            let groundTemp = openMeteoTemp;
            if (localSensorTemp !== null && openMeteoTemp !== null) {
                groundTemp = Math.min(openMeteoTemp, localSensorTemp);
            } else if (localSensorTemp !== null) {
                groundTemp = localSensorTemp;
            }

            // Get temperatures - use hourly data if hourIndex provided
            let temp850, temp925, wetBulb, freezingLevel;
            if (hourIndex !== null && weatherData?.hourlyTemp850hPa) {
                temp850 = weatherData.hourlyTemp850hPa[hourIndex] ?? null;
                temp925 = weatherData.hourlyTemp925hPa?.[hourIndex] ?? null;
                wetBulb = weatherData.hourlyWetBulb?.[hourIndex] ?? null;
                freezingLevel = weatherData.hourlyFreezingLevel?.[hourIndex] ?? null;
            } else {
                temp850 = weatherData?.temp850hPa ?? null;
                temp925 = weatherData?.temp925hPa ?? null;
                wetBulb = weatherData?.wetBulbTemp ?? null;
                freezingLevel = weatherData?.freezingLevelHeight ?? null;
            }

            // Priority 1: Weather code indicates snow (71-77, 85-86)
            if ((wc >= 71 && wc <= 77) || (wc >= 85 && wc <= 86)) {
                return 'snow';
            }

            // Priority 2: Current snowfall detected
            if (weatherData?.currentSnowfall > 0) {
                return 'snow';
            }

            // ============================================================
            // Composite scoring system for snow/sleet detection
            // ============================================================
            let snowScore = 0;  // Higher = more likely snow

            // Factor 1: Wet bulb temperature (most reliable)
            if (wetBulb !== null) {
                if (wetBulb <= 0) snowScore += 3;
                else if (wetBulb <= 1) snowScore += 2;
                else if (wetBulb <= 2) snowScore += 1;
            }

            // Factor 2: Freezing level height
            if (freezingLevel !== null) {
                if (freezingLevel <= 200) snowScore += 3;
                else if (freezingLevel <= 500) snowScore += 2;
                else if (freezingLevel <= 800) snowScore += 1;
            }

            // Factor 3: 850hPa temperature
            if (temp850 !== null) {
                if (temp850 <= -6) snowScore += 3;
                else if (temp850 <= -4) snowScore += 2;
                else if (temp850 <= -2) snowScore += 1;
            }

            // Factor 4: 925hPa temperature
            if (temp925 !== null) {
                if (temp925 <= -3) snowScore += 2;
                else if (temp925 <= -1) snowScore += 1;
                else if (temp925 <= 1) snowScore += 0.5;
            }

            // Factor 5: Ground temperature (key factor)
            if (groundTemp !== null) {
                if (groundTemp <= 0) snowScore += 3;
                else if (groundTemp <= 1.5) snowScore += 2;
                else if (groundTemp <= 3) snowScore += 1;
                else if (groundTemp <= 4) snowScore += 0.5;
            }

            // ============================================================
            // Decision based on composite score + ground temperature
            // ============================================================

            // Snow: ground temp ‚â§ 1.5¬∞C OR (high score AND ground temp ‚â§ 3¬∞C)
            if (groundTemp !== null && groundTemp <= 1.5) {
                if (snowScore >= 2) return 'snow';  // Cold ground + some upper support
            }
            if (snowScore >= 6 && groundTemp !== null && groundTemp <= 3) {
                return 'snow';  // Strong upper air conditions
            }

            // Sleet: some snow indicators but ground is warmer
            if (snowScore >= 3) {
                return 'sleet';  // Mixed conditions
            }
            if (freezingLevel !== null && freezingLevel <= 800 && groundTemp !== null && groundTemp <= 4) {
                return 'sleet';  // Low freezing level
            }
            if (temp850 !== null && temp850 <= -3 && groundTemp !== null && groundTemp <= 4) {
                return 'sleet';  // Cold upper air
            }

            return 'rain';
        }

        // ============================================================
        // Actual precipitation state (from Yahoo API observation)
        // ============================================================
        let actualPrecipState = {
            isRaining: false,
            rainfall: 0,
            precipType: 'rain',
            consecutiveMinutes: 0  // How many consecutive minutes of rain observed
        };

        // Cache for weather override - persists between refreshes
        let lastWeatherOverride = {
            icon: null,
            condition: null,
            precipType: null,
            timestamp: 0,
            noRainMinutes: 0  // How long since last rain
        };

        /**
         * Update actual precipitation state from Yahoo API data
         * Called from loadPrecipitation()
         */
        function updateActualPrecipState(precipData) {
            if (!precipData || precipData.length === 0) {
                actualPrecipState.isRaining = false;
                actualPrecipState.rainfall = 0;
                actualPrecipState.consecutiveMinutes = 0;
                return;
            }

            // Get observation data only (not forecast)
            const observations = precipData.filter(d => d.type === 'observation');
            if (observations.length === 0) {
                actualPrecipState.isRaining = false;
                actualPrecipState.rainfall = 0;
                actualPrecipState.consecutiveMinutes = 0;
                return;
            }

            // Get latest observation
            const latest = observations[observations.length - 1];
            actualPrecipState.rainfall = latest.rainfall;
            actualPrecipState.isRaining = latest.rainfall > 0;

            // Count consecutive minutes of rain (each data point = 5 minutes)
            let consecutiveCount = 0;
            for (let i = observations.length - 1; i >= 0; i--) {
                if (observations[i].rainfall > 0) {
                    consecutiveCount++;
                } else {
                    break;
                }
            }
            actualPrecipState.consecutiveMinutes = consecutiveCount * 5;  // Each point is 5 min

            // Update precipitation type based on current conditions
            actualPrecipState.precipType = getPrecipitationType();
        }

        /**
         * Get weather display override based on actual precipitation
         * Priority system:
         * 1. Yahoo observation shows precipitation ‚Üí our snow/rain/sleet detection
         * 2. Yahoo 0mm but Open-Meteo rain code ‚Üí show cloudy
         * 3. No precipitation ‚Üí Open-Meteo weather
         * Returns null if no override needed, otherwise {icon, condition}
         */
        function getWeatherOverride() {
            const now = Date.now();
            const wc = weatherData?.weatherCode ?? 0;
            const isOpenMeteoRainCode = (wc >= 51 && wc <= 67) || (wc >= 80 && wc <= 82) || wc >= 95;

            // Priority 1: Yahoo observation shows precipitation (10+ minutes)
            if (actualPrecipState.consecutiveMinutes >= 10 && actualPrecipState.rainfall > 0) {
                const pType = actualPrecipState.precipType;
                const rainfall = actualPrecipState.rainfall;
                const intensity = getPrecipIntensityLabel(rainfall, pType);

                let icon, condition;
                if (pType === 'snow') {
                    icon = '‚ùÑÔ∏è';
                    condition = intensity;
                } else if (pType === 'sleet') {
                    icon = 'üå®Ô∏è';
                    condition = intensity;
                } else {
                    icon = 'üåßÔ∏è';
                    condition = intensity;
                }

                // Update cache
                lastWeatherOverride = {
                    icon,
                    condition,
                    precipType: pType,
                    timestamp: now,
                    noRainMinutes: 0
                };

                return { icon, condition };
            }

            // If currently no rain from Yahoo
            if (actualPrecipState.rainfall === 0) {
                // Check cache first
                if (lastWeatherOverride.timestamp > 0) {
                    lastWeatherOverride.noRainMinutes = (now - lastWeatherOverride.timestamp) / 60000;

                    // Keep showing cached weather for 5 minutes after rain stops
                    if (lastWeatherOverride.noRainMinutes < 5 && lastWeatherOverride.icon) {
                        return {
                            icon: lastWeatherOverride.icon,
                            condition: lastWeatherOverride.condition
                        };
                    } else {
                        // Clear cache after 5 minutes of no rain
                        lastWeatherOverride = { icon: null, condition: null, precipType: null, timestamp: 0, noRainMinutes: 0 };
                    }
                }

                // Priority 2: Open-Meteo says rain but Yahoo shows 0mm ‚Üí show cloudy
                if (isOpenMeteoRainCode) {
                    return { icon: '‚òÅÔ∏è', condition: 'Êõá„Çä' };
                }

                // Priority 3: No precipitation ‚Üí use Open-Meteo (return null)
                return null;
            }

            // If raining but less than 10 minutes, use cache if available
            if (lastWeatherOverride.icon && lastWeatherOverride.precipType === actualPrecipState.precipType) {
                return { icon: lastWeatherOverride.icon, condition: lastWeatherOverride.condition };
            }

            return null;
        }

        /**
         * Update weather display based on actual precipitation override
         */
        function updateWeatherDisplay() {
            const override = getWeatherOverride();
            if (override) {
                const iconEl = document.getElementById('heroWeatherIcon');
                const conditionEl = document.getElementById('heroCondition');

                if (iconEl) iconEl.textContent = override.icon;
                if (conditionEl) conditionEl.textContent = override.condition;
            }
        }

        /**
         * Get precipitation intensity label based on mm/h and type
         * @param {number} rainfall - precipitation in mm/h
         * @param {string} type - 'rain' | 'snow' | 'sleet'
         * @returns {string} intensity label like "„ÇÑ„ÇÑÂº∑„ÅÑÈõ®" or "Âº∑„ÅÑÈõ™"
         */
        function getPrecipIntensityLabel(rainfall, type) {
            if (type === 'snow') {
                // Snow uses relaxed thresholds (snow volume is ~10x water equivalent)
                if (rainfall < 0.3) return 'Âº±„ÅÑÈõ™';
                if (rainfall < 1) return 'Èõ™';
                if (rainfall < 3) return '„ÇÑ„ÇÑÂº∑„ÅÑÈõ™';
                if (rainfall < 6) return 'Âº∑„ÅÑÈõ™';
                return 'ÁåõÁÉà„Å™Èõ™';
            } else if (type === 'sleet') {
                // Sleet („Åø„Åû„Çå)
                if (rainfall < 1) return '„Åø„Åû„Çå';
                if (rainfall < 3) return '„ÇÑ„ÇÑÂº∑„ÅÑ„Åø„Åû„Çå';
                return 'Âº∑„ÅÑ„Åø„Åû„Çå';
            } else {
                // Rain uses JMA official thresholds
                if (rainfall < 1) return 'Âº±„ÅÑÈõ®';
                if (rainfall < 3) return 'Èõ®';
                if (rainfall < 10) return '„ÇÑ„ÇÑÂº∑„ÅÑÈõ®';
                if (rainfall < 20) return 'Âº∑„ÅÑÈõ®';
                if (rainfall < 30) return 'ÊøÄ„Åó„ÅÑÈõ®';
                return 'ÈùûÂ∏∏„Å´ÊøÄ„Åó„ÅÑÈõ®';
            }
        }

        /**
         * Get emoji for precipitation type
         */
        function getPrecipEmoji(type) {
            if (type === 'snow') return '‚ùÑÔ∏è';
            if (type === 'sleet') return 'üå®Ô∏è';
            return 'üåßÔ∏è';
        }

        // Load precipitation data from precipitation.json
        let precipChart = null;
        async function loadPrecipitation() {
            try {
                // Cloudflare WorkerÁµåÁî±„ÅßYahoo Weather API„ÇíÂèñÂæó
                const resp = await fetch('https://yahoo-weather-proxy.miurayukimail.workers.dev');
                if (!resp.ok) return;

                const data = await resp.json();
                if (!data.data || data.data.length === 0) return;

                const precipData = data.data;

                // Update actual precipitation state for weather display override
                updateActualPrecipState(precipData);
                updateWeatherDisplay();  // Refresh weather display with override

                const labels = precipData.map(d => d.time);
                const values = precipData.map(d => d.rainfall);

                // ÈôçÊ∞¥Èáè„Å´Âøú„Åò„ÅüËâ≤„ÇíË®≠ÂÆöÔºàÈõ™/Èõ®„ÅßËâ≤ÂàÜ„ÅëÔºâ
                const getPrecipColor = (rainfall, precipType, alpha = 0.8) => {
                    if (rainfall === 0) return `rgba(148, 163, 184, ${alpha})`; // „Ç∞„É¨„ÉºÔºàÈôçÊ∞¥„Å™„ÅóÔºâ

                    if (precipType === 'snow') {
                        // Èõ™: ÁôΩ+Á¥´„ÅÆ„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ÔºàÂº∑„Åè„Å™„Çã„Åª„Å©ÊøÉ„ÅÑÁ¥´Ôºâ
                        if (rainfall < 0.3) return `rgba(220, 200, 255, ${alpha})`;     // ËñÑÁ¥´ÔºàÂº±„ÅÑÈõ™Ôºâ
                        if (rainfall < 1) return `rgba(190, 160, 250, ${alpha})`;       // Á¥´ÔºàÈõ™Ôºâ
                        if (rainfall < 3) return `rgba(160, 120, 245, ${alpha})`;       // „ÇÑ„ÇÑÊøÉ„ÅÑÁ¥´Ôºà„ÇÑ„ÇÑÂº∑„ÅÑÈõ™Ôºâ
                        if (rainfall < 6) return `rgba(140, 90, 240, ${alpha})`;        // ÊøÉ„ÅÑÁ¥´ÔºàÂº∑„ÅÑÈõ™Ôºâ
                        return `rgba(120, 60, 235, ${alpha})`;                          // ÈùûÂ∏∏„Å´ÊøÉ„ÅÑÁ¥´ÔºàÁåõÁÉà„Å™Èõ™Ôºâ
                    } else if (precipType === 'sleet') {
                        // „Åø„Åû„Çå: ÁôΩ„ÅÆÊøÉÊ∑°ÔºàÂº∑„Åè„Å™„Çã„Åª„Å©Êòé„Çã„Åè„Å™„ÇãÔºâ
                        if (rainfall < 0.5) return `rgba(200, 200, 210, ${alpha})`;     // ËñÑ„ÅÑ„Ç∞„É¨„ÉºÁôΩÔºàÂº±„ÅÑ„Åø„Åû„ÇåÔºâ
                        if (rainfall < 1) return `rgba(210, 210, 220, ${alpha})`;       // „Ç∞„É¨„ÉºÁôΩÔºà„Åø„Åû„ÇåÔºâ
                        if (rainfall < 3) return `rgba(225, 225, 235, ${alpha})`;       // Êòé„Çã„ÅÑ„Ç∞„É¨„ÉºÁôΩÔºà„ÇÑ„ÇÑÂº∑„ÅÑ„Åø„Åû„ÇåÔºâ
                        if (rainfall < 6) return `rgba(240, 240, 248, ${alpha})`;       // „Åª„ÅºÁôΩÔºàÂº∑„ÅÑ„Åø„Åû„ÇåÔºâ
                        return `rgba(250, 250, 255, ${alpha})`;                         // ÁôΩÔºàÁåõÁÉà„Å™„Åø„Åû„ÇåÔºâ
                    } else {
                        // Èõ®: ÈùíÁ≥ª„ÅÆ„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥ÔºàÂæìÊù•ÈÄö„ÇäÔºâ
                        if (rainfall < 1) return `rgba(96, 165, 250, ${alpha})`;        // Ê∞¥Ëâ≤ÔºàÂº±„ÅÑÈõ®Ôºâ
                        if (rainfall < 5) return `rgba(59, 130, 246, ${alpha})`;        // ÈùíÔºà„ÇÑ„ÇÑÂº∑„ÅÑÈõ®Ôºâ
                        if (rainfall < 10) return `rgba(234, 179, 8, ${alpha})`;        // ÈªÑËâ≤ÔºàÂº∑„ÅÑÈõ®Ôºâ
                        if (rainfall < 20) return `rgba(249, 115, 22, ${alpha})`;       // „Ç™„É¨„É≥„Ç∏ÔºàÊøÄ„Åó„ÅÑÈõ®Ôºâ
                        return `rgba(239, 68, 68, ${alpha})`;                           // Ëµ§ÔºàÈùûÂ∏∏„Å´ÊøÄ„Åó„ÅÑÈõ®Ôºâ
                    }
                };

                // ÂêÑÊôÇÈñì„ÅÆÈôçÊ∞¥„Çø„Ç§„Éó„ÇíÂà§ÂÆö
                const currentHour = new Date().getHours();
                const precipTypes = precipData.map((d, i) => {
                    // ÊôÇÂàª„Åã„Çâ‰ΩïÊôÇÈñìÂæå„Åã„ÇíË®àÁÆó„Åó„Å¶hourIndex„ÇíÊ±Ç„ÇÅ„Çã
                    const [hh, mm] = d.time.split(':').map(Number);
                    const hourIndex = hh >= currentHour ? hh : hh + 24;
                    return getPrecipitationType(hourIndex);
                });

                const colors = precipData.map((d, i) =>
                    getPrecipColor(d.rainfall, precipTypes[i], d.type === 'observation' ? 0.9 : 0.7)
                );
                const borderColors = precipData.map((d, i) =>
                    getPrecipColor(d.rainfall, precipTypes[i], 1)
                );

                // „Åô„Åπ„Å¶0mm/h„ÅÆÂ†¥Âêà„ÅØ„Ç´„Éº„Éâ„ÇíÈùûË°®Á§∫
                const hasAnyRain = precipData.some(d => d.rainfall > 0);
                if (!hasAnyRain) {
                    document.getElementById('precipitationCard').style.display = 'none';
                    return;
                }

                // Show card
                document.getElementById('precipitationCard').style.display = 'block';

                // Update time
                if (data.updated_at) {
                    const updTime = new Date(data.updated_at);
                    document.getElementById('precipTime').textContent =
                        updTime.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' }) + ' Êõ¥Êñ∞';
                }

                // Create/update chart
                const ctx = document.getElementById('precipChart').getContext('2d');

                if (precipChart) precipChart.destroy();

                precipChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'ÈôçÊ∞¥Èáè (mm/h)',
                            data: values,
                            backgroundColor: colors,
                            borderColor: borderColors,
                            borderWidth: 1,
                            borderRadius: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                backgroundColor: 'rgba(15, 23, 42, 0.95)',
                                titleColor: '#f8fafc',
                                bodyColor: '#f8fafc',
                                padding: 10,
                                borderColor: 'rgba(99, 102, 241, 0.3)',
                                borderWidth: 1,
                                callbacks: {
                                    label: (tooltipCtx) => {
                                        const idx = tooltipCtx.dataIndex;
                                        const rainfall = tooltipCtx.raw;
                                        const pType = precipTypes[idx];
                                        const emoji = getPrecipEmoji(pType);
                                        const intensity = getPrecipIntensityLabel(rainfall, pType);
                                        return `${emoji} ${intensity} (${rainfall.toFixed(1)} mm/h)`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                grid: { display: false },
                                ticks: {
                                    color: 'rgba(148, 163, 184, 0.8)',
                                    font: { size: 10 }
                                }
                            },
                            y: {
                                beginAtZero: true,
                                grid: { color: 'rgba(148, 163, 184, 0.1)' },
                                ticks: {
                                    color: 'rgba(148, 163, 184, 0.8)',
                                    font: { size: 10 },
                                    callback: (v) => v + ' mm'
                                }
                            }
                        }
                    }
                });

                console.log('Precipitation chart loaded:', precipData.length, 'data points');

                // Èõ®‰∫àÂ†±„Ç¢„É©„Éº„Éà
                const rainAlert = document.getElementById('rainAlert');
                const rainAlertText = document.getElementById('rainAlertText');

                // ‰∫àÂ†±„Éá„Éº„Çø„ÅÆ„ÅøÊäΩÂá∫Ôºàtype === 'forecast'Ôºâ
                const forecastData = precipData.filter(d => d.type === 'forecast');

                // Áõ¥Ëøë„ÅÆÂÆüÊ∏¨„Éá„Éº„ÇøÔºàÊúÄÊñ∞Ôºâ
                const latestObservation = [...precipData].reverse().find(d => d.type === 'observation');
                const isCurrentlyRaining = latestObservation && latestObservation.rainfall > 0;

                // ‰∫àÂ†±„ÅßÈõ®„Åå„ÅÇ„ÇãÊúÄÂàù„ÅÆ„Éá„Éº„Çø„Éù„Ç§„É≥„Éà
                const firstRainForecast = forecastData.find(d => d.rainfall > 0);

                // ‰∫àÂ†±„ÅßÈõ®„Åå„ÅÇ„ÇãÂ†¥Âêà
                const hasRainInForecast = forecastData.some(d => d.rainfall > 0);

                if (isCurrentlyRaining) {
                    // ÁèæÂú®Èôç„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà - Èõ®/Èõ™Âà§ÂÆö„Å®Âº∑Â∫¶„É©„Éô„É´
                    const rainfall = latestObservation.rainfall;
                    const precipType = getPrecipitationType();
                    const intensityLabel = getPrecipIntensityLabel(rainfall, precipType);
                    const emoji = getPrecipEmoji(precipType);

                    let bgColor, borderColor;
                    if (precipType === 'snow') {
                        // Èõ™„ÅØÊ∞¥Ëâ≤„ÄúÁôΩÁ≥ª
                        if (rainfall < 1) {
                            bgColor = 'rgba(147, 197, 253, 0.15)';   // ËñÑ„ÅÑÊ∞¥Ëâ≤
                            borderColor = 'rgba(147, 197, 253, 0.4)';
                        } else if (rainfall < 3) {
                            bgColor = 'rgba(165, 210, 255, 0.18)';   // Ê∞¥Ëâ≤
                            borderColor = 'rgba(165, 210, 255, 0.5)';
                        } else {
                            bgColor = 'rgba(200, 225, 255, 0.2)';    // ÁôΩ„Å£„ÅΩ„ÅÑÊ∞¥Ëâ≤
                            borderColor = 'rgba(200, 225, 255, 0.6)';
                        }
                    } else if (precipType === 'sleet') {
                        // „Åø„Åû„Çå„ÅØÈùíÁ¥´Á≥ª
                        bgColor = 'rgba(139, 92, 246, 0.15)';
                        borderColor = 'rgba(139, 92, 246, 0.4)';
                    } else {
                        // Èõ®„ÅØÂæìÊù•ÈÄö„ÇäÈùíÁ≥ª
                        if (rainfall < 1) {
                            bgColor = 'rgba(96, 165, 250, 0.15)';   // Ê∞¥Ëâ≤ÔºàÂº±„ÅÑÈõ®Ôºâ
                            borderColor = 'rgba(96, 165, 250, 0.4)';
                        } else if (rainfall < 5) {
                            bgColor = 'rgba(59, 130, 246, 0.15)';   // ÈùíÔºà„ÇÑ„ÇÑÂº∑„ÅÑÈõ®Ôºâ
                            borderColor = 'rgba(59, 130, 246, 0.4)';
                        } else if (rainfall < 10) {
                            bgColor = 'rgba(234, 179, 8, 0.15)';    // ÈªÑËâ≤ÔºàÂº∑„ÅÑÈõ®Ôºâ
                            borderColor = 'rgba(234, 179, 8, 0.4)';
                        } else if (rainfall < 20) {
                            bgColor = 'rgba(249, 115, 22, 0.15)';   // „Ç™„É¨„É≥„Ç∏ÔºàÊøÄ„Åó„ÅÑÈõ®Ôºâ
                            borderColor = 'rgba(249, 115, 22, 0.4)';
                        } else {
                            bgColor = 'rgba(239, 68, 68, 0.15)';    // Ëµ§ÔºàÈùûÂ∏∏„Å´ÊøÄ„Åó„ÅÑÈõ®Ôºâ
                            borderColor = 'rgba(239, 68, 68, 0.4)';
                        }
                    }

                    rainAlert.style.display = 'flex';
                    rainAlert.style.background = `linear-gradient(135deg, ${bgColor}, ${bgColor})`;
                    rainAlert.style.borderColor = borderColor;
                    rainAlert.className = 'rain-alert';
                    document.getElementById('rainAlertIcon').textContent = emoji;

                    // Check if precipitation type will change to snow later
                    let transitionMessage = '';
                    if (precipType === 'rain') {
                        const currentHour = new Date().getHours();
                        // Check next 6 hours for snow transition
                        for (let i = 1; i <= 6; i++) {
                            const futureHourIndex = currentHour + i;
                            const futureType = getPrecipitationType(futureHourIndex);
                            if (futureType === 'snow' || futureType === 'sleet') {
                                const futureRainfall = weatherData?.hourlySnowfall?.[futureHourIndex] || rainfall;
                                const futureIntensity = getPrecipIntensityLabel(futureRainfall, futureType);
                                const futureEmoji = getPrecipEmoji(futureType);
                                transitionMessage = ` ‚Üí Á¥Ñ${i * 60}ÂàÜÂæå„Å´${futureEmoji}${futureIntensity}„Å´Â§â„Çè„ÇãË¶ãËæº„Åø`;
                                break;
                            }
                        }
                    } else if (precipType === 'sleet') {
                        // Check if it will become full snow
                        const currentHour = new Date().getHours();
                        for (let i = 1; i <= 6; i++) {
                            const futureHourIndex = currentHour + i;
                            const futureType = getPrecipitationType(futureHourIndex);
                            if (futureType === 'snow') {
                                const futureRainfall = weatherData?.hourlySnowfall?.[futureHourIndex] || rainfall;
                                const futureIntensity = getPrecipIntensityLabel(futureRainfall, 'snow');
                                transitionMessage = ` ‚Üí Á¥Ñ${i * 60}ÂàÜÂæå„Å´‚ùÑÔ∏è${futureIntensity}„Å´Â§â„Çè„ÇãË¶ãËæº„Åø`;
                                break;
                            }
                        }
                    }

                    rainAlertText.textContent = `ÁèæÂú® ${rainfall.toFixed(1)}mm/h „ÅÆ${intensityLabel}„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô${transitionMessage}`;
                } else if (hasRainInForecast && firstRainForecast) {
                    // „Åì„Çå„Åã„ÇâÈôç„ÇãÂ†¥Âêà
                    const now = new Date();
                    const forecastTime = firstRainForecast.datetime;
                    // datetime„ÅÆÂΩ¢Âºè: "202512271150" or ISO
                    let rainTime;
                    if (forecastTime.length === 12) {
                        rainTime = new Date(
                            parseInt(forecastTime.substring(0, 4)),
                            parseInt(forecastTime.substring(4, 6)) - 1,
                            parseInt(forecastTime.substring(6, 8)),
                            parseInt(forecastTime.substring(8, 10)),
                            parseInt(forecastTime.substring(10, 12))
                        );
                    } else {
                        rainTime = new Date(forecastTime);
                    }
                    const minutesUntilRain = Math.round((rainTime - now) / 1000 / 60);

                    if (minutesUntilRain > 0) {
                        // ‰∫àÂ†±„ÅÆÈôçÊ∞¥Èáè„Åã„ÇâÂº∑Â∫¶„ÇíÂà§ÂÆö
                        const forecastRainfall = firstRainForecast.rainfall;
                        const precipType = getPrecipitationType();
                        const intensityLabel = getPrecipIntensityLabel(forecastRainfall, precipType);
                        const emoji = getPrecipEmoji(precipType);

                        rainAlert.style.display = 'flex';
                        rainAlert.className = 'rain-alert';
                        document.getElementById('rainAlertIcon').textContent = emoji;
                        rainAlertText.textContent = `Á¥Ñ${minutesUntilRain}ÂàÜÂæå„Å´${intensityLabel}„ÅåÈôç„ÇäÂßã„ÇÅ„Çã‰∫àÂ†±„Åß„Åô`;
                    } else {
                        rainAlert.style.display = 'none';
                    }
                } else {
                    // Èõ®„ÅÆ‰∫àÂ†±„Å™„Åó
                    rainAlert.style.display = 'none';
                }
            } catch (e) {
                console.log('Precipitation data not available:', e.message);
            }
        }

        // Load sunrise/sunset times and pressure from Open-Meteo
        async function loadSunTimes() {
            try {
                const LAT = 35.77877;
                const LON = 139.87817;
                const url = `https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&daily=sunrise,sunset&current=surface_pressure&timezone=Asia/Tokyo&forecast_days=1`;
                const resp = await fetch(url);
                if (!resp.ok) return;

                const data = await resp.json();
                if (data.daily && data.daily.sunrise && data.daily.sunset) {
                    const sunrise = new Date(data.daily.sunrise[0]);
                    const sunset = new Date(data.daily.sunset[0]);

                    const formatTime = (d) => d.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });

                    document.getElementById('sunriseTime').textContent = formatTime(sunrise);
                    document.getElementById('sunsetTime').textContent = formatTime(sunset);


                }

                // Display pressure
                if (data.current && data.current.surface_pressure) {
                    document.getElementById('heroPressure').textContent = Math.round(data.current.surface_pressure);
                }
            } catch (e) {
                console.log('Sun times not available:', e.message);
            }
        }

        // =====================================================
        // MOON CALCULATIONS & DISPLAY
        // =====================================================

        // Global cache for moon arc real-time updates
        let cachedMoonTimes = null;
        let moonPositionInterval = null;

        async function loadMoonData() {
            const now = new Date(); // Real-time mode
            const LAT = 35.7785;
            const LON = 139.878;

            // Calculate local values (fallback)
            const moonData = calculateMoonPhase(now);
            const moonPos = calculateMoonPosition(now, LAT, LON);
            let moonTimes = calculateMoonTimes(now, LAT, LON);

            // Try to load API data from moon_data.json
            try {
                const resp = await fetch('moon_data.json?_=' + Date.now());
                if (resp.ok) {
                    const apiData = await resp.json();
                    // Override times with API values if available
                    if (apiData.moonrise && apiData.moonrise !== '--:--') {
                        moonTimes.rise = apiData.moonrise;
                    }
                    if (apiData.moonset && apiData.moonset !== '--:--') {
                        moonTimes.set = apiData.moonset;
                        // Track if moonset is tomorrow
                        if (apiData.moonset_is_tomorrow) {
                            moonTimes.setIsTomorrow = true;
                        }
                    }
                    // Track if moonrise is yesterday
                    if (apiData.moonrise_is_yesterday) {
                        moonTimes.riseIsYesterday = true;
                    }
                    // Override directions with API values
                    if (apiData.moonrise_direction) {
                        moonTimes.riseDirJp = apiData.moonrise_direction;
                    }
                    if (apiData.moonset_direction) {
                        moonTimes.setDirJp = apiData.moonset_direction;
                    }
                    // Use API moon age if available
                    if (apiData.moon_age !== null && apiData.moon_age !== undefined) {
                        document.getElementById('moonAge').textContent = apiData.moon_age.toFixed(1);
                    } else {
                        document.getElementById('moonAge').textContent = moonData.age.toFixed(1);
                    }
                    // Use API illumination if available
                    if (apiData.illumination !== null && apiData.illumination !== undefined) {
                        document.getElementById('moonIllumination').textContent = Math.round(apiData.illumination);
                    } else {
                        document.getElementById('moonIllumination').textContent = Math.round(moonData.illumination * 100);
                    }
                    console.log('[Moon] Using API data:', apiData.moonrise, '-', apiData.moonset,
                        'Dirs:', apiData.moonrise_direction, '-', apiData.moonset_direction,
                        'Illumination:', apiData.illumination + '%');
                } else {
                    document.getElementById('moonAge').textContent = moonData.age.toFixed(1);
                    document.getElementById('moonIllumination').textContent = Math.round(moonData.illumination * 100);
                }
            } catch (e) {
                console.log('[Moon] API data not available, using calculation:', e.message);
                document.getElementById('moonAge').textContent = moonData.age.toFixed(1);
                document.getElementById('moonIllumination').textContent = Math.round(moonData.illumination * 100);
            }

            // Cache moon times for real-time updates
            cachedMoonTimes = moonTimes;

            // Display phase info
            const moonIconEl = document.getElementById('moonIcon');
            const moonPhaseNameEl = document.getElementById('moonPhaseName');

            moonIconEl.textContent = moonData.emoji;

            // Ê∫ÄÊúà„ÅÆÂ†¥Âêà„ÅØÁâπÂà•„Å™ÂêçÂâç„Å®Ëâ≤„ÇíË°®Á§∫
            if (moonData.fullMoonName) {
                moonPhaseNameEl.innerHTML = `${moonData.phaseName}<br><span style="font-size: 0.85em; color: ${moonData.fullMoonColor};">üåü ${moonData.fullMoonName}</span>`;
                moonIconEl.style.filter = `drop-shadow(0 0 12px ${moonData.fullMoonColor}) drop-shadow(0 0 24px ${moonData.fullMoonColor})`;
                moonIconEl.style.color = moonData.fullMoonColor;
            } else {
                moonPhaseNameEl.textContent = moonData.phaseName;
                moonIconEl.style.filter = '';
                moonIconEl.style.color = '';
            }

            // Display times in SVG
            const riseTimeEl = document.getElementById('moonRiseTimeSvg');
            const setTimeEl = document.getElementById('moonSetTimeSvg');
            if (riseTimeEl) riseTimeEl.textContent = moonTimes.rise || '--:--';
            if (setTimeEl) setTimeEl.textContent = moonTimes.set || '--:--';

            // Display rise/set directions from API or fallback
            const riseDirEl = document.getElementById('moonRiseDirSvg');
            const setDirEl = document.getElementById('moonSetDirSvg');
            // Show '--' if time is not available, otherwise use API direction or fallback
            if (riseDirEl) {
                riseDirEl.textContent = (moonTimes.rise === '--:--') ? '--' : (moonTimes.riseDirJp || 'Êù±');
            }
            if (setDirEl) {
                setDirEl.textContent = (moonTimes.set === '--:--') ? '--' : (moonTimes.setDirJp || 'Ë•ø');
            }

            // Display current position info in SVG (only when above horizon)
            const currentInfoEl = document.getElementById('moonCurrentInfoSvg');
            if (currentInfoEl) {
                if (moonPos.altitude > 0) {
                    currentInfoEl.textContent = `${getJapaneseCompassDirection(moonPos.azimuth)} ${Math.round(moonPos.altitude)}¬∞`;
                } else {
                    currentInfoEl.textContent = '';
                }
            }

            // Calculate next full moon
            const synodic = 29.53058867;
            const daysToFull = (14.77 - moonData.age + synodic) % synodic;
            const nextPhaseTextEl = document.getElementById('moonNextPhaseText');
            if (nextPhaseTextEl) {
                if (daysToFull < 1) {
                    nextPhaseTextEl.textContent = 'Ê∫ÄÊúà üåï';
                } else if (moonData.age < 14.77) {
                    nextPhaseTextEl.textContent = `Ê∫ÄÊúà„Åæ„Åß${Math.round(daysToFull)}Êó•`;
                } else {
                    const daysToNew = synodic - moonData.age;
                    nextPhaseTextEl.textContent = `Êñ∞Êúà„Åæ„Åß${Math.round(daysToNew)}Êó•`;
                }
            }

            // Update arc position (pass current time for time-based positioning)
            updateMoonArcPosition(moonPos, moonTimes, now);

            // Start real-time position updates (every 1 minute)
            startMoonPositionTimer();
        }

        // Real-time moon position update (every 1 minute)
        function startMoonPositionTimer() {
            // Clear any existing interval
            if (moonPositionInterval) {
                clearInterval(moonPositionInterval);
            }

            const LAT = 35.7785;
            const LON = 139.878;

            // Update every 60 seconds
            moonPositionInterval = setInterval(() => {
                if (!cachedMoonTimes) return;

                const now = new Date();
                const moonPos = calculateMoonPosition(now, LAT, LON);

                // Update arc position
                updateMoonArcPosition(moonPos, cachedMoonTimes, now);

                // Update current position text
                const currentInfoEl = document.getElementById('moonCurrentInfoSvg');
                if (currentInfoEl) {
                    if (moonPos.altitude > 0) {
                        currentInfoEl.textContent = `${getJapaneseCompassDirection(moonPos.azimuth)} ${Math.round(moonPos.altitude)}¬∞`;
                    } else {
                        currentInfoEl.textContent = '';
                    }
                }

                console.log('[Moon] Position updated:',
                    'Alt:', moonPos.altitude.toFixed(1) + '¬∞',
                    'Az:', moonPos.azimuth.toFixed(1) + '¬∞',
                    'Dir:', getJapaneseCompassDirection(moonPos.azimuth));

                // „É™„Ç¢„É´„Çø„Ç§„É†„ÅßÊúàÈΩ¢„ÉªËºùÈù¢Áéá„ÇÇÊõ¥Êñ∞
                const moonPhaseNow = calculateMoonPhase(now);
                document.getElementById('moonAge').textContent = moonPhaseNow.age.toFixed(1);
                document.getElementById('moonIllumination').textContent = Math.round(moonPhaseNow.illumination * 100);
            }, 60000); // 60 seconds

            console.log('[Moon] Real-time position updates started (60s interval)');
        }

        function calculateMoonPhase(date) {
            // Reference new moon: Jan 6, 2000 18:14 UTC
            const refNewMoon = new Date(Date.UTC(2000, 0, 6, 18, 14, 0));
            const synodic = 29.53058867; // Synodic month in days

            const daysSinceRef = (date - refNewMoon) / (1000 * 60 * 60 * 24);
            const age = daysSinceRef % synodic;
            const normalizedAge = age < 0 ? age + synodic : age;

            // Phase (0-1)
            const phase = normalizedAge / synodic;

            // Illumination (simplified)
            const illumination = (1 - Math.cos(2 * Math.PI * phase)) / 2;

            // Phase name and emoji
            let phaseName, emoji, fullMoonName = null, fullMoonColor = null;

            // Full moon names by month with themed colors
            const fullMoonNames = {
                1: { name: '„Ç¶„É´„Éï„É†„Éº„É≥', nameEn: 'Wolf Moon', color: '#a3c4dc' },      // ÂÜ¨„ÅÆÈùíÁôΩ„ÅÑÊúà
                2: { name: '„Çπ„Éé„Éº„É†„Éº„É≥', nameEn: 'Snow Moon', color: '#e8f4fc' },      // Èõ™„ÅÆ„Çà„ÅÜ„Å™Á¥îÁôΩ
                3: { name: '„ÉØ„Éº„É†„É†„Éº„É≥', nameEn: 'Worm Moon', color: '#c9a87c' },      // Âúü„ÅÆÊ∏©„Åã„Åø
                4: { name: '„Éî„É≥„ÇØ„É†„Éº„É≥', nameEn: 'Pink Moon', color: '#f8b4c4' },      // Ê°ú„ÅÆ„Éî„É≥„ÇØ
                5: { name: '„Éï„É©„ÉØ„Éº„É†„Éº„É≥', nameEn: 'Flower Moon', color: '#f0e68c' },  // Ëä±„ÅÆÈªÑËâ≤
                6: { name: '„Çπ„Éà„É≠„Éô„É™„Éº„É†„Éº„É≥', nameEn: 'Strawberry Moon', color: '#ff9999' }, // „Ç§„ÉÅ„Ç¥Ëâ≤
                7: { name: '„Éê„ÉÉ„ÇØ„É†„Éº„É≥', nameEn: 'Buck Moon', color: '#daa520' },      // Èπø„ÅÆËßí„ÅÆ„Ç¥„Éº„É´„Éâ
                8: { name: '„Çπ„Çø„Éº„Ç∏„Éß„É≥„É†„Éº„É≥', nameEn: 'Sturgeon Moon', color: '#87ceeb' }, // Êπñ„ÅÆÈùí
                9: { name: '„Éè„Éº„Éô„Çπ„Éà„É†„Éº„É≥', nameEn: 'Harvest Moon', color: '#ff8c00' }, // ÂèéÁ©´„ÅÆ„Ç™„É¨„É≥„Ç∏
                10: { name: '„Éè„É≥„Çø„Éº„Ç∫„É†„Éº„É≥', nameEn: "Hunter's Moon", color: '#cd5c5c' }, // Áã©„Çä„ÅÆËµ§Ëå∂
                11: { name: '„Éì„Éº„Éê„Éº„É†„Éº„É≥', nameEn: 'Beaver Moon', color: '#8b4513' },  // „Éì„Éº„Éê„Éº„ÅÆËå∂Ëâ≤
                12: { name: '„Ç≥„Éº„É´„Éâ„É†„Éº„É≥', nameEn: 'Cold Moon', color: '#b0c4de' }     // ÂÜ∑„Åü„ÅÑÈùíÁÅ∞Ëâ≤
            };

            // ÊúàÈΩ¢„Å´Âü∫„Å•„Åè‰ºùÁµ±ÁöÑ„Å™ÂíåÂêçÔºàÂÖ®30Êó•ÂàÜÔºâ
            const moonAge = Math.floor(normalizedAge);

            if (normalizedAge < 0.5) {
                phaseName = 'Êñ∞ÊúàÔºàÊúîÔºâ';
                emoji = 'üåë';
            } else if (normalizedAge < 1.5) {
                phaseName = '‰∫åÊó•ÊúàÔºàÁπäÊúàÔºâ';
                emoji = 'üåë';
            } else if (normalizedAge < 2.5) {
                phaseName = '‰∏âÊó•Êúà';
                emoji = 'üåí';
            } else if (normalizedAge < 6.5) {
                phaseName = `${moonAge + 1}Êó•Êúà`;
                emoji = 'üåí';
            } else if (normalizedAge < 7.5) {
                phaseName = '‰∏äÂº¶„ÅÆÊúà';
                emoji = 'üåì';
            } else if (normalizedAge < 9.5) {
                phaseName = `${moonAge + 1}Êó•Êúà`;
                emoji = 'üåì';
            } else if (normalizedAge < 10.5) {
                phaseName = 'ÂçÅÊó•Â§ú';
                emoji = 'üåî';
            } else if (normalizedAge < 12.5) {
                phaseName = `${moonAge + 1 === 12 ? 'ÂçÅ‰∫å' : moonAge + 1}Êó•Êúà`;
                emoji = 'üåî';
            } else if (normalizedAge < 13.5) {
                phaseName = 'ÂçÅ‰∏âÂ§ú';
                emoji = 'üåî';
            } else if (normalizedAge < 14.5) {
                phaseName = 'Â∞èÊúõÊúàÔºàÂæÖÂÆµÊúàÔºâ';
                emoji = 'üåî';
            } else if (normalizedAge < 16.0 || illumination >= 0.98) {
                // Ê∫ÄÊúà„ÅÆÂ†¥Âêà„ÄÅÊúà„Åî„Å®„ÅÆÂêçÂâç„Å®Ëâ≤„ÇíÂèñÂæó
                const currentMonth = date.getMonth() + 1;
                const moonInfo = fullMoonNames[currentMonth];
                phaseName = 'Ê∫ÄÊúàÔºàÊúõÊúàÔºâ';
                emoji = 'üåï';
                fullMoonName = moonInfo.name;
                fullMoonColor = moonInfo.color;
            } else if (normalizedAge < 17.0) {
                phaseName = 'ÂçÅÂÖ≠Â§úÔºà„ÅÑ„Åñ„Çà„ÅÑÔºâ';
                emoji = 'üåï';
            } else if (normalizedAge < 18.0) {
                phaseName = 'Á´ãÂæÖÊúà';
                emoji = 'üåñ';
            } else if (normalizedAge < 19.0) {
                phaseName = 'Â±ÖÂæÖÊúà';
                emoji = 'üåñ';
            } else if (normalizedAge < 20.0) {
                phaseName = 'ÂØùÂæÖÊúàÔºàËá•ÂæÖÊúàÔºâ';
                emoji = 'üåñ';
            } else if (normalizedAge < 21.0) {
                phaseName = 'Êõ¥ÂæÖÊúà';
                emoji = 'üåñ';
            } else if (normalizedAge < 22.5) {
                phaseName = '‰∏ãÂº¶„ÅÆÊúà';
                emoji = 'üåó';
            } else if (normalizedAge < 23.5) {
                phaseName = '‰∫åÂçÅ‰∏âÂ§ú';
                emoji = 'üåó';
            } else if (normalizedAge < 25.5) {
                phaseName = `‰∫åÂçÅ${moonAge - 18}Êó•Êúà`;
                emoji = 'üåò';
            } else if (normalizedAge < 26.5) {
                phaseName = '‰∫åÂçÅÂÖ≠Â§ú';
                emoji = 'üåò';
            } else if (normalizedAge < 29.5) {
                phaseName = 'Êô¶Êó•ÊúàÔºà‰∏âÂçÅÊó•ÊúàÔºâ';
                emoji = 'üåò';
            } else {
                phaseName = 'Êñ∞ÊúàÔºàÊúîÔºâ';
                emoji = 'üåë';
            }

            return { age: normalizedAge, phase, illumination, phaseName, emoji, fullMoonName, fullMoonColor };
        }

        function calculateMoonPosition(date, lat, lon) {
            const jd = getJulianDate(date);
            const T = (jd - 2451545.0) / 36525;

            // Moon's mean elements (simplified)
            const L = (218.3164477 + 481267.88123421 * T) % 360;
            const M = (134.9633964 + 477198.8675055 * T) % 360;
            const F = (93.2720950 + 483202.0175233 * T) % 360;

            // Approximate Right Ascension and Declination
            const Lrad = L * Math.PI / 180;
            const Mrad = M * Math.PI / 180;
            const Frad = F * Math.PI / 180;

            // Simplified ecliptic longitude
            let lambda = L + 6.29 * Math.sin(Mrad);
            lambda = lambda % 360;
            const lambdaRad = lambda * Math.PI / 180;

            // Approximate declination
            const epsilon = 23.439 - 0.00000036 * T;
            const epsilonRad = epsilon * Math.PI / 180;

            const dec = Math.asin(Math.sin(epsilonRad) * Math.sin(lambdaRad)) * 180 / Math.PI;
            const ra = Math.atan2(Math.cos(epsilonRad) * Math.sin(lambdaRad), Math.cos(lambdaRad)) * 180 / Math.PI;

            // Local Sidereal Time
            // Use UTC hours/minutes for Sidereal Time calculation
            const LST = (100.46 + 0.985647 * (jd - 2451545.0) + lon + date.getUTCHours() * 15 + date.getUTCMinutes() * 0.25) % 360;

            // Hour angle
            let HA = LST - ra;
            if (HA < 0) HA += 360;
            const HARad = HA * Math.PI / 180;
            const latRad = lat * Math.PI / 180;
            const decRad = dec * Math.PI / 180;

            // Altitude
            const altitude = Math.asin(
                Math.sin(latRad) * Math.sin(decRad) +
                Math.cos(latRad) * Math.cos(decRad) * Math.cos(HARad)
            ) * 180 / Math.PI;

            // Azimuth
            let azimuth = Math.atan2(
                Math.sin(HARad),
                Math.cos(HARad) * Math.sin(latRad) - Math.tan(decRad) * Math.cos(latRad)
            ) * 180 / Math.PI + 180;

            // Approximate max altitude for today
            const maxAltitude = 90 - lat + dec;

            return { altitude, azimuth: azimuth % 360, maxAltitude: Math.min(90, Math.max(0, maxAltitude)) };
        }

        function calculateMoonTimes(date, lat, lon) {
            // High-precision simulation to match calculatingMoonPosition
            // Iterate from 00:00 to 24:00 to find horizon crossings
            const dayStart = new Date(date);
            dayStart.setHours(0, 0, 0, 0);

            let rise = null;
            let set = null;
            let riseAzimuth = null;
            let setAzimuth = null;

            let prevPos = calculateMoonPosition(dayStart, lat, lon);

            // 1-minute intervals (1440 steps) for maximum precision
            for (let i = 1; i <= 1440; i++) {
                const t = new Date(dayStart.getTime() + i * 60 * 1000);
                const currPos = calculateMoonPosition(t, lat, lon);

                // Apply approximate Parallax correction (-0.95 deg)
                // Geocentric altitude is ~1 deg higher than Topocentric (observed) altitude at horizon.
                // Subtracting this makes the moon lower, causing it to set earlier.
                const alt1 = prevPos.altitude - 0.95;
                const alt2 = currPos.altitude - 0.95;

                // Check Horizon Crossing
                if (alt1 < 0 && alt2 >= 0) {
                    // Moonrise
                    const fraction = (0 - alt1) / (alt2 - alt1);
                    const riseMs = t.getTime() - 60 * 1000 + fraction * 60 * 1000;
                    rise = new Date(riseMs);
                    riseAzimuth = prevPos.azimuth + (currPos.azimuth - prevPos.azimuth) * fraction;
                }
                if (alt1 >= 0 && alt2 < 0) {
                    // Moonset
                    const fraction = (0 - alt1) / (alt2 - alt1);
                    const setMs = t.getTime() - 60 * 1000 + fraction * 60 * 1000;
                    set = new Date(setMs);
                    setAzimuth = prevPos.azimuth + (currPos.azimuth - prevPos.azimuth) * fraction;
                }
                prevPos = currPos;
            }

            const formatHour = (d) => {
                if (!d) return '--:--';
                return d.toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
            };

            // Directions based on calculated azimuth if available
            const moonData = calculateMoonPhase(date);
            const age = moonData.age;

            // Fallback directions (simplified) if not found (e.g. not rising today)
            let riseDirJp = age < 14.77 ? 'Êù±ÂçóÊù±' : 'Êù±ÂåóÊù±';
            let setDirJp = age < 14.77 ? 'Ë•øÂçóË•ø' : 'Ë•øÂåóË•ø';

            if (riseAzimuth) riseDirJp = getJapaneseCompassDirection(riseAzimuth);
            if (setAzimuth) setDirJp = getJapaneseCompassDirection(setAzimuth);

            // Determine if moonset is tomorrow (moon rose today but doesn't set today)
            let setIsTomorrow = false;
            if (rise && !set) {
                // Moon rose today but doesn't set today - moonset is tomorrow
                setIsTomorrow = true;
            }

            return {
                rise: formatHour(rise),
                set: formatHour(set),
                riseDirJp,
                setDirJp,
                setIsTomorrow,
                riseDate: rise,
                setDate: set
            };
        }

        function getJulianDate(date) {
            const y = date.getUTCFullYear();
            const m = date.getUTCMonth() + 1;
            const d = date.getUTCDate() + date.getUTCHours() / 24 + date.getUTCMinutes() / 1440;

            let Y = y, M = m;
            if (M <= 2) { Y -= 1; M += 12; }

            const A = Math.floor(Y / 100);
            const B = 2 - A + Math.floor(A / 4);

            return Math.floor(365.25 * (Y + 4716)) + Math.floor(30.6001 * (M + 1)) + d + B - 1524.5;
        }

        function getCompassDirection(azimuth) {
            const directions = ['N', 'NNE', 'NE', 'ENE', 'E', 'ESE', 'SE', 'SSE', 'S', 'SSW', 'SW', 'WSW', 'W', 'WNW', 'NW', 'NNW'];
            const idx = Math.round(azimuth / 22.5) % 16;
            return directions[idx];
        }

        function getJapaneseCompassDirection(azimuth) {
            const directions = ['Âåó', 'ÂåóÂåóÊù±', 'ÂåóÊù±', 'Êù±ÂåóÊù±', 'Êù±', 'Êù±ÂçóÊù±', 'ÂçóÊù±', 'ÂçóÂçóÊù±', 'Âçó', 'ÂçóÂçóË•ø', 'ÂçóË•ø', 'Ë•øÂçóË•ø', 'Ë•ø', 'Ë•øÂåóË•ø', 'ÂåóË•ø', 'ÂåóÂåóË•ø'];
            const idx = Math.round(azimuth / 22.5) % 16;
            return directions[idx];
        }



        function updateMoonArcPosition(moonPos, moonTimes, currentTime) {
            const moonCircle = document.getElementById('moonPosition');
            const moonGlow = document.getElementById('moonGlowCircle');
            const moonInfoGroup = document.getElementById('moonCurrentInfoGroup');
            const moonInfoText = document.getElementById('moonCurrentInfoSvg');
            const moonInfoBg = document.getElementById('moonInfoBg');
            if (!moonCircle) return;

            // Parse rise and set times to get hours as decimal
            const parseTime = (timeStr) => {
                if (!timeStr || timeStr === '--:--') return null;
                // Remove 'Áøå' (tomorrow) or 'ÂâçÊó•' (yesterday) prefix if present
                let cleanTime = timeStr.replace(/^(Áøå|ÂâçÊó•)/, '');
                const match = cleanTime.match(/(\d+):(\d+)/);
                if (!match) return null;
                const h = parseInt(match[1], 10);
                const m = parseInt(match[2], 10);
                return h + m / 60;
            };

            const riseHour = parseTime(moonTimes.rise);
            const setHour = parseTime(moonTimes.set);
            const currentHour = currentTime.getHours() + currentTime.getMinutes() / 60;

            // Calculate t based on TIME, not azimuth
            // Rise = 0%, Transit (midpoint) = 50%, Set = 100%
            let t = 0.5; // Default to center if no times available
            let isVisible = false;

            // Case 1: Both rise and set times available today
            if (riseHour !== null && setHour !== null && !moonTimes.setIsTomorrow) {
                if (currentHour >= riseHour && currentHour <= setHour) {
                    // Moon is above horizon
                    const duration = setHour - riseHour;
                    t = duration > 0 ? (currentHour - riseHour) / duration : 0.5;
                    isVisible = true;
                } else if (currentHour < riseHour) {
                    // Before moonrise
                    t = 0;
                    isVisible = false;
                } else {
                    // After moonset
                    t = 1;
                    isVisible = false;
                }
            }
            // Case 2: Moonset is tomorrow (moon rises today, sets tomorrow morning)
            else if (riseHour !== null && (moonTimes.setIsTomorrow || setHour === null)) {
                // Ê∑±Â§ú0ÊôÇ„ÇíÈÅé„Åé„ÅüÂ†¥Âêà„ÅÆÂá¶ÁêÜ„ÇíËøΩÂä†
                // ‰æã: Êúà„ÅÆÂá∫15:00„ÄÅÊúà„ÅÆÂÖ•„ÇäÁøå5:00 ‚Üí Ê∑±Â§ú1ÊôÇ„ÅØÂèØË¶ñ
                if (currentHour >= riseHour) {
                    // After moonrise today - moon is visible
                    isVisible = true;
                    const hoursSinceRise = currentHour - riseHour;
                    t = Math.min(0.9, hoursSinceRise / 12);
                } else if (moonTimes.setIsTomorrow && setHour !== null && currentHour <= setHour) {
                    // Ê∑±Â§ú0ÊôÇ„ÄúÊúà„ÅÆÂÖ•„Çä„Åæ„Åß„ÅÆÊôÇÈñìÂ∏ØÔºàÊó•‰ªò„Çí„Åæ„Åü„ÅÑ„Å†ÂæåÔºâ
                    // Êúà„ÅØÊò®Êó•„ÅÆÂçàÂæå„Å´Âá∫„Å¶„ÄÅ‰ªäÊúùÊ≤à„ÇÄ ‚Üí „Åæ„Å†ÂèØË¶ñ
                    isVisible = true;
                    // Êúà„ÅÆÂá∫„Åã„ÇâÁèæÂú®„Åæ„Åß: (24 - riseHour) + currentHour ÊôÇÈñì
                    const hoursSinceRise = (24 - riseHour) + currentHour;
                    const totalDuration = (24 - riseHour) + setHour;
                    t = Math.min(0.95, hoursSinceRise / totalDuration);
                } else if (currentHour < riseHour && (!moonTimes.setIsTomorrow || setHour === null)) {
                    // Before moonrise today (and no tomorrow set data)
                    t = 0;
                    isVisible = false;
                } else {
                    // After moonset tomorrow
                    t = 1;
                    isVisible = false;
                }
            }
            // Case 3: No rise today but maybe set (moon rose yesterday, sets today)
            else if (riseHour === null && setHour !== null) {
                if (currentHour <= setHour) {
                    // Moon is still up from yesterday
                    isVisible = true;
                    t = 0.5 + (currentHour / setHour) * 0.5; // Approaching set
                } else {
                    // After moonset
                    t = 1;
                    isVisible = false;
                }
            }
            // Case 4: No data for either - use altitude calculation as fallback
            else {
                isVisible = moonPos.altitude > 0;
                t = 0.5;
            }

            // Clamp t for position calculation
            const clampedT = Math.max(0, Math.min(1, t));

            // New SVG Coordinates (viewBox 0 0 340 200)
            // Start: 40,150 | Control: 170,-20 | End: 300,150
            const P0 = { x: 40, y: 150 };
            const P1 = { x: 170, y: -20 };
            const P2 = { x: 300, y: 150 };

            // Quadratic bezier calculation
            const mt = 1 - clampedT;
            const x = mt * mt * P0.x + 2 * mt * clampedT * P1.x + clampedT * clampedT * P2.x;
            const y = mt * mt * P0.y + 2 * mt * clampedT * P1.y + clampedT * clampedT * P2.y;

            // Set Position - if below horizon, place at horizon level
            const finalY = isVisible ? y : 160; // Below horizon line (150)
            const opacity = isVisible ? 1 : 0.4;
            const fillColor = isVisible ? '#fbbf24' : '#94a3b8'; // Yellow if visible, gray if not

            moonCircle.setAttribute('cx', x);
            moonCircle.setAttribute('cy', finalY);
            moonCircle.setAttribute('fill', fillColor);
            moonCircle.style.opacity = opacity;

            if (moonGlow) {
                moonGlow.setAttribute('cx', x);
                moonGlow.setAttribute('cy', finalY);
                moonGlow.style.opacity = isVisible ? 1 : 0;
            }

            // Update Info Label
            if (moonInfoGroup && moonInfoText && moonInfoBg) {
                if (isVisible) {
                    // Update text with current position
                    const altText = `${Math.round(moonPos.altitude)}¬∞`;
                    const dirText = getJapaneseCompassDirection(moonPos.azimuth);
                    moonInfoText.textContent = `${dirText} ${altText}`;
                    moonInfoBg.setAttribute('fill', 'rgba(15,23,42,0.8)');
                    moonInfoText.setAttribute('fill', '#fbbf24');

                    // Update box size based on text length (approx)
                    const textWidth = 80;
                    moonInfoBg.setAttribute('width', textWidth);
                    moonInfoBg.setAttribute('x', -textWidth / 2);
                    moonInfoBg.setAttribute('y', -10);

                    // Position group: Above the moon marker
                    const labelY = y - 25;
                    const safeLabelY = Math.max(20, labelY); // Don't go off top

                    moonInfoGroup.setAttribute('transform', `translate(${x}, ${safeLabelY})`);
                    moonInfoGroup.setAttribute('opacity', 1);
                } else {
                    // Show "Âú∞Âπ≥Á∑ö‰∏ã" when moon is below horizon
                    moonInfoText.textContent = 'Âú∞Âπ≥Á∑ö‰∏ã';
                    moonInfoBg.setAttribute('fill', 'rgba(30,41,59,0.9)');
                    moonInfoText.setAttribute('fill', '#94a3b8');

                    const textWidth = 70;
                    moonInfoBg.setAttribute('width', textWidth);
                    moonInfoBg.setAttribute('x', -textWidth / 2);
                    moonInfoBg.setAttribute('y', -10);

                    // Position below horizon line
                    moonInfoGroup.setAttribute('transform', `translate(${x}, 175)`);
                    moonInfoGroup.setAttribute('opacity', 0.8);
                }
            }
        }

        // Call moon data on load
        document.addEventListener('DOMContentLoaded', loadMoonData);

        // Simple markdown to HTML converter
        function simpleMarkdownToHtml(text) {
            if (!text) return '';

            let html = text
                // Escape HTML first
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                // Bold: **text** or __text__
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/__(.+?)__/g, '<strong>$1</strong>')
                // Italic: *text* or _text_
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/_(.+?)_/g, '<em>$1</em>')
                // Bullet points: - item
                .replace(/^- (.+)$/gm, '<li>$1</li>')
                // Numbered lists: 1. item
                .replace(/^\d+\. (.+)$/gm, '<li>$1</li>')
                // Line breaks
                .replace(/\n/g, '<br>');

            // Wrap consecutive <li> in <ul>
            html = html.replace(/(<li>.*?<\/li>(<br>)?)+/g, match => {
                const items = match.replace(/<br>/g, '');
                return '<ul style="margin: 8px 0; padding-left: 20px;">' + items + '</ul>';
            });

            return html;
        }

        // Calculate and display data analysis in footer
        function updateDataAnalysis() {
            const now = new Date();
            const last24h = new Date(now.getTime() - 24 * 60 * 60 * 1000);

            // 24h high/low from recentData
            if (recentData.length > 0) {
                const last24hData = recentData.filter(d => d.date >= last24h);
                if (last24hData.length > 0) {
                    const temps = last24hData.map(d => d.temperature);
                    document.getElementById('last24hHigh').textContent = Math.max(...temps).toFixed(1);
                    document.getElementById('last24hLow').textContent = Math.min(...temps).toFixed(1);
                }
            }

            // Weekly average from weeklyData
            if (weeklyData.length > 0) {
                const thisWeekStart = new Date(now);
                thisWeekStart.setDate(thisWeekStart.getDate() - thisWeekStart.getDay());
                thisWeekStart.setHours(0, 0, 0, 0);

                const lastWeekStart = new Date(thisWeekStart);
                lastWeekStart.setDate(lastWeekStart.getDate() - 7);

                const thisWeekData = weeklyData.filter(d => d.date >= thisWeekStart);
                const lastWeekData = weeklyData.filter(d => d.date >= lastWeekStart && d.date < thisWeekStart);

                if (thisWeekData.length > 0) {
                    const thisWeekAvg = thisWeekData.reduce((sum, d) => sum + d.temperature, 0) / thisWeekData.length;
                    document.getElementById('weekAvg').textContent = thisWeekAvg.toFixed(1);

                    if (lastWeekData.length > 0) {
                        const lastWeekAvg = lastWeekData.reduce((sum, d) => sum + d.temperature, 0) / lastWeekData.length;
                        const diff = thisWeekAvg - lastWeekAvg;
                        const diffEl = document.getElementById('weekDiffValue');
                        const sign = diff >= 0 ? '+' : '';
                        diffEl.textContent = `${sign}${diff.toFixed(1)}¬∞C`;
                        diffEl.parentElement.style.color = diff >= 0 ? '#fb923c' : '#60a5fa';
                    }
                }
            }
        }

        // JMA Warning Code to Name Mapping (Ê∞óË±°Â∫ÅÈò≤ÁÅΩÊÉÖÂ†±XMLÂÖ¨Âºè„Ç≥„Éº„Éâ - ÂÆåÂÖ®Áâà)
        // Âá∫ÂÖ∏: Ê∞óË±°Â∫Å„ÄåÈò≤ÁÅΩÊÉÖÂ†±XML„Éï„Ç©„Éº„Éû„ÉÉ„Éà „Ç≥„Éº„ÉâÁÆ°ÁêÜË°®„Äç
        const JMA_WARNING_NAMES = {
            // === Ê∞óË±°Ë≠¶Â†±„ÉªÊ≥®ÊÑèÂ†±„ÉªÁâπÂà•Ë≠¶Â†± ===
            // ÁâπÂà•Ë≠¶Â†± (32-38)
            '32': 'Êö¥È¢®Èõ™ÁâπÂà•Ë≠¶Â†±', '33': 'Â§ßÈõ®ÁâπÂà•Ë≠¶Â†±', '35': 'Êö¥È¢®ÁâπÂà•Ë≠¶Â†±',
            '36': 'Â§ßÈõ™ÁâπÂà•Ë≠¶Â†±', '37': 'Ê≥¢Êµ™ÁâπÂà•Ë≠¶Â†±', '38': 'È´òÊΩÆÁâπÂà•Ë≠¶Â†±',
            // Ë≠¶Â†± (02-08)
            '02': 'Êö¥È¢®Èõ™Ë≠¶Â†±', '03': 'Â§ßÈõ®Ë≠¶Â†±', '04': 'Ê¥™Ê∞¥Ë≠¶Â†±',
            '05': 'Êö¥È¢®Ë≠¶Â†±', '06': 'Â§ßÈõ™Ë≠¶Â†±', '07': 'Ê≥¢Êµ™Ë≠¶Â†±', '08': 'È´òÊΩÆË≠¶Â†±',
            // Ê≥®ÊÑèÂ†± (10-26)
            '10': 'Â§ßÈõ®Ê≥®ÊÑèÂ†±', '12': 'Â§ßÈõ™Ê≥®ÊÑèÂ†±', '13': 'È¢®Èõ™Ê≥®ÊÑèÂ†±',
            '14': 'Èõ∑Ê≥®ÊÑèÂ†±', '15': 'Âº∑È¢®Ê≥®ÊÑèÂ†±', '16': 'Ê≥¢Êµ™Ê≥®ÊÑèÂ†±',
            '17': 'ËûçÈõ™Ê≥®ÊÑèÂ†±', '18': 'Ê¥™Ê∞¥Ê≥®ÊÑèÂ†±', '19': 'È´òÊΩÆÊ≥®ÊÑèÂ†±',
            '20': 'ÊøÉÈúßÊ≥®ÊÑèÂ†±', '21': '‰πæÁá•Ê≥®ÊÑèÂ†±', '22': '„Å™„Å†„ÇåÊ≥®ÊÑèÂ†±',
            '23': '‰ΩéÊ∏©Ê≥®ÊÑèÂ†±', '24': 'ÈúúÊ≥®ÊÑèÂ†±', '25': 'ÁùÄÊ∞∑Ê≥®ÊÑèÂ†±',
            '26': 'ÁùÄÈõ™Ê≥®ÊÑèÂ†±',
            // === Ê¥•Ê≥¢Ë≠¶Â†±„ÉªÊ≥®ÊÑèÂ†± ===
            '50': 'Ê¥•Ê≥¢Ë≠¶Â†±Ëß£Èô§', '51': 'Ê¥•Ê≥¢Ë≠¶Â†±', '52': 'Â§ßÊ¥•Ê≥¢Ë≠¶Â†±', '53': 'Â§ßÊ¥•Ê≥¢Ë≠¶Â†±',
            '60': 'Ê¥•Ê≥¢Ê≥®ÊÑèÂ†±Ëß£Èô§', '62': 'Ê¥•Ê≥¢Ê≥®ÊÑèÂ†±',
            '71': 'Ê¥•Ê≥¢‰∫àÂ†±', '72': 'Ê¥•Ê≥¢‰∫àÂ†±', '73': 'Ê¥•Ê≥¢‰∫àÂ†±',
            // === Ëß£Èô§ ===
            '00': 'Ëß£Èô§'
        };

        // Fetch JMA weather alerts for Tokyo (Katsushika = 23Âå∫Êù±ÈÉ®)
        async function fetchAlerts() {
            try {
                // JMA Warning API for Tokyo (130000)
                const response = await fetch('https://www.jma.go.jp/bosai/warning/data/warning/130000.json');
                const data = await response.json();

                // Áô∫Ë°®ÊôÇÂàª„ÇíÂèñÂæó
                const reportTime = data.reportDatetime || null;

                // Find Katsushika area (code 1312200) or 23Âå∫Êù±ÈÉ® (code 130014)
                const areaWarnings = [];
                if (data.areaTypes) {
                    for (const areaType of data.areaTypes) {
                        for (const area of (areaType.areas || [])) {
                            // 23Âå∫Êù±ÈÉ® or ËëõÈ£æÂå∫
                            if (area.code === '130014' || area.code === '1312200' || area.name?.includes('Êù±ÈÉ®')) {
                                for (const warning of (area.warnings || [])) {
                                    if (warning.status === 'Áô∫Ë°®' || warning.status === 'Á∂ôÁ∂ö') {
                                        const warningCode = warning.code?.toString().padStart(2, '0') || '';
                                        const warningName = warning.name || JMA_WARNING_NAMES[warningCode] || `Ë≠¶Â†±${warningCode}`;
                                        areaWarnings.push({
                                            name: warningName,
                                            level: warning.kind?.code || 0
                                        });
                                    }
                                }
                            }
                        }
                    }
                }

                // Save to global for comment integration
                currentAlerts = areaWarnings;
                updateAlertBanner(areaWarnings, reportTime);
            } catch (e) {
                console.log('JMA Alert API unavailable (CORS):', e.message);
                // Hide alert banner on error
                document.getElementById('alertBanner').style.display = 'none';
            }
        }

        // Update the alert banner
        function updateAlertBanner(alerts, reportTime = null) {
            const banner = document.getElementById('alertBanner');
            const alertText = document.getElementById('alertText');
            const alertIcon = banner.querySelector('.alert-icon');

            if (alerts.length === 0) {
                banner.style.display = 'none';
                return;
            }

            // Categorize alerts by priority
            const specialWarnings = alerts.filter(a => a.name?.includes('ÁâπÂà•Ë≠¶Â†±'));
            const warnings = alerts.filter(a => a.name?.includes('Ë≠¶Â†±') && !a.name?.includes('ÁâπÂà•'));
            const advisories = alerts.filter(a => a.name?.includes('Ê≥®ÊÑèÂ†±'));

            // Build display text showing ALL alerts in priority order
            const alertParts = [];
            if (specialWarnings.length > 0) {
                alertParts.push(specialWarnings.map(a => a.name).join('„Éª'));
            }
            if (warnings.length > 0) {
                alertParts.push(warnings.map(a => a.name).join('„Éª'));
            }
            if (advisories.length > 0) {
                alertParts.push(advisories.map(a => a.name).join('„Éª'));
            }

            // Determine banner style by highest priority
            let className, icon;
            if (specialWarnings.length > 0) {
                className = 'alert-special';
                icon = 'üö®';
            } else if (warnings.length > 0) {
                className = 'alert-severe';
                icon = '‚ö†Ô∏è';
            } else {
                className = 'alert-warning';
                icon = 'üîî';
            }

            // Format report time
            let timeStr = '';
            if (reportTime) {
                const dt = new Date(reportTime);
                timeStr = ` (${dt.getHours()}:${dt.getMinutes().toString().padStart(2, '0')}Áô∫Ë°®)`;
            }

            alertText.textContent = `ËëõÈ£æÂå∫: ${alertParts.join(' / ')}${timeStr}`;
            alertIcon.textContent = icon;
            banner.className = `alert-banner ${className}`;
            banner.style.display = 'flex';
        }

        // Get comfort level based on temperature
        function getComfortLevel(temp) {
            if (temp >= 35) return { text: 'ü•µ ÁåõÊöë', class: 'hot' };
            if (temp >= 28) return { text: '‚òÄÔ∏è Êöë„ÅÑ', class: 'warm' };
            if (temp >= 18) return { text: 'üòä Âø´ÈÅ©', class: 'comfort' };
            if (temp >= 10) return { text: 'üçÇ Ê∂º„Åó„ÅÑ', class: 'cool' };
            return { text: 'ü•∂ ÂØí„ÅÑ', class: 'cold' };
        }

        // Update temperature-based theme
        function updateTempTheme(temp) {
            // Map temperature to hue: cold (200 blue) to hot (0 red), comfortable = 80 (yellow-green)
            let hue;
            if (temp <= 0) hue = 200;      // Blue
            else if (temp <= 10) hue = 180; // Cyan
            else if (temp <= 18) hue = 120; // Green
            else if (temp <= 25) hue = 60;  // Yellow
            else if (temp <= 30) hue = 30;  // Orange
            else hue = 0;                   // Red

            document.documentElement.style.setProperty('--temp-hue', hue);
        }

        function updateUI() {
            if (!summaryData.currentTemp) return;

            const temp = summaryData.currentTemp;

            document.getElementById('currentTemp').textContent = temp.toFixed(1);
            document.getElementById('currentHumidity').textContent = Math.round(summaryData.currentHumidity);
            document.getElementById('todayHigh').textContent = summaryData.todayHigh.toFixed(1);
            document.getElementById('todayLow').textContent = summaryData.todayLow.toFixed(1);
            document.getElementById('yearHigh').textContent = summaryData.yearHigh.toFixed(1);
            document.getElementById('yearLow').textContent = summaryData.yearLow.toFixed(1);
            if (summaryData.dataCount) document.getElementById('dataCount').textContent = summaryData.dataCount.toLocaleString() + ' ‰ª∂';

            // Update feels-like temperature (always use custom calculation with 3-zone physics model)
            const feelsLikeEl = document.getElementById('feelsLike');
            // Wind speed from Open-Meteo (10m height), will be adjusted to 0.6x inside calculateFeelsLike
            const fl = calculateFeelsLike(temp, summaryData.currentHumidity, weatherData?.windSpeed || 0);
            feelsLikeEl.textContent = fl.toFixed(1);

            // Color feels-like based on value
            const flParent = feelsLikeEl.closest('.stat-value');
            if (fl >= 35) { flParent.style.color = '#f87171'; flParent.style.textShadow = '0 0 20px rgba(248,113,113,0.4)'; }
            else if (fl >= 28) { flParent.style.color = '#fb923c'; flParent.style.textShadow = '0 0 20px rgba(251,146,60,0.3)'; }
            else if (fl >= 18) { flParent.style.color = '#4ade80'; flParent.style.textShadow = '0 0 20px rgba(74,222,128,0.3)'; }
            else if (fl >= 10) { flParent.style.color = '#38bdf8'; flParent.style.textShadow = '0 0 20px rgba(56,189,248,0.3)'; }
            else { flParent.style.color = '#22d3ee'; flParent.style.textShadow = '0 0 20px rgba(34,211,238,0.4)'; }

            // Update UV index
            const uvIndexEl = document.getElementById('uvIndex');
            const uvBadge = document.getElementById('uvBadge');
            const uvCard = uvIndexEl.closest('.stat-card');
            const hour = new Date().getHours();

            if (weatherData?.uvIndex != null && (hour >= 6 && hour <= 19)) {
                const uv = weatherData.uvIndex;
                uvIndexEl.textContent = uv.toFixed(1);
                const uvLevel = getUvLevel(uv);
                uvBadge.textContent = uvLevel.text;
                uvBadge.className = `uv-badge ${uvLevel.class}`;

                // Color UV value based on level
                const uvParent = uvIndexEl.closest('.stat-value');
                if (uv >= 11) { uvParent.style.color = '#a855f7'; uvParent.style.textShadow = '0 0 20px rgba(168,85,247,0.4)'; }
                else if (uv >= 8) { uvParent.style.color = '#f87171'; uvParent.style.textShadow = '0 0 20px rgba(248,113,113,0.4)'; }
                else if (uv >= 6) { uvParent.style.color = '#fb923c'; uvParent.style.textShadow = '0 0 20px rgba(251,146,60,0.3)'; }
                else if (uv >= 3) { uvParent.style.color = '#facc15'; uvParent.style.textShadow = '0 0 20px rgba(250,204,21,0.3)'; }
                else { uvParent.style.color = '#4ade80'; uvParent.style.textShadow = '0 0 20px rgba(74,222,128,0.3)'; }

                uvCard.style.opacity = '1';
            } else {
                // Night time - dim the UV card
                uvIndexEl.textContent = '--';
                uvBadge.textContent = 'Â§úÈñì';
                uvBadge.className = 'uv-badge uv-low';
                const uvParent = uvIndexEl.closest('.stat-value');
                uvParent.style.color = '#64748b';
                uvParent.style.textShadow = 'none';
                uvCard.style.opacity = '0.6';
            }

            // Update comfort badge
            const comfort = getComfortLevel(temp);
            const badge = document.getElementById('comfortBadge');
            badge.textContent = comfort.text;
            badge.className = `comfort-badge show ${comfort.class}`;

            // Update temperature theme
            updateTempTheme(temp);

            // Update greeting
            updateGreeting(temp, summaryData.currentHumidity);

            // Update weather visual effects
            updateWeatherEffects(weatherData?.weatherCode || 0, new Date().getHours());
        }

        // Switch background effects based on weather code and time
        function updateWeatherEffects(code, hour) {
            // Reset all effects
            document.querySelectorAll('.weather-effects > div').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.weather-effects > div').forEach(el => el.style.opacity = '0');

            const isDay = hour >= 6 && hour < 18;
            let activeEffectId = null;

            // Simple mapping
            // Rain: 51-67, 80-82, 95-99
            if ((code >= 51 && code <= 67) || (code >= 80 && code <= 82) || code >= 95) {
                activeEffectId = 'effectRain';
            }
            // Snow: 71-77, 85-86
            else if ((code >= 71 && code <= 77) || code === 85 || code === 86) {
                activeEffectId = 'effectSnow';
            }
            // Cloudy/Fog: 45, 48
            else if (code === 45 || code === 48) {
                activeEffectId = 'effectClouds';
            }
            // Sunny/Clear: 0, 1 -> Sun (day) or Stars (night)
            else if (code === 0 || code === 1) {
                activeEffectId = isDay ? 'effectSun' : 'effectStars';
            }
            // Partly cloudy: 2, 3 -> Clouds
            else if (code === 2 || code === 3) {
                activeEffectId = 'effectClouds';
            }

            if (activeEffectId) {
                const el = document.getElementById(activeEffectId);
                if (el) {
                    el.classList.add('active');
                    el.style.opacity = '1';
                }
            }
        }

        // Calculate feels-like temperature (improved physical model + low wind correction)
        // Wind speed adjustment: API provides 10m height, adjust to 2m (~0.6x)
        // Uses Tetens formula for vapor pressure, Steadman for intermediate range
        // Low wind correction: when wind < 1.3 m/s, blend result with raw temp
        function calculateFeelsLike(temp, humidity, windSpeed) {
            // Adjust wind speed from 10m to 2m height
            const v = Math.max(0, (windSpeed || 0) * 0.6);

            // Minimum wind threshold - below this, wind effect is linearly reduced
            const MIN_WIND_THRESHOLD = 1.3;

            // Calculate vapor pressure using Tetens formula (hPa)
            const e = 6.11 * Math.pow(10, (7.5 * temp) / (temp + 237.3)) * (humidity / 100);

            // Wind Chill (Linke formula for cold conditions)
            const windChill = (temp, v) => {
                if (v <= 0) return temp;
                return 13.12 + 0.6215 * temp - 11.37 * Math.pow(v * 3.6, 0.16) + 0.3965 * temp * Math.pow(v * 3.6, 0.16);
            };

            // Steadman's Apparent Temperature (for intermediate range)
            const steadman = (temp, e, v) => {
                return temp + 0.33 * e - 0.70 * v - 4.0;
            };

            // Heat Index (for hot conditions)
            const heatIndex = (temp, humidity) => {
                const c1 = -8.78469475556;
                const c2 = 1.61139411;
                const c3 = 2.33854883889;
                const c4 = -0.14611605;
                const c5 = -0.012308094;
                const c6 = -0.0164248277778;
                const c7 = 0.002211732;
                const c8 = 0.00072546;
                const c9 = -0.000003582;
                return c1 + c2 * temp + c3 * humidity + c4 * temp * humidity
                    + c5 * temp * temp + c6 * humidity * humidity
                    + c7 * temp * temp * humidity + c8 * temp * humidity * humidity
                    + c9 * temp * temp * humidity * humidity;
            };

            // Linear interpolation helper
            const lerp = (a, b, t) => a + (b - a) * Math.max(0, Math.min(1, t));

            // Calculate raw result based on temperature range
            let rawResult;
            if (temp <= 8) {
                // Pure wind chill zone
                rawResult = windChill(temp, v);
            } else if (temp <= 12) {
                // Transition: wind chill ‚Üí Steadman
                const wc = windChill(temp, v);
                const st = steadman(temp, e, v);
                const t = (temp - 8) / 4; // 0 at 8¬∞C, 1 at 12¬∞C
                rawResult = lerp(wc, st, t);
            } else if (temp <= 25) {
                // Pure Steadman zone
                rawResult = steadman(temp, e, v);
            } else if (temp <= 29) {
                // Transition: Steadman ‚Üí Heat Index
                const st = steadman(temp, e, v);
                const hi = heatIndex(temp, humidity);
                const t = (temp - 25) / 4; // 0 at 25¬∞C, 1 at 29¬∞C
                rawResult = lerp(st, hi, t);
            } else {
                // Pure heat index zone
                rawResult = heatIndex(temp, humidity);
            }

            // Low wind correction: below MIN_WIND_THRESHOLD, blend with raw temperature
            if (v < MIN_WIND_THRESHOLD) {
                const windFactor = v / MIN_WIND_THRESHOLD; // 0 to 1 range
                return lerp(temp, rawResult, windFactor);
            }

            return rawResult;
        }
        // Get UV level description
        function getUvLevel(uv) {
            if (uv >= 11) return { text: 'Ê•µÁ´Ø', class: 'uv-extreme' };
            if (uv >= 8) return { text: 'ÈùûÂ∏∏„Å´Âº∑„ÅÑ', class: 'uv-very-high' };
            if (uv >= 6) return { text: 'Âº∑„ÅÑ', class: 'uv-high' };
            if (uv >= 3) return { text: '‰∏≠Á®ãÂ∫¶', class: 'uv-moderate' };
            return { text: 'Âº±„ÅÑ', class: 'uv-low' };
        }

        // Generate time-based greeting and weather comment
        function updateGreeting(temp, humidity) {
            const now = new Date();
            const hour = now.getHours();
            const month = now.getMonth() + 1;
            let greeting, emoji;

            // Time-based greeting
            if (hour >= 4 && hour < 6) { greeting = 'Êó©Ëµ∑„Åç„Åß„Åô„Å≠'; }
            else if (hour >= 6 && hour < 10) { greeting = '„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô'; }
            else if (hour >= 10 && hour < 12) { greeting = 'ËâØ„ÅÑÂçàÂâç„Çí'; }
            else if (hour >= 12 && hour < 17) { greeting = '„Åì„Çì„Å´„Å°„ÅØ'; }
            else if (hour >= 17 && hour < 21) { greeting = '„Åì„Çì„Å∞„Çì„ÅØ'; }
            else { greeting = '„ÅäÂ§úÊõ¥„Åã„Åó„Åß„Åô„ÅãÔºü'; }

            // Weather-based emoji (combines weather + time of day)
            const wcEmoji = weatherData?.weatherCode ?? 0;
            // Use sunrise/sunset for daytime detection
            let isDaytime = hour >= 6 && hour < 18; // fallback
            if (weatherData?.sunrise && weatherData?.sunset) {
                const sunriseTime = new Date(weatherData.sunrise);
                const sunsetTime = new Date(weatherData.sunset);
                isDaytime = (now >= sunriseTime && now < sunsetTime);
            }
            const isNighttime = !isDaytime;

            // Weather code to emoji mapping (Complete Open-Meteo WMO codes)
            const getWeatherEmoji = (code, isDay) => {
                // Thunderstorm with heavy hail (99)
                if (code === 99) return '‚õàÔ∏è';
                // Thunderstorm with slight/moderate hail (96)
                if (code === 96) return '‚õàÔ∏è';
                // Thunderstorm slight/moderate (95)
                if (code === 95) return 'üå©Ô∏è';
                // Snow showers heavy (86)
                if (code === 86) return 'üå®Ô∏è';
                // Snow showers slight (85)
                if (code === 85) return 'üå®Ô∏è';
                // Rain showers violent (82)
                if (code === 82) return 'üåßÔ∏è';
                // Rain showers moderate (81)
                if (code === 81) return 'üå¶Ô∏è';
                // Rain showers slight (80)
                if (code === 80) return 'üå¶Ô∏è';
                // Snow grains (77)
                if (code === 77) return 'üå®Ô∏è';
                // Heavy snow fall (75)
                if (code === 75) return '‚ùÑÔ∏è';
                // Moderate snow fall (73)
                if (code === 73) return 'üå®Ô∏è';
                // Slight snow fall (71)
                if (code === 71) return 'üå®Ô∏è';
                // Freezing rain heavy (67)
                if (code === 67) return 'üåßÔ∏è';
                // Freezing rain light (66)
                if (code === 66) return 'üåßÔ∏è';
                // Freezing drizzle heavy (57)
                if (code === 57) return 'üåßÔ∏è';
                // Freezing drizzle light (56)
                if (code === 56) return 'üåßÔ∏è';
                // Rain heavy (65)
                if (code === 65) return 'üåßÔ∏è';
                // Rain moderate (63)
                if (code === 63) return 'üåßÔ∏è';
                // Rain slight (61)
                if (code === 61) return 'üå¶Ô∏è';
                // Drizzle dense (55)
                if (code === 55) return 'üå¶Ô∏è';
                // Drizzle moderate (53)
                if (code === 53) return 'üå¶Ô∏è';
                // Drizzle light (51)
                if (code === 51) return 'üå¶Ô∏è';
                // Depositing rime fog (48)
                if (code === 48) return 'üå´Ô∏è';
                // Fog (45)
                if (code === 45) return 'üå´Ô∏è';
                // Overcast (3)
                if (code === 3) return '‚òÅÔ∏è';
                // Mainly cloudy (2)
                if (code === 2) return isDay ? '‚õÖ' : '‚òÅÔ∏è';
                // Partly cloudy (1)
                if (code === 1) return isDay ? 'üå§Ô∏è' : 'üåô';
                // Clear sky (0)
                if (code === 0) {
                    if (hour >= 4 && hour < 6) return 'üåÖ';  // Dawn
                    if (hour >= 6 && hour < 8) return 'üåÖ';  // Sunrise
                    if (hour >= 16 && hour < 18) return 'üåá'; // Sunset
                    if (hour >= 18 && hour < 20) return 'üåÜ'; // Dusk
                    if (isDay) return '‚òÄÔ∏è';                  // Day
                    return 'üåô';                              // Night
                }
                return isDay ? 'üå§Ô∏è' : 'üåô'; // Default
            };

            emoji = getWeatherEmoji(wcEmoji, isDaytime);

            const t = `<span class="temp-highlight">${temp.toFixed(1)}¬∞C</span>`;
            const h = Math.round(humidity);

            // Weather API data (wind speed adjusted to 2m height: 0.6x factor)
            const wc = weatherData?.weatherCode ?? -1;
            const cloudCover = weatherData?.cloudCover ?? null;
            const pp = weatherData?.precipProb ?? 0;
            const wsRaw = weatherData?.windSpeed ?? 0;  // 10m height from API
            const ws = wsRaw * 0.6;  // Adjusted to 2m height (0.6x factor)
            const uv = weatherData?.uvIndex ?? 0;
            // Always use custom feels-like calculation (3-zone physics model)
            const fl = calculateFeelsLike(temp, humidity, wsRaw);

            // Weather state detection (detailed)
            const isThunderstorm = wc >= 95;
            const isHeavySnow = wc >= 75 && wc < 80;
            const isSnow = wc >= 71 && wc < 75;
            const isSleet = wc >= 80 && wc < 82;
            const isHeavyRain = wc >= 82 && wc < 95;
            const isModerateRain = wc >= 63 && wc < 67;
            const isRain = wc >= 61 && wc < 63;
            const isDrizzle = wc >= 51 && wc < 61;
            const isFog = wc >= 45 && wc < 51;
            const isOvercast = wc >= 3 && wc < 45;
            const isPartlyCloudy = wc === 2;
            const isClear = wc >= 0 && wc <= 1;
            const isRainingOpenMeteo = isThunderstorm || isHeavyRain || isModerateRain || isRain || isDrizzle;
            // Yahoo API„ÅÆÂÆüÊ∏¨„Éá„Éº„Çø„ÇíÂÑ™ÂÖà„ÄÅ„Å™„Åë„Çå„Å∞Open-Meteo„Çí‰ΩøÁî®
            const isRaining = actualPrecipState?.isRaining ?? isRainingOpenMeteo;

            // Yahoo APIÈôçÊ∞¥„Çø„Ç§„Éó„ÅßisSnow/isSleet„ÇíÂà§ÂÆöÔºàÂÆüÈöõ„Å´ÈôçÊ∞¥„Åå„ÅÇ„ÇãÂ†¥Âêà„ÅÆ„ÅøÔºâ
            // actualPrecipState.isRaining „Åå true „ÅÆÂ†¥Âêà„ÅÆ„Åø precipType „ÇíËÄÉÊÖÆ
            const isActuallyPrecipitating = actualPrecipState?.isRaining === true;
            const isSnowYahoo = isActuallyPrecipitating && actualPrecipState?.precipType === 'snow';
            const isSleetYahoo = isActuallyPrecipitating && actualPrecipState?.precipType === 'sleet';
            const isSnowActual = isSnowYahoo || isHeavySnow || isSnow;
            const isSleetActual = isSleetYahoo || isSleet;

            // Wind levels (more detailed)
            const isCalm = ws < 3;
            const isLightBreeze = ws >= 3 && ws < 8;
            const isWindy = ws >= 8 && ws < 15;
            const isVeryWindy = ws >= 15 && ws < 25;
            const isStormWind = ws >= 25;
            const willRain = pp >= 50 && !isRaining;

            // Humidity levels (more detailed)
            const isExtremelyDry = humidity < 20;
            const isVeryDry = humidity >= 20 && humidity < 30;
            const isDry = humidity >= 30 && humidity < 45;
            const isComfortableHumid = humidity >= 45 && humidity < 60;
            const isHumid = humidity >= 60 && humidity < 75;
            const isVeryHumid = humidity >= 75 && humidity < 85;
            const isExtremelyHumid = humidity >= 85;

            // UV levels
            const isHighUV = uv >= 6;
            const isVeryHighUV = uv >= 8;
            const isExtremeUV = uv >= 11;

            // Visibility levels
            const visibility = weatherData?.visibility ?? null;  // „É°„Éº„Éà„É´
            const isExcellentVisibility = visibility !== null && visibility >= 50000;  // 50km+: ÂØåÂ£´Â±±„ÅåË¶ã„Åà„Çã
            const isGoodVisibility = visibility !== null && visibility >= 20000 && visibility < 50000;
            const isPoorVisibility = visibility !== null && visibility < 4000;  // Èúß„ÇÑ„Çπ„É¢„ÉÉ„Ç∞
            const isVeryPoorVisibility = visibility !== null && visibility < 1000;  // ÊøÉÈúß

            // Wind direction (degrees to cardinal)
            const windDir = weatherData?.windDirection ?? null;
            const isNorthWind = windDir !== null && (windDir >= 337.5 || windDir < 22.5);  // ÂåóÈ¢®
            const isSouthWind = windDir !== null && windDir >= 157.5 && windDir < 202.5;  // ÂçóÈ¢®
            const isWestWind = windDir !== null && windDir >= 247.5 && windDir < 292.5;  // Ë•øÈ¢®
            const isEastWind = windDir !== null && windDir >= 67.5 && windDir < 112.5;  // Êù±È¢®

            // Wind gusts (Áû¨ÈñìÊúÄÂ§ßÈ¢®ÈÄü)
            const windGusts = weatherData?.windGusts ?? null;
            const hasStrongGusts = windGusts !== null && windGusts >= 10;  // ÂÇò„ÅåÈ£õ„Å∞„Åï„Çå„ÇÑ„Åô„ÅÑ
            const hasDangerousGusts = windGusts !== null && windGusts >= 20;  // Ê≠©Ë°åÂõ∞Èõ£

            // Atmospheric pressure
            const pressure = weatherData?.pressureMsl ?? null;
            const isLowPressure = pressure !== null && pressure < 1005;  // ‰ΩéÊ∞óÂúßÊé•Ëøë
            const isHighPressure = pressure !== null && pressure >= 1020;  // È´òÊ∞óÂúßÂúèÂÜÖ

            // CAPE (Convective Available Potential Energy) - thunderstorm potential
            const cape = weatherData?.cape ?? null;
            const isUnstableAtmosphere = cape !== null && cape >= 500;  // Â§ßÊ∞ó‰∏çÂÆâÂÆö
            const isVeryUnstable = cape !== null && cape >= 1000;  // Èõ∑Èõ®„É™„Çπ„ÇØÈ´ò

            // Time period (uses sunrise/sunset when available)
            let sunriseHour = 6, sunsetHour = 18; // fallback
            if (weatherData?.sunrise && weatherData?.sunset) {
                sunriseHour = new Date(weatherData.sunrise).getHours();
                sunsetHour = new Date(weatherData.sunset).getHours();
            }
            const isMorning = hour >= sunriseHour && hour < 12;
            const isAfternoon = hour >= 12 && hour < sunsetHour;
            const isEvening = hour >= sunsetHour && hour < sunsetHour + 4;
            const isNight = hour >= sunsetHour + 4 || hour < sunriseHour;

            // Season detection
            const isSummer = month >= 6 && month <= 8;
            const isWinter = month === 12 || month <= 2;
            const isRainy = month === 6 || month === 7;
            const isSpring = month >= 3 && month <= 5;
            const isAutumn = month >= 9 && month <= 11;

            // Feels-like difference
            const feelsHotter = fl > temp + 2;
            const feelsColder = fl < temp - 2;

            // Day of week
            const dayOfWeek = now.getDay();
            const isWeekend = dayOfWeek === 0 || dayOfWeek === 6;
            const isMonday = dayOfWeek === 1;
            const isFriday = dayOfWeek === 5;

            // WBGT (Wet Bulb Globe Temperature) - Heat stress index
            const wbgt = 0.735 * temp + 0.0374 * humidity + 0.00292 * temp * humidity - 4.064;
            const isDangerWBGT = wbgt >= 31;
            const isHighWBGT = wbgt >= 28 && wbgt < 31;
            const isModerateWBGT = wbgt >= 25 && wbgt < 28;

            // Seasonal events (stricter date ranges)
            const dayOfMonth = now.getDate();
            const isNewYear = month === 1 && dayOfMonth <= 3;  // 1/1„Äú3Êó•„ÅÆ„Åø
            const isCherryBlossom = month >= 3 && month <= 4 && temp >= 12 && temp <= 22;  // Ê∞óÊ∏©Êù°‰ª∂„ÅÆ„Åø
            const isGoldenWeek = month === 5 && dayOfMonth >= 3 && dayOfMonth <= 6;  // GWÊúüÈñì
            const isFireworkSeason = (month === 7 || month === 8) && isEvening && (isWeekend || Math.random() < 0.3);  // ÈÄ±Êú´Â§ïÊñπ„ÄÅ„Åæ„Åü„ÅØÂπ≥Êó•30%
            const isAutumnLeaves = month >= 10 && month <= 11 && temp >= 8 && temp <= 18;
            // Christmas: 24Êó•=„Ç§„Éñ, 25Êó•=ÂΩìÊó•„ÅÆ„Åø„ÄÇ23Êó•„ÅØÂâçÊó•Êâ±„ÅÑ
            const isChristmasEve = month === 12 && dayOfMonth === 24;
            const isChristmasDay = month === 12 && dayOfMonth === 25;
            const isChristmasEveEve = month === 12 && dayOfMonth === 23;  // ÂâçÊó•
            const isYearEnd = month === 12 && dayOfMonth >= 28;  // 28Êó•‰ª•Èôç

            // Health conditions
            const isPollenSeason = (month >= 2 && month <= 5) && !isRaining && isClear;
            const isDrySkinRisk = isExtremelyDry || isVeryDry;
            const isHeatstrokeRisk = temp >= 28 && (humidity >= 60 || wbgt >= 25);
            const isColdRisk = (isWinter || temp < 10) && (isDrySkinRisk || isVeryWindy);
            const isDehydrationRisk = temp >= 25 || (temp >= 20 && humidity < 40);

            // Clothing suggestions based on temp
            const clothingSuggestion = temp >= 28 ? 'ÂçäË¢ñ1Êûö' :
                temp >= 22 ? 'ËñÑÊâã„ÅÆ„Ç∑„É£„ÉÑ' :
                    temp >= 18 ? 'Èï∑Ë¢ñ„Ç∑„É£„ÉÑ' :
                        temp >= 14 ? 'ËñÑÊâã„ÅÆ„Ç´„Éº„Éá„Ç£„Ç¨„É≥' :
                            temp >= 10 ? 'ÂéöÊâã„ÅÆ„Ç´„Éº„Éá„Ç£„Ç¨„É≥' :
                                temp >= 5 ? '„Çª„Éº„Çø„ÉºÔºã„Ç≥„Éº„Éà' :
                                    '„ÉÄ„Ç¶„É≥Ôºã„Éû„Éï„É©„Éº';

            // Random selector helper
            const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];

            // ============================================================
            // CONDITION CHANGE DETECTION
            // ============================================================
            // Generate condition key based on significant factors
            const getTempBand = (t) => {
                if (t >= 40) return 'extreme-hot';
                if (t >= 35) return 'very-hot';
                if (t >= 32) return 'hot';
                if (t >= 28) return 'warm-hot';
                if (t >= 25) return 'warm';
                if (t >= 22) return 'comfortable-warm';
                if (t >= 18) return 'comfortable';
                if (t >= 14) return 'cool';
                if (t >= 10) return 'chilly';
                if (t >= 5) return 'cold';
                if (t >= 0) return 'very-cold';
                if (t >= -5) return 'freezing';
                return 'extreme-cold';
            };

            const getTimePeriod = (h) => {
                if (h >= 6 && h < 12) return 'morning';
                if (h >= 12 && h < 18) return 'afternoon';
                if (h >= 18 && h < 22) return 'evening';
                return 'night';
            };

            const alertKey = currentAlerts.map(a => a.name).sort().join(',');
            const conditionKey = `${getTempBand(temp)}|${wc}|${getTimePeriod(hour)}|${alertKey}`;

            // Check if conditions changed
            const conditionsChanged = conditionKey !== lastConditionKey;

            // If conditions haven't changed and we have a previous comment, reuse it with updated temperature
            if (!conditionsChanged && lastComment) {
                document.getElementById('greetingSection')?.classList.add('show');
                // These elements may not exist in current UI - use optional chaining
                const emojiEl = document.querySelector('.greeting-text .emoji');
                if (emojiEl) emojiEl.textContent = emoji;
                const greetingMainEl = document.getElementById('greetingMain');
                if (greetingMainEl) greetingMainEl.textContent = greeting;
                // Update temperature in previous comment to current value
                const updatedComment = lastComment.replace(
                    /<span class="temp-highlight">[0-9.-]+¬∞C<\/span>/g,
                    `<span class="temp-highlight">${temp.toFixed(1)}¬∞C</span>`
                );
                const weatherCommentEl = document.getElementById('weatherComment');
                if (weatherCommentEl) weatherCommentEl.innerHTML = updatedComment;
                return;
            }

            let comment = '';


            // ============================================================
            // PRIORITY 1: Hazardous weather (thunderstorm) - Expanded
            // ============================================================
            if (isThunderstorm) {
                if (temp >= 30 && isExtremelyHumid) {
                    comment = pick([
                        `‚õàÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÁåõÊöë„ÅÆ‰∏≠„ÅÆÈõ∑Èõ®ÔºÅËí∏„ÅóÈ¢®ÂëÇÁä∂ÊÖã„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅÆÂäπ„ÅÑ„ÅüÂÆ§ÂÜÖ„Å∏`,
                        `‚õàÔ∏è ${t} ‚Äî Ëí∏„ÅóÊöë„ÅÑ‰∏≠„ÄÅÊøÄ„Åó„ÅÑÈõ∑Èõ®ÔºÅ‰ΩìË™øÁÆ°ÁêÜ„Å´Ê≥®ÊÑè`,
                        `‚õàÔ∏è ${t} ‚Äî ÁúüÂ§èÊó•„ÅÆÈõ∑Èõ®„ÄÇËêΩÈõ∑„Å®ÁÜ±‰∏≠Áóá„Å´Ë≠¶Êàí`
                    ]);
                } else if (temp >= 28 && isSummer) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Â§è„ÅÆÂ§ïÁ´ã„Åß„Åô„Å≠„ÄÇÊøÄ„Åó„ÅÑÈõ∑Èõ®„ÄÇËêΩÈõ∑„Å´Ê≥®ÊÑè„Åó„Å¶Â±ãÂÜÖ„Å∏`,
                        `‚õàÔ∏è ${t} ‚Äî ÁúüÂ§è„ÅÆÈõ∑Èõ®„ÄÇÊÄ•„Å™Â§ßÈõ®„Å´„ÅîÊ≥®ÊÑè„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî Â§è„Å´„Çà„Åè„ÅÇ„ÇãÊÄ•„Å™Èõ∑Èõ®„ÄÇÂÇò„Çí„Åï„Åó„Å¶„ÇÇÂç±Èô∫`,
                        `‚õàÔ∏è ${t} ‚Äî Â§è„ÅÆÈõ∑„ÄÇ„Ç≤„É™„É©Ë±™Èõ®„Åß„Åô„ÄÇÂ±ãÂÜÖ„Å∏ÈÅøÈõ£„Çí`
                    ]);
                } else if (temp >= 25) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑Èõ®Áô∫Áîü‰∏≠ÔºÅËí∏„ÅóÊöë„Åï„ÅÆ‰∏≠„ÄÅÊøÄ„Åó„ÅÑÈõ®„ÄÇÂ±ãÂÜÖ„Å´ÈÅøÈõ£„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑È≥¥„ÅåËÅû„Åì„Åà„Åæ„Åô„ÄÇÂª∫Áâ©„ÅÆ‰∏≠„ÅåÂÆâÂÖ®`,
                        `‚õàÔ∏è ${t} ‚Äî ËêΩÈõ∑„Å´Ê≥®ÊÑèÔºÅÂ§ß„Åç„Å™Êú®„ÅÆ‰∏ã„ÅØÂç±Èô∫„Åß„Åô`,
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑Èõ≤„ÅåÁô∫ÈÅî‰∏≠„ÄÇ„Åó„Å∞„Çâ„ÅèÂ±ãÂÜÖ„ÅßÂæÖÊ©ü„Çí`
                    ]);
                } else if (temp >= 15 && isSpring) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Êò•Èõ∑„Åß„Åô„ÄÇÊÄ•„Å™Èõ®„Å®Èõ∑„ÄÇÂÇò„Åå„ÅÇ„Å£„Å¶„ÇÇÂ±ãÂÜÖ„ÅåÂÆâÂÖ®`,
                        `‚õàÔ∏è ${t} ‚Äî Êò•„ÅÆÂµê„ÄÇÊøÄ„Åó„ÅÑÈõ∑Èõ®„Å´„ÅîÊ≥®ÊÑè„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî Êò•Èõ∑„Å®„Å´„Çè„ÅãÈõ®„ÄÇÂ§©Ê∞ó„ÅÆÊÄ•Â§â„Å´Ê≥®ÊÑè`
                    ]);
                } else if (temp >= 10) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈõ∑Èõ®„ÄÇÊø°„Çå„Çã„Å®‰Ωì„ÅåÂÜ∑„Åà„Åæ„Åô„ÄÇÂª∫Áâ©ÂÜÖ„Å∏`,
                        `‚õàÔ∏è ${t} ‚Äî ÂØí„ÅÑ‰∏≠„ÅÆÈõ∑Èõ®„ÄÇ‰Ωé‰ΩìÊ∏©Áóá„Å´Ê≥®ÊÑè`,
                        `‚õàÔ∏è ${t} ‚Äî ÂÜ∑„Åà„Åæ„Åô„ÄÇÊöñ„Åã„ÅÑÂ†¥ÊâÄ„ÅßÈõ∑„ÅåÂèé„Åæ„Çã„ÅÆ„ÇíÂæÖ„Å£„Å¶`
                    ]);
                } else if (isNight) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Â§úÈñì„ÅÆÈõ∑Èõ®„ÄÇÁ™ì„Åã„ÇâÈõ¢„Çå„Å¶ÂÆâÂÖ®„Å´ÈÅé„Åî„Åó„Å¶`,
                        `‚õàÔ∏è ${t} ‚Äî ÁúüÂ§ú‰∏≠„ÅÆÈõ∑„ÄÇPC„Å™„Å©„ÅÆÈõªÊ∫ê„Å´Ê≥®ÊÑè`,
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑È≥¥„ÅßËµ∑„Åç„Åæ„Åó„Åü„ÅãÔºüÂÆâÂÖ®„Å™Â†¥ÊâÄ„Åß„ÅäÈÅé„Åî„Åó„Çí`
                    ]);
                } else if (isVeryWindy || isStormWind) {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑Èõ®„Å®Âº∑È¢®ÔºÅÈ£õÊù•Áâ©„Å´Ê≥®ÊÑè„ÄÇÁ™ì„Åã„ÇâÈõ¢„Çå„Å¶`,
                        `‚õàÔ∏è ${t} ‚Äî Êö¥È¢®Èõ®„ÄÇÂ§ñÂá∫„ÅØÂç±Èô∫„ÄÇÂª∫Áâ©„ÅÆÂ••„Å∏ÈÅøÈõ£„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî ÊøÄ„Åó„ÅÑÈõ∑„Å®È¢®„ÄÇÂÅúÈõª„Å´ÂÇô„Åà„Å¶Êáê‰∏≠ÈõªÁÅØ„Çí`
                    ]);
                } else {
                    comment = pick([
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑Èõ®„Åß„Åô„ÄÇËêΩÈõ∑„ÅÆÂç±Èô∫„ÅÇ„Çä„ÄÇÂÆâÂÖ®„Å™Â†¥ÊâÄ„Åß„ÅäÈÅé„Åî„Åó„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑„ÅåÈ≥¥„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂ±ãÂ§ñÊ¥ªÂãï„ÅØ‰∏≠Ê≠¢„Çí`,
                        `‚õàÔ∏è ${t} ‚Äî Èõ∑Èõ®Áô∫Áîü‰∏≠„ÄÇÈáëÂ±û„Åã„ÇâÈõ¢„Çå„Å¶ÂÆâÂÖ®„Å´`,
                        `‚õàÔ∏è ${t} ‚Äî ‰∏çÂÆâÂÆö„Å™Â§©Ê∞ó„ÄÇ„Åó„Å∞„Çâ„ÅèÂ±ãÂÜÖ„ÅßÂæÖÊ©ü„Çí`
                    ]);
                }
                if (isStormWind) comment += ' üåÄ Êö¥È¢®Ê≥®ÊÑèÔºÅ';
            }
            // ============================================================
            // PRIORITY 2: Heavy Snow - Expanded
            // ============================================================
            else if (isHeavySnow) {
                if (temp <= -10) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî ÁåõÂêπÈõ™ÔºÅÊ•µÂØí„Åß„Åô„ÄÇÂ§ñÂá∫„ÅØÂëΩ„Å´Èñ¢„Çè„Çä„Åæ„Åô`,
                        `‚ùÑÔ∏è ${t} ‚Äî Ë®òÈå≤ÁöÑÂ§ßÈõ™„Å®Ê•µÂØí„ÄÇ‰∏çË¶Å‰∏çÊÄ•„ÅÆÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`,
                        `‚ùÑÔ∏è ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂØí„Åï„ÅÆÁåõÂêπÈõ™„ÄÇÁµ∂ÂØæ„Å´Â§ñ„Å´Âá∫„Å™„ÅÑ„Åß`
                    ]);
                } else if (temp <= -5 && isStormWind) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî ÁåõÂêπÈõ™„Åß„Åô„ÄÇË¶ñÁïå„Çº„É≠„ÄÇÁµ∂ÂØæ„Å´Â§ñÂá∫„Åó„Å™„ÅÑ„Åß`,
                        `‚ùÑÔ∏è ${t} ‚Äî „Éõ„ÉØ„Ç§„Éà„Ç¢„Ç¶„ÉàÁä∂ÊÖã„ÄÇËªä„ÅÆÈÅãËª¢„ÅØÂç±Èô∫`,
                        `‚ùÑÔ∏è ${t} ‚Äî ÁåõÁÉà„Å™ÂêπÈõ™„ÄÇÂÅúÈõª„Å´ÂÇô„Åà„Å¶ÊöñÊàø„ÅÆ‰ª£Êõø„Çí`
                    ]);
                } else if (temp <= -5) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Âé≥„Åó„ÅÑÂØí„Åï„ÅÆ‰∏≠„ÄÅÂ§ßÈõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∑ØÈù¢ÂÆåÂÖ®ÂáçÁµê`,
                        `‚ùÑÔ∏è ${t} ‚Äî Ê•µÂØí„ÅÆÂ§ßÈõ™„ÄÇÂáçÂÇ∑„Å´Ê≥®ÊÑè„ÄÇËÇå„ÇíÈú≤Âá∫„Åó„Å™„ÅÑ„Åß`,
                        `‚ùÑÔ∏è ${t} ‚Äî Ë®òÈå≤ÁöÑ„Å™ÂØí„Åï„Å®Â§ßÈõ™„ÄÇ‰∫§ÈÄöÊ©üÈñ¢„ÅØÈ∫ªÁó∫Áä∂ÊÖã`
                    ]);
                } else if (temp <= 0 && isVeryWindy) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî ÂêπÈõ™„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇË¶ñÁïå‰∏çËâØ„Å®ÂáçÁµê„Å´Âé≥ÈáçÊ≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî È¢®„Çí‰º¥„ÅÜÂ§ßÈõ™„ÄÇ‰ΩìÊÑüÊ∏©Â∫¶„ÅØ„ÇÇ„Å£„Å®‰Ωé„ÅÑ`,
                        `‚ùÑÔ∏è ${t} ‚Äî ÂêπÈõ™„ÅßÂâç„ÅåË¶ã„Åà„Åæ„Åõ„Çì„ÄÇÂ§ñÂá∫„ÅØÂç±Èô∫`
                    ]);
                } else if (temp <= 0 && isNight) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Â§úÈñì„ÅÆÂ§ßÈõ™„ÄÇÊúù„Åæ„Åß„Å´„Åã„Å™„ÇäÁ©ç„ÇÇ„Çä„Åù„ÅÜ`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èùô„Åã„Å´Èôç„ÇäÁ©ç„ÇÇ„ÇãÈõ™„ÄÇÊòéÊó•„ÅÆÊúù„ÅØÊ≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî ÁúüÂ§ú‰∏≠„ÅÆÂ§ßÈõ™„ÄÇÊòéÊúù„ÅÆ‰∫§ÈÄöÊ©üÈñ¢„ÇíÁ¢∫Ë™ç„Åó„Å¶`
                    ]);
                } else if (temp <= 0) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Êú¨Ê†ºÁöÑ„Å™Èõ™„ÄÇÁ©ç„ÇÇ„Çä„Åù„ÅÜ„Åß„Åô„ÄÇÊó©„ÇÅ„ÅÆÂ∏∞ÂÆÖ„Çí`,
                        `‚ùÑÔ∏è ${t} ‚Äî Êù±‰∫¨„Åß„ÅØÁèç„Åó„ÅÑÂ§ßÈõ™„ÄÇ‰∫§ÈÄöÊÉÖÂ†±„ÇíÁ¢∫Ë™ç„Åó„Å¶`,
                        `‚ùÑÔ∏è ${t} ‚Äî „Å©„Çì„Å©„ÇìÁ©ç„ÇÇ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇËª¢ÂÄí„Å´Ê≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî Â§ßÈõ™„ÅßÈõªËªä„ÅåÈÅÖ„Çå„Çã„Åã„ÇÇ„ÄÇ‰∫àÂÆö„ÅÆË™øÊï¥„Çí`
                    ]);
                } else {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Êπø„Å£„ÅüÈáç„ÅÑÈõ™„ÄÇÂÇò„Åå„Åô„ÅêÂ£ä„Çå„Åù„ÅÜ„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                        `üå®Ô∏è ${t} ‚Äî „Åπ„ÅüÈõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÊ≠©„Åç„Å´„Åè„ÅÑ`,
                        `üå®Ô∏è ${t} ‚Äî Êπø„Å£„ÅüÈõ™„ÄÇÊú®„ÅÆÊûù„ÅåÊäò„Çå„Çã„Åã„ÇÇ„ÄÇÈ†≠‰∏äÊ≥®ÊÑè`
                    ]);
                }
            }
            // ============================================================
            // PRIORITY 3: Snow - Expanded
            // ============================================================
            else if (isSnowActual || isSleetActual) {
                if (temp <= -5) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Âé≥„Åó„ÅÑÂØí„Åï„ÅÆ‰∏≠„ÄÅÈõ™„ÅåÈôç„ÇäÁ∂ö„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇË∑ØÈù¢ÂÆåÂÖ®ÂáçÁµê`,
                        `‚ùÑÔ∏è ${t} ‚Äî Ê•µÂØí„ÅÆÈõ™„ÄÇÂáçÂÇ∑Ê≥®ÊÑè„ÄÇÊöñ„Åã„ÅÑÊúçË£Ö„Åß`,
                        `‚ùÑÔ∏è ${t} ‚Äî Á≤âÈõ™„ÅåËàû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÁ©çÈõ™Ê≥®ÊÑè`
                    ]);
                } else if (temp <= 0 && isVeryDry) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî „Çµ„É©„Çµ„É©„ÅÆÁ≤âÈõ™„ÄÇÁ©ç„ÇÇ„Çä„ÇÑ„Åô„ÅÑ„Åß„Åô„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî ‰πæ„ÅÑ„ÅüÁ≤âÈõ™„ÄÇ„Çπ„Ç≠„ÉºÂ†¥„Åø„Åü„ÅÑ„Åß„Åô„Å≠`,
                        `‚ùÑÔ∏è ${t} ‚Äî „Åµ„Çè„Åµ„Çè„ÅÆÈõ™„ÄÇÁ∂∫È∫ó„Å†„Åë„Å©Êªë„Çä„ÇÑ„Åô„ÅÑ`
                    ]);
                } else if (temp <= 0 && isMorning) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Êúù„Åã„ÇâÈõ™ÊôØËâ≤„ÄÇÈÄöÂã§„ÉªÈÄöÂ≠¶„ÅØÊôÇÈñì„Å´‰ΩôË£ï„Çí`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅÆÊúù„ÄÇÂáçÁµê„Åó„ÅüË∑ØÈù¢„Å´Ê≥®ÊÑè„Åó„Å¶`,
                        `‚ùÑÔ∏è ${t} ‚Äî Êúù„ÅÆÈõ™„ÄÇÈõªËªä„ÅÆÈÅÖÂª∂ÊÉÖÂ†±„ÇíÁ¢∫Ë™ç„Åó„Å¶`
                    ]);
                } else if (temp <= 0) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÁ©ç„ÇÇ„Çä„Åù„ÅÜ„ÄÇË∂≥ÂÖÉ„Å®ÈÅãËª¢„Å´„Åè„Çå„Åê„Çå„ÇÇ„ÅîÊ≥®ÊÑè„Çí`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èùô„Åã„Å´Èõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÁ©çÈõ™Ê≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™ÂåñÁ≤ß„ÅÆË°ó„ÄÇÊªë„Çä„Å´„Åè„ÅÑÈù¥„ÅßÂá∫„Åã„Åë„Å¶`
                    ]);
                } else if (temp <= 2 && isSleet) {
                    comment = pick([
                        `üå®Ô∏è ${t} ‚Äî „Åø„Åû„Çå„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÇò„ÅåÂøÖÈ†à„ÄÇÊªë„Çä„ÇÑ„Åô„ÅÑ„ÅÆ„ÅßÊ≥®ÊÑè`,
                        `üå®Ô∏è ${t} ‚Äî Èõ®„Å®Èõ™„ÅåÊ∑∑„Åò„Å£„Åü„Åø„Åû„Çå„ÄÇÂÇò„Çí„Åï„Åó„Å¶„ÇÇÊø°„Çå„Åæ„Åô`,
                        `üå®Ô∏è ${t} ‚Äî „Åø„Åû„Çå„ÅßË∑ØÈù¢„Åå„Ç∑„É£„Éº„Éô„ÉÉ„ÉàÁä∂„ÄÇËª¢ÂÄíÊ≥®ÊÑè`
                    ]);
                } else if (temp <= 3) {
                    comment = pick([
                        `üå®Ô∏è ${t} ‚Äî „Åø„Åû„ÇåÊ∑∑„Åò„Çä„ÅÆÈõ™„ÄÇÂÇò„Å®„Åô„Åπ„Çä„Å´„Åè„ÅÑÈù¥„Åß`,
                        `üå®Ô∏è ${t} ‚Äî Èõ™„Å´„Å™„Çä„Åù„ÅÜ„Å™ÂÜ∑„Åü„ÅÑÈõ®„ÄÇÂ§©Ê∞ó„ÅÆÂ§âÂåñ„Å´Ê≥®ÊÑè`,
                        `üå®Ô∏è ${t} ‚Äî ÂØíÊ∞ó„ÅåÂº∑„ÅèÈõ™„Å´Â§â„Çè„Çã„Åã„ÇÇ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`
                    ]);
                } else if (isNight) {
                    comment = pick([
                        `üå®Ô∏è ${t} ‚Äî Â§ú„ÅÆÈõ™„ÄÇÊúù„Å´„ÅØÁ©ç„ÇÇ„Å£„Å¶„ÅÑ„Çã„Åã„ÇÇ`,
                        `üå®Ô∏è ${t} ‚Äî Èùô„Åã„Å™Èõ™„ÅÆÂ§ú„ÄÇÊòéÊó•„ÅÆÊúù„ÅØË∑ØÈù¢ÂáçÁµêÊ≥®ÊÑè`,
                        `üå®Ô∏è ${t} ‚Äî Â§úÊõ¥„Åë„ÅÆÈõ™„ÄÇ‰∫§ÈÄöÊÉÖÂ†±„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åä‰ºë„Åø„Çí`
                    ]);
                } else if (isEvening) {
                    comment = pick([
                        `üå®Ô∏è ${t} ‚Äî Â§ú„Å´„Åã„Åë„Å¶Á©ç„ÇÇ„Çã„Åã„ÇÇ„ÄÇÂ∏∞ÂÆÖ„ÅØÊó©„ÇÅ„Å´`,
                        `üå®Ô∏è ${t} ‚Äî Â§ïÊñπ„Åã„ÇâÈõ™„ÄÇÂ∏∞„ÇäÈÅì„ÅØÊªë„Çä„ÇÑ„Åô„ÅÑ`,
                        `üå®Ô∏è ${t} ‚Äî Èõ™„ÅåÂº∑„Åæ„Çä„Åù„ÅÜ„ÄÇÊó©„ÇÅ„ÅÆÂ∏∞ÂÆÖ„Åå„Åä„Åô„Åô„ÇÅ`
                    ]);
                } else {
                    comment = pick([
                        `üå®Ô∏è ${t} ‚Äî „Åì„ÅÆÊ∞óÊ∏©„ÅßÈõ™„ÅØÁèç„Åó„ÅÑ„Åß„Åô„Å≠„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                        `üå®Ô∏è ${t} ‚Äî Êù±‰∫¨„Åß„ÅØÁèç„Åó„ÅÑÈõ™„ÄÇÂÇò„ÇíÂøò„Çå„Åö„Å´`,
                        `üå®Ô∏è ${t} ‚Äî „Å°„Çâ„Å°„ÇâÈõ™„ÅåËàû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÈ¢®ÊÉÖ„Åå„ÅÇ„Çä„Åæ„Åô„Å≠`,
                        `üå®Ô∏è ${t} ‚Äî ÂàùÈõ™„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì„Å≠„ÄÇÊöñ„Åã„Åè„Åó„Å¶„ÅäÈÅé„Åî„Åó„Çí`
                    ]);
                }
                if (isVeryWindy) comment += ' üåÄ ÂêπÈõ™„Å´Ê≥®ÊÑè';
            }
            // ============================================================
            // PRIORITY 4: Heavy Rain / Showers (Èõ™/„Åø„Åû„ÇåÂà§ÂÆö„Å™„ÇâÂÑ™ÂÖà„Åß„Çπ„Ç≠„ÉÉ„Éó)
            // ============================================================
            else if ((isHeavyRain || isModerateRain) && !isSnowActual && !isSleetActual) {
                if (temp >= 32 && isExtremelyHumid) {
                    comment = `üåßÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÁåõÊöë„ÅÆ‰∏≠„ÅÆË±™Èõ®„ÄÇËí∏„ÅóÂú∞ÁçÑ„ÄÇÈõ®ÂÆø„Çä„Åó„Å¶Ê∂º„Çí`;
                } else if (temp >= 28 && isSummer && isAfternoon) {
                    comment = `üåßÔ∏è ${t} ‚Äî Â§è„ÅÆÂ§ïÁ´ã„ÅåÊøÄ„Åó„ÅÑ„Åß„Åô„ÄÇ1ÊôÇÈñì„ÇÇ„Åô„Çå„Å∞Ê≠¢„ÇÄ„Åã„ÇÇ`;
                } else if (temp >= 28 && isExtremelyHumid) {
                    comment = `üåßÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÁÜ±Â∏Ø„ÅÆ„Çà„ÅÜ„Å™„Çπ„Ç≥„Éº„É´„ÄÇ„Ç∏„É°„Ç∏„É°„Åó„Åæ„Åô`;
                } else if (temp >= 25 && isRainy) {
                    comment = `üåßÔ∏è ${t} ‚Äî Ê¢ÖÈõ®„ÅÆÊú¨Èôç„Çä„ÄÇ„Åò„ÇÅ„Åò„ÇÅËí∏„ÅóÊöë„ÅÑ„ÄÇÈô§ÊπøÂô®„Çí`;
                } else if (temp >= 25) {
                    comment = `üåßÔ∏è ${t} ‚Äî Ëí∏„ÅóÊöë„ÅÑ‰∏≠„ÄÅÊøÄ„Åó„ÅÑÈõ®„ÄÇÈõ®ÂÆø„Çä„Åó„Å¶Ê∂º„Åø„Åæ„Åó„Çá„ÅÜ`;
                } else if (temp >= 20 && isWindy) {
                    comment = `üåßÔ∏è ${t} ‚Äî Ê®™ÊÆ¥„Çä„ÅÆÈõ®„ÄÇÂÇò„ÅåÂΩπ„Å´Á´ã„Åü„Å™„ÅÑ„Åã„ÇÇ`;
                } else if (temp >= 20) {
                    comment = `üåßÔ∏è ${t} ‚Äî ÊøÄ„Åó„ÅÑÈõ®„ÄÇÂÇò„Åå„ÅÇ„Å£„Å¶„ÇÇÊø°„Çå„Åù„ÅÜ„ÄÇÂ∞ë„ÅóÂæÖ„Å§„ÅÆ„ÅåÂêâ`;
                } else if (temp >= 15 && isEvening) {
                    comment = `üåßÔ∏è ${t} ‚Äî Â§ïÊñπ„ÅÆÊú¨Èôç„Çä„ÄÇÂ∏∞ÂÆÖ„É©„ÉÉ„Ç∑„É•„Å´ÂΩ±Èüø„Åó„Åù„ÅÜ`;
                } else if (temp >= 10 && isAutumn) {
                    comment = `üåßÔ∏è ${t} ‚Äî Áßã„ÅÆÂÜ∑„Åü„ÅÑÈõ®„ÄÇÊø°„Çå„Çã„Å®‰Ωì„ÅåÂÜ∑„Åà„Åæ„Åô„ÄÇÊöñ„Åã„Åè„Åó„Å¶`;
                } else if (temp >= 10) {
                    comment = `üåßÔ∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈõ®„ÅåÊøÄ„Åó„ÅèÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÊø°„Çå„Çã„Å®ÂÜ∑„Åà„Åæ„Åô`;
                } else if (temp >= 5) {
                    comment = `üåßÔ∏è ${t} ‚Äî Âáç„Åà„Çã„Çà„ÅÜ„Å™ÂÜ∑„Åü„ÅÑË±™Èõ®„ÄÇÊø°„Çå„Åü„Çâ„Åô„ÅêÁùÄÊõø„Åà„Çí`;
                } else {
                    comment = `üåßÔ∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈõ®„ÅåÊøÄ„Åó„ÅÑ„ÄÇÈõ™„Å´Â§â„Çè„Çã„Åã„ÇÇ„ÄÇÊöñ„Åã„ÅÑÂ±ãÂÜÖ„Å∏`;
                }
                if (isVeryWindy) comment += ' üí® È¢®„ÇÇÂº∑„ÅÑÔºÅ';
            }
            // ============================================================
            // PRIORITY 5: Regular Rain (Èõ™/„Åø„Åû„ÇåÂà§ÂÆö„Å™„ÇâÂÑ™ÂÖà„Åß„Çπ„Ç≠„ÉÉ„Éó)
            // ============================================================
            else if (isRain && !isSnowActual && !isSleetActual) {
                if (temp >= 30 && isExtremelyHumid) {
                    comment = `‚òî ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „É†„Ç∑„É†„Ç∑„Åó„ÅüÁÜ±Â∏ØÈõ®„ÄÇ‰∏çÂø´ÊåáÊï∞MAX„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Çí`;
                } else if (temp >= 28 && isVeryHumid) {
                    comment = `‚òî ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÈõ®„ÄÇÊ±ó„ÅåÊ≠¢„Åæ„Çâ„Å™„ÅÑ„ÄÇ„Åì„Åæ„ÇÅ„Å´Ê∞¥ÂàÜË£úÁµ¶`;
                } else if (temp >= 25 && isMorning) {
                    comment = `‚òî ${t} ‚Äî Êúù„Åã„ÇâÈõ®„ÄÇÂÇò„ÇíÂøò„Çå„Åö„Å´„ÄÇËí∏„ÅóÊöë„Åè„Å™„Çä„Åù„ÅÜ`;
                } else if (temp >= 25) {
                    comment = `‚òî ${t} ‚Äî Êöñ„Åã„ÅÑÈõ®„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÇò„Çí„ÅäÊåÅ„Å°„Åè„Å†„Åï„ÅÑ`;
                } else if (temp >= 20 && isRainy) {
                    comment = `‚òî ${t} ‚Äî Ê¢ÖÈõ®„Çâ„Åó„ÅÑ„Åó„Å®„Åó„Å®Èõ®„ÄÇ„Ç´„ÉìÂØæÁ≠ñ„ÇíÂøò„Çå„Åö„Å´`;
                } else if (temp >= 18 && isSpring) {
                    comment = `‚òî ${t} ‚Äî Êò•Èõ®„Åß„Åô„Å≠„ÄÇËä±Á≤â„ÅåÊµÅ„Çå„Çã„ÅÆ„ÅØÂ¨â„Åó„ÅÑ„Åã„ÇÇ`;
                } else if (temp >= 15) {
                    comment = `‚òî ${t} ‚Äî „Åó„Å®„Åó„Å®Èõ®„ÄÇËÇåÂØí„Åï„ÇíÊÑü„Åò„Åü„Çâ‰∏äÁùÄ„Çí`;
                } else if (temp >= 10 && isAutumn) {
                    comment = `‚òî ${t} ‚Äî ÁßãÈõ®„Åß„Åô„ÄÇÊ∞óÊ∏©„ÇÇ‰∏ã„Åå„Å£„Å¶ÂØí„Åè„Å™„Å£„Å¶„Åç„Åæ„Åó„Åü`;
                } else if (temp >= 10) {
                    comment = `‚òî ${t} ‚Äî ËÇåÂØí„ÅÑÈõ®„ÄÇÈï∑Ë¢ñ„Å®ÂÇò„ÅØÂøÖÈ†à`;
                } else if (temp >= 5 && isWinter) {
                    comment = `‚òî ${t} ‚Äî ÂÜ¨„ÅÆÂÜ∑„Åü„ÅÑÈõ®„ÄÇ„Åø„Åû„Çå„Å´„Å™„Çã„Åã„ÇÇ`;
                } else if (temp >= 5) {
                    comment = `‚òî ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈõ®„ÄÇÊø°„Çå„Çã„Å®‰∏ÄÊ∞ó„Å´ÂÜ∑„Åà„Åæ„Åô`;
                } else if (isSnowActual) {
                    // Yahoo API„ÅßÈõ™„Å®Âà§ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà
                    comment = `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∑ØÈù¢ÂáçÁµê„Å´Ê≥®ÊÑè`;
                } else if (isSleetActual) {
                    // Yahoo API„Åß„Åø„Åû„Çå„Å®Âà§ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà
                    comment = `üå®Ô∏è ${t} ‚Äî „Åø„Åû„Çå„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∂≥ÂÖÉ„Å´Ê≥®ÊÑè`;
                } else if (temp >= 2) {
                    comment = `‚òî ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈõ®„ÄÇÊöñ„Åã„Åè„Åó„Å¶`;
                } else {
                    // Ê∞óÊ∏©2Â∫¶Êú™Ê∫Ä„Åß„ÇÇÈõ™„Å®Âà§ÂÆö„Åï„Çå„Å™„Åã„Å£„ÅüÂ†¥Âêà
                    comment = `‚òî ${t} ‚Äî „Å®„Å¶„ÇÇÂÜ∑„Åü„ÅÑÈõ®„ÄÇÊöñ„Åã„ÅÑÂ±ãÂÜÖ„Å∏`;
                }
            }
            // ============================================================
            // PRIORITY 6: Drizzle (Èõ™/„Åø„Åû„ÇåÂà§ÂÆö„Å™„ÇâÂÑ™ÂÖà„Åß„Çπ„Ç≠„ÉÉ„Éó)
            // ============================================================
            else if (isDrizzle && !isSnowActual && !isSleetActual) {
                if (temp >= 28 && isExtremelyHumid) {
                    comment = `üåßÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÈúßÈõ®„Å†„Åë„Å©„É†„Ç∑„É†„Ç∑„ÄÇÊ±ó„Åå‰πæ„Åã„Å™„ÅÑ`;
                } else if (temp >= 25 && isSummer) {
                    comment = `üåßÔ∏è ${t} ‚Äî Â∞ë„Åó„Å†„Åë„Éë„É©„Å§„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÇò„Å™„Åó„Åß„ÇÇÂ§ß‰∏àÂ§´„Åã„ÇÇÔºü`;
                } else if (temp >= 25) {
                    comment = `üåßÔ∏è ${t} ‚Äî Â∞èÈõ®„Åå„Éë„É©„Å§„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇÊäò„Çä„Åü„Åü„ÅøÂÇò„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`;
                } else if (temp >= 20 && isRainy) {
                    comment = `üåßÔ∏è ${t} ‚Äî Ê¢ÖÈõ®„ÅÆ„Åó„Å£„Å®„ÇäÈúßÈõ®„ÄÇÈ´™„Åå„Åæ„Å®„Åæ„Çâ„Å™„ÅÑÂ≠£ÁØÄ`;
                } else if (temp >= 18 && isSpring) {
                    comment = `üåßÔ∏è ${t} ‚Äî Êò•„ÅÆÈúßÈõ®„ÄÇÊñ∞Á∑ë„ÅåÊΩ§„ÅÜËâØ„ÅÑÈõ®`;
                } else if (temp >= 15) {
                    comment = `üåßÔ∏è ${t} ‚Äî ÈúßÈõ®„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Åó„Å£„Å®„Çä„Åó„ÅüÁ©∫Ê∞ó`;
                } else if (temp >= 10 && isAutumn) {
                    comment = `üåßÔ∏è ${t} ‚Äî Áßã„ÅÆÈúßÈõ®„ÄÇÁ¥ÖËëâ„ÅåÊø°„Çå„Å¶Áæé„Åó„ÅÑ`;
                } else if (temp >= 10) {
                    comment = `üåßÔ∏è ${t} ‚Äî Â∞èÈõ®„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇËÇåÂØí„Åï„Å´Ê≥®ÊÑè`;
                } else if (temp >= 5) {
                    comment = `üåßÔ∏è ${t} ‚Äî Á¥∞„Åã„ÅÑÂÜ∑„Åü„ÅÑÈõ®„ÄÇÊø°„Çå„Çã„Å®ÂØí„ÅÑ„ÅÆ„ÅßÂÇò„Çí`;
                } else {
                    comment = `üåßÔ∏è ${t} ‚Äî Âáç„Å¶„Å§„ÅèÈúßÈõ®„ÄÇÈõ™„Å´Â§â„Çè„Çã„Åã„ÇÇ`;
                }
            }
            // ============================================================
            // PRIORITY 6.5: YahooÊ§úÂá∫„ÅÆÈõ™/„Åø„Åû„ÇåÔºàOpen-Meteo„ÅåÈõ®Âà§ÂÆö„Å†„ÅåÂÆüÈöõ„ÅØÈõ™/„Åø„Åû„ÇåÔºâ
            // ============================================================
            else if (isSnowActual && isRaining) {
                // Open-Meteo„ÅØÈõ®Âà§ÂÆö„Å†„Åå„ÄÅÊàë„ÄÖ„ÅÆÂà§ÂÆö„ÅßÈõ™
                if (temp <= 0) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÁ©ç„ÇÇ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì`,
                        `‚ùÑÔ∏è ${t} ‚Äî „Åó„Çì„Åó„Çì„Å®Èõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî Á≤âÈõ™„Åå„Å°„Çâ„Å§„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇË∑ØÈù¢ÂáçÁµê„Å´Ê≥®ÊÑè`
                    ]);
                } else if (temp <= 2) {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂØí„Åï„Å´Ê≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî Êπø„Å£„ÅüÈõ™„ÄÇÂÇò„Åå„ÅÇ„Çã„Å®ËâØ„ÅÑ„Åã„ÇÇ`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåËàû„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÊöñ„Åã„Åè„Åó„Å¶`
                    ]);
                } else {
                    comment = pick([
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂØí„ÅïÂØæÁ≠ñ„Çí`,
                        `‚ùÑÔ∏è ${t} ‚Äî „Åπ„ÅüÈõ™„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                        `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÈôç„ÇäÂßã„ÇÅ„Åæ„Åó„Åü„ÄÇÂÇò„Çí„ÅäÂøò„Çå„Å™„Åè`
                    ]);
                }
                if (isVeryWindy) comment += ' üåÄ ÂêπÈõ™„Å´Ê≥®ÊÑè';
            }
            else if (isSleetActual && isRaining) {
                // Open-Meteo„ÅØÈõ®Âà§ÂÆö„Å†„Åå„ÄÅÊàë„ÄÖ„ÅÆÂà§ÂÆö„Åß„Åø„Åû„Çå
                comment = pick([
                    `üå®Ô∏è ${t} ‚Äî „Åø„Åû„Çå„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇË∂≥ÂÖÉ„ÅåÊªë„Çä„ÇÑ„Åô„ÅÑ„Åß„Åô`,
                    `üå®Ô∏è ${t} ‚Äî Èõ™„Åæ„Åò„Çä„ÅÆÈõ®„ÄÇÂÇò„Å®Ë∂≥ÂÖÉ„Å´Ê≥®ÊÑè`,
                    `üå®Ô∏è ${t} ‚Äî „Åø„Åû„ÇåÊ®°Êßò„ÄÇË∑ØÈù¢ÂáçÁµê„ÅÆÂèØËÉΩÊÄß„ÅÇ„Çä`,
                    `üå®Ô∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑ„Åø„Åû„Çå„ÄÇÊöñ„Åã„ÅÑÊúçË£Ö„Åß`
                ]);
            }
            // ============================================================
            // PRIORITY 7: Fog - Expanded
            // ============================================================
            else if (isFog) {
                if (temp >= 25 && isExtremelyHumid) {
                    comment = pick([
                        `üå´Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÈúß„ÄÇ„Çµ„Ç¶„Éä„ÅÆ„Çà„ÅÜ„Å™Á©∫Ê∞ó`,
                        `üå´Ô∏è ${t} ‚Äî ÊπøÂ∫¶„ÅåÈ´ò„Åè„Å¶Èúß„ÅåÊøÉ„ÅÑ„ÄÇË¶ñÁïå‰∏çËâØ`,
                        `üå´Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÈúß„ÄÇ‰∏çÂø´ÊåáÊï∞MAX`
                    ]);
                } else if (temp >= 20 && isMorning) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî ÊúùÈúß„ÅåÂá∫„Å¶„ÅÑ„Åæ„Åô„ÄÇÊó•„ÅåÊòá„Çå„Å∞Êô¥„Çå„Åù„ÅÜ`,
                        `üå´Ô∏è ${t} ‚Äî ÂπªÊÉ≥ÁöÑ„Å™ÊúùÈúß„ÄÇÈÄöÂã§„ÅØË¶ñÁïåÊ≥®ÊÑè`,
                        `üå´Ô∏è ${t} ‚Äî Êúù„ÇÇ„ÇÑ„Åå„Åã„Åã„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÂçàÂâç‰∏≠„Å´„ÅØÊô¥„Çå„Çã„Åß„Åó„Çá„ÅÜ`
                    ]);
                } else if (temp >= 20 && isNight) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî Â§úÈúß„ÅåÁ´ã„Å°Ëæº„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇËªä„ÅÆÈÅãËª¢„ÅØÊ≥®ÊÑè`,
                        `üå´Ô∏è ${t} ‚Äî Êöñ„Åã„ÅÑÂ§úÈúß„ÄÇ„Éü„Çπ„ÉÜ„É™„Ç¢„Çπ„Å™Èõ∞Âõ≤Ê∞ó`,
                        `üå´Ô∏è ${t} ‚Äî Èúß„ÅÆÂ§ú„ÄÇ„Éò„ÉÉ„Éâ„É©„Ç§„Éà„ÇíËêΩ„Å®„Åó„Å¶ÈÅãËª¢„Çí`
                    ]);
                } else if (temp >= 20) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî Êöñ„Åã„ÅÑÈúß„ÅåÁ´ã„Å°Ëæº„ÇÅ„Å¶„ÅÑ„Åæ„Åô„ÄÇË¶ñÁïå‰∏çËâØÊ≥®ÊÑè`,
                        `üå´Ô∏è ${t} ‚Äî Èúß„ÅßË¶ñÁïå„ÅåÊÇ™„ÅÑ„ÄÇÈÄüÂ∫¶„ÇíËêΩ„Å®„Åó„Å¶`,
                        `üå´Ô∏è ${t} ‚Äî „ÇÇ„ÇÑ„Åå„Åã„Åã„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇÈÅ†„Åè„ÅåË¶ã„Åà„Å´„Åè„ÅÑ`
                    ]);
                } else if (temp >= 15 && isAutumn) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî ÁßãÈúß„Åß„Åô„Å≠„ÄÇÂπªÊÉ≥ÁöÑ„Åß„Åô„ÅåÈÅãËª¢Ê≥®ÊÑè`,
                        `üå´Ô∏è ${t} ‚Äî Áßã„ÅÆÊúùÈùÑ„ÄÇÁ¥ÖËëâ„Å®Èúß„ÅåÁæé„Åó„ÅÑ`,
                        `üå´Ô∏è ${t} ‚Äî Èúß„ÅÆ„Åã„Åã„Å£„ÅüÁßã„ÅÆÈ¢®ÊôØ„ÄÇÈÅãËª¢„ÅØÊÖéÈáç„Å´`
                    ]);
                } else if (temp >= 10 && isMorning) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî ÊîæÂ∞ÑÈúß„Åß„Åô„ÄÇÊó•‰∏≠„ÅØÊô¥„Çå„ÇãË¶ãËæº„Åø`,
                        `üå´Ô∏è ${t} ‚Äî Êúù„ÅÆÊøÉÈúß„ÄÇ‰∫§ÈÄöÊÉÖÂ†±„ÇíÁ¢∫Ë™ç„Åó„Å¶`,
                        `üå´Ô∏è ${t} ‚Äî Â∑ùÊ≤ø„ÅÑ„ÅØÁâπ„Å´Èúß„ÅåÊøÉ„ÅÑ„ÄÇÈÄöÂã§Ê≥®ÊÑè`
                    ]);
                } else if (temp >= 10) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî Èúß„ÅåÂá∫„Å¶„ÅÑ„Åæ„Åô„ÄÇÈÅãËª¢„ÅØÂçÅÂàÜ„Å™ËªäÈñìË∑ùÈõ¢„Çí`,
                        `üå´Ô∏è ${t} ‚Äî Ë¶ñÁïå‰∏çËâØ„ÄÇ„Éï„Ç©„Ç∞„É©„É≥„Éó„Çí„Å§„Åë„Å¶`,
                        `üå´Ô∏è ${t} ‚Äî Èúß„ÅßË¶ãÈÄö„ÅóÊÇ™„ÅÑ„ÄÇ„Çπ„Éî„Éº„Éâ„ÇíËêΩ„Å®„Åó„Å¶`
                    ]);
                } else if (temp >= 5) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈúß„ÄÇË¶ñÁïåÊÇ™„ÅèË∑ØÈù¢„ÇÇÊªë„Çä„ÇÑ„Åô„ÅÑ`,
                        `üå´Ô∏è ${t} ‚Äî ÂØí„ÅÑÈúß„ÄÇÊø°„Çå„Çã„Å®‰Ωì„ÅåÂÜ∑„Åà„Åæ„Åô`,
                        `üå´Ô∏è ${t} ‚Äî ÂÜ∑„Åü„ÅÑÈúßÈõ®Ê∑∑„Åò„Çä„ÄÇÂÇò„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`
                    ]);
                } else if (temp >= 0) {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî ÂáçÈúß„Åß„Åô„ÄÇË∑ØÈù¢„Åå„Ç¢„Ç§„Çπ„Éê„Éº„É≥Áä∂ÊÖã„Åã„ÇÇ`,
                        `üå´Ô∏è ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅÆÈúß„ÄÇ„Åô„Åπ„Å¶„ÅåÂáç„Çä„Å§„Åç„Åæ„Åô`,
                        `üå´Ô∏è ${t} ‚Äî ÂáçÈúßÊ≥®ÊÑè„ÄÇ„Éñ„É©„ÉÉ„ÇØ„Ç¢„Ç§„Çπ„Å´Ë≠¶Êàí`
                    ]);
                } else {
                    comment = pick([
                        `üå´Ô∏è ${t} ‚Äî Ê•µÂØí„ÅÆÈúß„ÄÇ„Åô„Åπ„Å¶„ÅåÂáç„Çä„Å§„ÅÑ„Å¶„ÅÑ„Åæ„Åô`,
                        `üå´Ô∏è ${t} ‚Äî Âêê„ÅèÊÅØ„ÇÇÂáç„ÇãÈúß„ÄÇË¶ñÁïå„Çº„É≠„Å´Ëøë„ÅÑ`,
                        `üå´Ô∏è ${t} ‚Äî Èúß„Å®Ê•µÂØí„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`
                    ]);
                }
            }
            // ============================================================
            // PRIORITY 8: Clear/Cloudy with temperature+humidity+UV+time
            // ============================================================
            else {
                // ============================================================
                // PRIORITY 8a: High precipitation probability warning
                // ============================================================
                if (pp >= 70 && !isRaining && !isSnow && !isHeavySnow) {
                    if (temp <= 2) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÈôçÊ∞¥Á¢∫Áéá${pp}%„ÄÇÈõ™„ÅåÈôç„ÇãÂèØËÉΩÊÄß„ÅåÈ´ò„ÅÑ„Åß„Åô„ÄÇÊó©„ÇÅ„ÅÆÂ∏∞ÂÆÖ„Çí`,
                            `üå®Ô∏è ${t} ‚Äî ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ™„ÄÇË∑ØÈù¢ÂáçÁµê„Å´ÂÇô„Åà„Å¶`,
                            `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅÆ‰∫àÂ†±„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„ÇÅ„Å´`
                        ]);
                    } else if (temp <= 5) {
                        comment = pick([
                            `‚òî ${t} ‚Äî ÈôçÊ∞¥Á¢∫Áéá${pp}%„ÄÇÂÜ∑„Åü„ÅÑÈõ®„Å´„Å™„Çä„Åù„ÅÜ„ÄÇÂÇò„ÇíÂøò„Çå„Åö„Å´`,
                            `üåßÔ∏è ${t} ‚Äî ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®„ÄÇÊöñ„Åã„ÅÑ‰∏äÁùÄ„ÇÇ`,
                            `‚òî ${t} ‚Äî Èõ®„ÅÆ‰∫àÂ†±„ÄÇÊø°„Çå„Çã„Å®ÂØí„ÅÑ„ÅÆ„ÅßÂÇòÂøÖÈ†à`
                        ]);
                    } else {
                        comment = pick([
                            `‚òî ${t} ‚Äî ÈôçÊ∞¥Á¢∫Áéá${pp}%„ÄÇÂÇò„Çí„ÅäÂøò„Çå„Å™„Åè`,
                            `üåßÔ∏è ${t} ‚Äî ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®„ÄÇÊäò„Çä„Åü„Åü„ÅøÂÇò„ÅåÂÆâÂøÉ`,
                            `‚òî ${t} ‚Äî Èõ®„ÅåÈôç„Çä„Åù„ÅÜ„ÄÇÂÇò„ÇíÊåÅ„Å£„Å¶Âá∫„Åã„Åë„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    }
                }
                // DEADLY HEAT 40+ - Expanded
                else if (temp >= 40) {
                    if (isNight && isExtremelyHumid) {
                        comment = pick([
                            `üÜò ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÂ§úÈñì„Åß„ÇÇËá¥Ê≠ªÁöÑ„Å™Êöë„Åï„ÄÇÊïëÊÄ•Êê¨ÈÄÅ„É¨„Éô„É´„ÄÇÁµ∂ÂØæ„Å´„Ç®„Ç¢„Ç≥„É≥„Çí`,
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•„ÄëÂ§ú„Å™„ÅÆ„Å´40¬∞CË∂Ö„Åà„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Å™„Åó„Åß„ÅØÂëΩ„Å´Èñ¢„Çè„Çä„Åæ„Åô`,
                            `üÜò ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂç±Èô∫„ÄëË¶≥Ê∏¨Âè≤‰∏äÊúÄÊÇ™„É¨„Éô„É´„ÄÇ‰ΩìË™øÁï∞Â§â„ÅØ119Áï™„Å∏`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üÜò ${t} ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÁï∞Â∏∏„Å™ÁÜ±Â∏ØÂ§ú„ÄÇ„Ç®„Ç¢„Ç≥„É≥ÂøÖÈ†à„ÄÇ‰ΩìË™øÁï∞Â§â„ÇíÊÑü„Åò„Åü„Çâ119Áï™`,
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•‰∫ãÊÖã„ÄëÊ∑±Â§ú„Åß„ÇÇ40¬∞C„ÄÇÂÜ∑Êàø„ÇíÊúÄÂ§ß„Å´„Åó„Å¶Ê∞¥ÂàÜË£úÁµ¶„Çí`,
                            `üÜò ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÂâç‰ª£Êú™ËÅû„ÅÆÁÜ±Â∏ØÂ§ú„ÄÇÁµ∂ÂØæ„Å´„Ç®„Ç¢„Ç≥„É≥„ÇíÂàá„Çâ„Å™„ÅÑ„Åß`
                        ]);
                    } else if (isExtremelyHumid) {
                        comment = pick([
                            `üÜò ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁ∑äÊÄ•‰∫ãÊÖã„ÄëÁÜ±‰∏≠Áóá„ÅßÊ≠ª‰∫°„Åô„Çã„É¨„Éô„É´„ÄÇÂ§ñÂá∫Á¶ÅÊ≠¢„ÄÇ„ÇØ„Éº„É©„ÉºÂÖ®Èñã„Åß`,
                            `üÜò ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëËí∏„ÅóÈ¢®ÂëÇ„ÇíË∂Ö„Åà„ÅüÊöë„Åï„ÄÇÂ±ãÂÜÖ„Åß„ÇÇÂç±Èô∫`,
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•„Äë‰∫∫‰Ωì„ÅÆÈôêÁïå„ÇíË∂Ö„Åà„ÅüÊöë„Åï„ÄÇ„Åô„Åê„Å´Ê∂º„Åó„ÅÑÂ†¥ÊâÄ„Å∏`
                        ]);
                    } else if (isClear && isAfternoon) {
                        comment = pick([
                            `üÜò ${t} ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëË®òÈå≤ÁöÑÁåõÊöë„ÄÇÂ±ãÂ§ñ„Åß„ÅÆÊ¥ªÂãï„ÅØÂëΩ„Å´Èñ¢„Çè„Çä„Åæ„Åô„ÄÇÂ§ñÂá∫Á¶ÅÊ≠¢`,
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•‰∫ãÊÖã„ÄëÂçàÂæå„ÅÆ„Éî„Éº„ÇØ„ÄÇ„Ç¢„Çπ„Éï„Ç°„É´„Éà„ÅØ60¬∞CË∂Ö„Åà„ÄÇÁÅ´ÂÇ∑„Åó„Åæ„Åô`,
                            `üÜò ${t} ‚Äî „ÄêÂç±Èô∫„ÄëË¶≥Ê∏¨Âè≤‰∏äÊúÄÈ´ò„É¨„Éô„É´„ÄÇÂ±ãÂ§ñ„Å´Âá∫„Å™„ÅÑ„Åß`
                        ]);
                    } else if (isMorning) {
                        comment = pick([
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•„ÄëÊúù„Åã„Çâ40¬∞CË∂Ö„Åà„ÄÇ‰ªäÊó•„ÅØÂ§ñÂá∫„Åó„Å™„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ`,
                            `üÜò ${t} ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÊúù„Åã„Çâ„Åì„ÅÆÊ∞óÊ∏©„ÅØÁï∞Â∏∏„ÄÇ‰∫àÂÆö„Çí„Åô„Åπ„Å¶„Ç≠„É£„É≥„Çª„É´„Åó„Å¶`
                        ]);
                    } else {
                        comment = pick([
                            `üÜò ${t} ‚Äî „ÄêÁîüÂëΩ„ÅÆÂç±Ê©ü„Äë‰ΩìÊ∏©Ë™øÁØÄ„ÅåÈôêÁïå„ÇíË∂Ö„Åà„ÇãÊöë„Åï„ÄÇÊ∂º„Åó„ÅÑÂ†¥ÊâÄ„Å∏‰ªä„Åô„ÅêÈÅøÈõ£`,
                            `üÜò ${t} ‚Äî „ÄêÁ∑äÊÄ•‰∫ãÊÖã„Äë‰∫∫Èñì„ÅåÊ¥ªÂãï„Åß„Åç„ÇãÊ∞óÊ∏©„Åß„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì`,
                            `üÜò ${t} ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÁÜ±‰∏≠Áóá„Å´„Çà„ÇãÊ≠ª‰∫°„É™„Çπ„ÇØÂ§ß„ÄÇÂÜ∑Êàø„ÅÆÂäπ„ÅÑ„ÅüÂÆ§ÂÜÖ„Å∏`
                        ]);
                    }
                }
                // EXTREME HEAT 38-40 - Expanded
                else if (temp >= 38) {
                    if (isNight && isExtremelyHumid) {
                        comment = pick([
                            `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂç±Èô∫„ÄëÂ§ú„ÇÇËí∏„ÅóÈ¢®ÂëÇÁä∂ÊÖã„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Å™„Åó„Åß„ÅØÁÜ±‰∏≠Áóá„ÅÆÊÅê„Çå`,
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÂØù„Å¶„ÅÑ„ÇãÈñì„Å´ÁÜ±‰∏≠Áóá„Å´„Å™„Çã„É™„Çπ„ÇØ„ÄÇÂÜ∑ÊàøÂøÖÈ†à`,
                            `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂç±Èô∫„ÄëÁï∞Â∏∏„Å™ÁÜ±Â∏ØÂ§ú„ÄÇÊ∞¥„ÇíÊûïÂÖÉ„Å´ÁΩÆ„ÅÑ„Å¶`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÊ∑±Â§ú„Åß„ÇÇÂç±Èô∫„Å™Êöë„Åï„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Çí„Å§„Åë„Å¶Â∞±ÂØù„Çí`,
                            `üö® ${t} ‚Äî „ÄêÊ≥®ÊÑè„ÄëÁúüÂ§ú‰∏≠„Åß„ÇÇ38¬∞C„ÄÇÂÜ∑Êàø„ÅØÂàá„Çâ„Å™„ÅÑ„Åß`,
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÁÜ±Â∏ØÂ§ú„ÅÆ„É¨„Éô„É´„ÇíË∂Ö„Åà„Å¶„ÅÑ„Åæ„Åô„ÄÇÊ∞¥ÂàÜË£úÁµ¶„ÇíÂøò„Çå„Åö„Å´`
                        ]);
                    } else if (isClear && isExtremeUV && !isNight) {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëUVÊ•µÁ´Ø„Éª‰ΩìÊ∏©Ë∂Ö„Åà„ÄÇÂ§ñÂá∫Á¶ÅÊ≠¢„É¨„Éô„É´„ÄÇÂÆ§ÂÜÖ„Å∏ÈÅøÈõ£`,
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÁõ¥Â∞ÑÊó•ÂÖâ„ÅØÂá∂Âô®„ÄÇ5ÂàÜ„ÅßÁÅ´ÂÇ∑„É¨„Éô„É´`,
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëËÇå„ÇíÈú≤Âá∫„Åó„Å™„ÅÑ„Åß„ÄÇÂ∏ΩÂ≠ê„ÉªÊó•ÂÇò„ÉªÈï∑Ë¢ñ„ÅßÂÆåÂÖ®Èò≤ÂÇô„Çí`
                        ]);
                    } else if (isClear && isAfternoon) {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÂçàÂæå„ÅÆÁåõÊöë„Åå„Éî„Éº„ÇØÔºÅÊó•Èô∞„ÇÇÂç±Èô∫„Å™Êöë„Åï„ÄÇÂ±ãÂÜÖ„Å∏`,
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„Äë„Ç¢„Çπ„Éï„Ç°„É´„Éà„ÅØ50¬∞CË∂Ö„Åà„ÄÇ„Éö„ÉÉ„Éà„ÅÆÊï£Ê≠©„ÅØÂé≥Á¶Å`,
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÂ±ãÂ§ñ‰ΩúÊ•≠„ÅØ‰∏≠Ê≠¢„Çí„ÄÇÁÜ±‰∏≠Áóá„ÅßÂÄí„Çå„Çã„É™„Çπ„ÇØÂ§ß`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÊúù„Åã„Çâ‰ΩìÊ∏©Ë∂Ö„Åà„ÄÇ‰ªäÊó•„ÅØÂ§ñÂá∫„ÇíÊéß„Åà„Å¶`,
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÂçàÂâç‰∏≠„Åß„Åì„ÅÆÊöë„Åï„ÄÇÂçàÂæå„ÅØ„ÇÇ„Å£„Å®‰∏ä„Åå„Çä„Åæ„Åô`
                        ]);
                    } else if (isExtremelyHumid) {
                        comment = pick([
                            `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂç±Èô∫„ÄëÂëΩ„Å´Èñ¢„Çè„ÇãËí∏„ÅóÊöë„Åï„ÄÇ„ÇØ„Éº„É©„Éº„ÅÆÂäπ„ÅÑ„ÅüÂÆ§ÂÜÖ„Å∏`,
                            `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêË≠¶Âëä„ÄëÊπøÂ∫¶„ÇÇÈ´ò„Åè„Å¶Âç±Èô∫„ÄÇÊ±ó„ÅåËí∏Áô∫„Åó„Åæ„Åõ„Çì`
                        ]);
                    } else if (isEvening) {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêÊ≥®ÊÑè„ÄëÂ§ïÊñπ„Åß„ÇÇÂç±Èô∫„Å™Êöë„Åï„ÄÇÊ∞¥ÂàÜË£úÁµ¶„ÇíÊÄ†„Çâ„Å™„ÅÑ„Åß`,
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÊó•„ÅåÂÇæ„ÅÑ„Å¶„ÇÇ38¬∞C„ÄÇÂ§ú„ÇÇÁÜ±Â∏ØÂ§úÁ¢∫ÂÆü`
                        ]);
                    } else {
                        comment = pick([
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„Äë‰ΩìÊ∏©„ÇíË∂Ö„Åà„ÇãÊöë„Åï„ÄÇÊõá„Å£„Å¶„ÅÑ„Å¶„ÇÇÁÜ±‰∏≠Áóá„ÅÆÂç±Èô∫`,
                            `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÁåõÊöëÊó•„Çí„ÅØ„Çã„Åã„Å´Ë∂Ö„Åà„ÅüÊöë„Åï„ÄÇÂÜ∑Êàø„ÅÆÂäπ„ÅÑ„ÅüÂ†¥ÊâÄ„Å∏`,
                            `üö® ${t} ‚Äî „ÄêË≠¶Âëä„ÄëÂç±Èô∫„Å™È´òÊ∏©„ÄÇÈÅãÂãï„ÅØÂé≥Á¶Å„ÄÇ„Åì„Åæ„ÇÅ„Å™Ê∞¥ÂàÜË£úÁµ¶„Çí`
                        ]);
                    }
                }
                // DANGER 36-38 (ÂëΩ„Å´Èñ¢„Çè„ÇãÂç±Èô∫)
                else if (temp >= 36) {
                    if (isNight && isExtremelyHumid) {
                        comment = `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÂ§úÈñì„ÇÇÂç±Èô∫„Å™Ëí∏„ÅóÊöë„Åï„ÄÇ„Ç®„Ç¢„Ç≥„É≥ÂøÖÈ†à„ÄÇ119Áï™„ÇíÊÑèË≠ò„Åó„Å¶`;
                    } else if (isNight && isVeryHumid) {
                        comment = `ÔøΩ ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂç±Èô∫„ÄëÁÜ±Â∏ØÂ§ú√óÈ´òÊπøÂ∫¶„ÄÇËÑ±Ê∞¥„Å´Ê≥®ÊÑè„ÄÇÂØù„ÇãÂâç„Å´Ê∞¥„Çí`;
                    } else if (isNight) {
                        comment = `‚ö†Ô∏è ${t} ‚Äî „ÄêÁÜ±‰∏≠ÁóáÂç±Èô∫„ÄëÁï∞Â∏∏„Å™ÁÜ±Â∏ØÂ§ú„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Å™„Åó„Åß„ÅØÂëΩ„Å´Èñ¢„Çè„Çä„Åæ„Åô`;
                    } else if (isExtremelyHumid && isAfternoon) {
                        comment = `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëÂ§ñÂá∫Á¶ÅÊ≠¢„É¨„Éô„É´„ÄÇ„Éö„ÉÉ„Éà„ÇÑÂ≠ê„Å©„ÇÇ„ÇíËªäÂÜÖ„Å´Áµ∂ÂØæÊÆã„Åï„Å™„ÅÑ„Åß`;
                    } else if (isExtremelyHumid) {
                        comment = `üö® ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÂëΩ„ÅÆÂç±Èô∫„ÄëËí∏„ÅóÈ¢®ÂëÇÁä∂ÊÖã„ÄÇÂ±ãÂÜÖ„Åß„ÇÇÁÜ±‰∏≠Áóá„ÅÆ„É™„Çπ„ÇØÂ§ß`;
                    } else if (isVeryHumid) {
                        comment = `‚ö†Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁÜ±‰∏≠ÁóáÂç±Èô∫„ÄëÊ±ó„Åå‰πæ„Åã„Åö‰ΩìÊ∏©Ë™øÁØÄÂõ∞Èõ£„ÄÇÊ∂º„Åó„ÅÑÂ†¥ÊâÄ„Å∏`;
                    } else if (isClear && isAfternoon && isVeryHighUV) {
                        comment = `üö® ${t} ‚Äî „ÄêÂç±Èô∫„ÄëÁåõÁÉà„Å™Êó•Â∑Æ„Åó„Å®È´òÊ∏©„ÄÇ10ÂàÜ„ÅßÊó•ÁÑº„Åë„ÉªÁÜ±‰∏≠Áóá„ÅÆ„É™„Çπ„ÇØ`;
                    } else if (isClear && isAfternoon) {
                        comment = `‚ö†Ô∏è ${t} ‚Äî „ÄêÁÜ±‰∏≠ÁóáÂç±Èô∫„ÄëÂçàÂæå„ÅÆ„Éî„Éº„ÇØ„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„ÄÅÊ∞¥ÂàÜ„ÅØ10ÂàÜ„Åä„Åç„Å´`;
                    } else if (isClear && isMorning) {
                        comment = `‚ö†Ô∏è ${t} ‚Äî „ÄêË≠¶Êàí„ÄëÊúù„Åã„ÇâÁåõÊöëÊó•Ë∂Ö„Åà„ÄÇ‰ªäÊó•„ÅØ‰∏çË¶Å‰∏çÊÄ•„ÅÆÂ§ñÂá∫„ÇíÊéß„Åà„Å¶`;
                    } else if (feelsHotter) {
                        comment = `üö® ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî „ÄêÂç±Èô∫„Äë‰ΩìÊÑüÊ∏©Â∫¶„ÅåÊõ¥„Å´È´ò„ÅÑ„ÄÇÂëΩ„Å´Èñ¢„Çè„ÇãÊöë„Åï`;
                    } else if (isEvening) {
                        comment = `‚ö†Ô∏è ${t} ‚Äî „ÄêÊ≥®ÊÑè„ÄëÂ§ïÊñπ„Åß„ÇÇÂç±Èô∫„Å™Êöë„Åï„ÄÇÂ§ú„ÇÇÁÜ±Â∏ØÂ§ú„ÅåÁ∂ö„Åç„Åæ„Åô`;
                    } else {
                        comment = `‚ö†Ô∏è ${t} ‚Äî „ÄêÁÜ±‰∏≠ÁóáÂç±Èô∫„ÄëÁåõÊöëÊó•„É¨„Éô„É´„ÄÇÊ∞¥ÂàÜ„ÉªÂ°©ÂàÜË£úÁµ¶„ÇíÊÄ†„Çâ„Å™„ÅÑ„Åß`;
                    }
                }
                // ALERT 34-36 (ÁÜ±‰∏≠ÁóáÊ≥®ÊÑè)
                else if (temp >= 34) {
                    if (isNight && isExtremelyHumid) {
                        comment = `‚ö†Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„ÄëËí∏„ÅóÊöë„Åô„Åé„ÇãÂ§ú„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Çí28¬∞CË®≠ÂÆö„Åß`;
                    } else if (isNight && isVeryHumid) {
                        comment = `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÁÜ±Â∏ØÂ§ú„ÄÇÂØùËã¶„Åó„ÅÑÂ§ú„ÄÇÊ∞¥ÂàÜ„ÇíÊûïÂÖÉ„Å´ÁΩÆ„ÅÑ„Å¶`;
                    } else if (isNight) {
                        comment = `üåô ${t} ‚Äî ÁÜ±Â∏ØÂ§ú„Åß„Åô„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅãÊâáÈ¢®Ê©ü„ÅßÂø´ÈÅ©„Å™Áù°Áú†Áí∞Â¢É„Çí`;
                    } else if (isExtremelyHumid && isAfternoon) {
                        comment = `‚ö†Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„ÄëÂç±Èô∫„Å™Ëí∏„ÅóÊöë„Åï„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`;
                    } else if (isExtremelyHumid) {
                        comment = `‚ö†Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„Äë‰∏çÂø´ÊåáÊï∞„ÅåÂç±Èô∫Âüü„ÄÇÂÜ∑Êàø„Çí‰Ωø„ÅÑ„Åæ„Åó„Çá„ÅÜ`;
                    } else if (isVeryHumid) {
                        comment = `üî• ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„ÄëËí∏„ÅóÊöë„ÅïË≠¶Êàí„ÄÇ„Åì„Åæ„ÇÅ„Å™‰ºëÊÜ©„Å®Ê∞¥ÂàÜ„Çí`;
                    } else if (isClear && isAfternoon && isVeryHighUV) {
                        comment = `üî• ${t} ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„ÄëÁåõÊöë+Âº∑„ÅÑUV„ÄÇÂ∏ΩÂ≠ê„ÉªÊó•ÂÇò„ÉªÊó•ÁÑº„ÅëÊ≠¢„ÇÅÂøÖÈ†à`;
                    } else if (isClear && isAfternoon) {
                        comment = `üî• ${t} ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„ÄëÂçàÂæå„ÅÆÁåõÊöë„ÄÇ15ÂàÜ„Åä„Åç„Å´Ê∞¥ÂàÜË£úÁµ¶„Çí`;
                    } else if (isClear && isMorning) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî Êúù„Åã„ÇâÁåõÊöë„Å´Ëøë„ÅÑÊöë„Åï„ÄÇÂ∏ΩÂ≠ê„ÉªÊ∞¥Á≠í„ÇíÂøò„Çå„Åö„Å´„ÄÇÂ≠ê„Å©„ÇÇ„ÅÆÁÜ±‰∏≠Áóá„Å´Ê≥®ÊÑè`;
                    } else if (feelsHotter) {
                        comment = `üî• ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî „ÄêÁÜ±‰∏≠ÁóáÊ≥®ÊÑè„Äë‰ΩìÊÑü„ÅØÁåõÊöëÊó•„É¨„Éô„É´`;
                    } else if (isEvening) {
                        comment = `üåá ${t} ‚Äî Â§ïÊñπ„Åß„ÇÇÁåõÊöë„Å´Ëøë„ÅÑÊöë„Åï„ÄÇÂ∏∞ÂÆÖÂæå„ÅØÊ∂º„Åó„ÅÑÈÉ®Â±ã„Åß‰ºëÊÅØ„Çí`;
                    } else if (isDry && isLightBreeze) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî „Ç´„É©„ÉÉ„Å®„Åó„ÅüÁåõÊöë„ÄÇÈ¢®„Åå„ÅÇ„Å£„Å¶„ÇÇÊ∞¥ÂàÜË£úÁµ¶„ÅØÂøò„Çå„Åö„Å´`;
                    } else {
                        comment = `üî• ${t} ‚Äî ÁåõÊöë„Å´Ëøë„ÅÑÊöë„Åï„ÄÇ„Åì„Åæ„ÇÅ„Å™Ê∞¥ÂàÜ„ÉªÂ°©ÂàÜË£úÁµ¶„ÅßÁÜ±‰∏≠Áóá‰∫àÈò≤„Çí`;
                    }
                }
                // HOT 32-34 (ÁúüÂ§èÊó•)
                else if (temp >= 32) {
                    if (isNight && isVeryHumid) {
                        comment = `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂØùËã¶„Åó„ÅÑÂ§ú„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅãÊâáÈ¢®Ê©ü„ÅßÂø´ÈÅ©„Å´`;
                    } else if (isNight) {
                        comment = `üåô ${t} ‚Äî Êöë„ÅÑÂ§ú„ÄÇÁÜ±‰∏≠Áóá‰∫àÈò≤„Å´„Ç®„Ç¢„Ç≥„É≥„ÅÆÊ¥ªÁî®„Çí`;
                    } else if (isExtremelyHumid) {
                        comment = `üò´ ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„Åè„Å¶‰∏çÂø´„ÄÇÂÜ∑Êàø„Åß‰ΩìË™øÁÆ°ÁêÜ„Çí`;
                    } else if (isVeryHumid && isAfternoon) {
                        comment = `üò´ ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂçàÂæå„ÅØÁâπ„Å´Ëí∏„ÅóÊöë„ÅÑ„ÄÇÁÑ°ÁêÜ„Åõ„Åö‰ºëÊÜ©„Çí`;
                    } else if (isVeryHumid) {
                        comment = `üò´ ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑ„ÄÇÊ±ó„Çí„Åã„ÅÑ„Åü„ÇâÂ°©ÂàÜ„ÇÇË£úÁµ¶„Çí`;
                    } else if (isClear && isVeryHighUV && !isNight) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„ÅåÁóõ„ÅÑÁúüÂ§èÊó•„ÄÇÊó•ÁÑº„Åë„Å´Ê≥®ÊÑè„ÄÇUVÂØæÁ≠ñÂøÖÈ†à`;
                    } else if (isClear && isHighUV && isDry && !isNight) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî „Ç´„É©„ÉÉ„Å®Êô¥„Çå„ÅüÁúüÂ§èÊó•„ÄÇ„Éó„Éº„É´„ÇÑÊµ∑Êó•ÂíåÔºÅÊ∞¥ÂàÜÂøò„Çå„Åö„Å´`;
                    } else if (isClear && isMorning) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî Êúù„Åã„ÇâÁúüÂ§èÊó•„ÄÇÊ¥óÊøØÁâ©„Åå„Çà„Åè‰πæ„Åç„Åæ„Åô„ÄÇÁÜ±‰∏≠ÁóáÂØæÁ≠ñ„ÇÇÂøò„Çå„Åö„Å´`;
                    } else if (isClear && isAfternoon) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÅÆÁúüÂ§èÊó•„ÄÇÂ§ñÂá∫„ÅØÊó•Èô∞„ÇíÈÅ∏„Çì„Åß„ÄÇÊ∞¥Á≠íÊåÅÂèÇ„Åß`;
                    } else if (isClear && isEvening) {
                        comment = `üåá ${t} ‚Äî Â§ïÊñπ„Åß„ÇÇ„Åæ„Å†Êöë„ÅÑ„ÄÇÂ§ïÊ∂º„Åø„Å´„ÅØ„Åæ„Å†Êó©„ÅÑ„Åã„ÇÇ`;
                    } else if (isOvercast) {
                        comment = `üåª ${t} ‚Äî Êõá„Å£„Å¶„ÅÑ„Å¶„ÇÇÁúüÂ§èÊó•„ÄÇÊ≤πÊñ≠„Åõ„ÅöÊ∞¥ÂàÜË£úÁµ¶„Çí`;
                    } else if (feelsColder && isLightBreeze && !isNight) {
                        comment = `‚òÄÔ∏è ${t} ‚Äî È¢®„Åå„ÅÇ„Å£„Å¶Â∞ë„ÅóÊ•Ω„ÄÇ„Åß„ÇÇÊ∞¥ÂàÜË£úÁµ¶„ÅØÂøò„Çå„Åö„Å´`;
                    } else {
                        comment = `üçß ${t} ‚Äî ÁúüÂ§èÊó•ÔºÅ„Ç¢„Ç§„Çπ„ÇÑ„Åã„ÅçÊ∞∑„ÅåÊúÄÈ´ò„ÅÆÂ≠£ÁØÄ`;
                    }
                }
                // WARM 28-32 (Â§èÊó•„ÄúÁúüÂ§èÊó•) - Expanded
                else if (temp >= 28) {
                    if (isNight && isVeryHumid) {
                        comment = pick([
                            `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÂ§ú„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅãÊâáÈ¢®Ê©ü„ÅßÂø´ÈÅ©„Å´`,
                            `üåô ${t} ‚Äî ÁÜ±Â∏ØÂ§ú„ÄÇÂÜ∑Êàø„Çí„Å§„Åë„Å¶ÂØù„Åæ„Åó„Çá„ÅÜ`,
                            `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂØùËã¶„Åó„ÅÑÂ§ú„ÄÇÊ∞¥„ÇíÊûïÂÖÉ„Å´`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî Êöë„ÅÑÂ§ú„ÄÇÁ™ì„ÇíÈñã„Åë„Çã„ÅãÂÜ∑Êàø„Çí„Å§„Åë„Å¶`,
                            `üåô ${t} ‚Äî ÁÜ±Â∏ØÂ§úÊ∞óÂë≥„ÄÇÊâáÈ¢®Ê©ü„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üåô ${t} ‚Äî Êöë„ÅÑÂ§ú„ÄÇÊ∞¥ÂàÜË£úÁµ¶„ÇíÂøò„Çå„Åö„Å´`
                        ]);
                    } else if (isClear && isDry && isHighUV && !isNight) {
                        comment = pick([
                            `‚ú® ${t} ‚Äî „Ç´„É©„ÉÉ„Å®Êô¥„Çå„Å¶Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÔºÅUVÂØæÁ≠ñ„ÇíÂøò„Çå„Åö„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Â§èÊó•„ÄÇÊó•ÁÑº„ÅëÊ≠¢„ÇÅ„ÇíÂøò„Çå„Åö„Å´`,
                            `‚ú® ${t} ‚Äî ‰πæÁá•„Åó„ÅüÂ§èÊó•„ÄÇÊ∞¥ÂàÜË£úÁµ¶„Çí`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Êúù„ÄÇÊ¥óÊøØÊó•Âíå„Åß„Åô`,
                            `‚òÄÔ∏è ${t} ‚Äî Êúù„Åã„Çâ„ÅÑ„ÅÑÂ§©Ê∞óÔºÅ‰ªäÊó•„ÅØÊöë„Åè„Å™„Çä„Åù„ÅÜ`,
                            `‚ú® ${t} ‚Äî Êöë„Åè„Å™„Çä„Åù„ÅÜ„Å™Êúù„ÄÇÂ∏ÉÂõ£„ÇíÂπ≤„Åô„ÉÅ„É£„É≥„Çπ`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êöë„Åè„Å™„Çä„Åù„ÅÜ„Å™Êúù„ÄÇÂ∏ΩÂ≠ê„ÇíÂøò„Çå„Åö„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî Êúù„Åã„ÇâÊöë„ÅÑ‰∫àÊÑü„ÄÇÊ∞¥Á≠í„ÇíÊåÅ„Å£„Å¶`,
                            `‚òÄÔ∏è ${t} ‚Äî „ÅÑ„ÅÑÂ§©Ê∞ó„ÅÆÊúù„ÄÇÊó•Â∑Æ„Åó„ÅåÂº∑„Åù„ÅÜ`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåá ${t} ‚Äî Êó•„ÅåÂÇæ„ÅÑ„Å¶„Åç„Åæ„Åó„Åü„ÄÇÂ§ïÊ∂º„Åø„Å´„ÅØÂ∞ë„ÅóÊó©„ÅÑ„Åã„ÇÇ`,
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„Åß„ÇÇ„Åæ„Å†Êöë„ÅÑ„ÄÇ„ÇÇ„ÅÜÂ∞ë„Åó„ÅßÊ∂º„Åó„Åè„Å™„Çã`,
                            `üåá ${t} ‚Äî Â§ïÊöÆ„ÇåÊôÇ„ÄÇÈ¢®„ÅåÂá∫„Å¶„Åç„Åü„Åã„ÇÇ`
                        ]);
                    } else if (isClear && isAfternoon && feelsHotter) {
                        comment = pick([
                            `‚òÄÔ∏è ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî ÊπøÂ∫¶„Åß‰ΩìÊÑü„ÅØ„ÇÇ„Å£„Å®Êöë„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÅÆ„Éî„Éº„ÇØ„ÄÇÊó•Èô∞„ÇíÈÅ∏„Çì„Åß`,
                            `‚òÄÔ∏è ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî Ê∞¥ÂàÜË£úÁµ¶„Çí„Åì„Åæ„ÇÅ„Å´`
                        ]);
                    } else if (isClear && isAfternoon) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Â§è„Çâ„Åó„ÅÑÈôΩÊ∞ó„ÄÇÂçäË¢ñ„Åß„Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÅÆÂ§èÊó•„ÄÇÂÜ∑„Åü„ÅÑÈ£≤„ÅøÁâ©„Çí`,
                            `‚òÄÔ∏è ${t} ‚Äî Êöë„ÅÑÂçàÂæå„ÄÇ„Éó„Éº„É´„Å´Ë°å„Åç„Åü„Åè„Å™„Çã`
                        ]);
                    } else if (isExtremelyHumid) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÔºÅÈô§ÊπøÂô®„Åã„Ç®„Ç¢„Ç≥„É≥„Çí`,
                            `üíß ${t} ‚Äî „Ç∏„É°„Ç∏„É°Ëí∏„ÅóÊöë„ÅÑ„ÄÇ‰∏çÂø´ÊåáÊï∞È´ò„ÇÅ`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÊπøÂ∫¶„ÅåÈ´ò„Åô„Åé„ÄÇ„Ç®„Ç¢„Ç≥„É≥Êé®Â•®`
                        ]);
                    } else if (isVeryHumid && isRainy) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ê¢ÖÈõ®„Çâ„Åó„ÅÑ„Ç∏„É°„Ç∏„É°„ÄÇ„Ç´„ÉìÂØæÁ≠ñ„Çí`,
                            `üíß ${t} ‚Äî Ê¢ÖÈõ®„ÅÆËí∏„ÅóÊöë„Åï„ÄÇÈô§ÊπøÂô®„ÅåÊ¥ªË∫ç`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Èõ®„ÅßËí∏„ÅóÊöë„ÅÑ„ÄÇÈ´™„Åå„Åæ„Å®„Åæ„Çâ„Å™„ÅÑ`
                        ]);
                    } else if (isVeryHumid && isAfternoon) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂçàÂæå„ÅØÁâπ„Å´Ëí∏„ÅóÊöë„ÅÑ„ÄÇÊ∞¥ÂàÜË£úÁµ¶„Çí`,
                            `üíß ${t} ‚Äî ÂçàÂæå„ÅÆËí∏„ÅóÊöë„Åï„Åå„Éî„Éº„ÇØ`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂçàÂæå„ÅØÊπøÂ∫¶„Åß„Åê„Å£„Åü„Çä`
                        ]);
                    } else if (isVeryHumid) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „Ç∏„É°„Ç∏„É°„ÄÇÊâáÈ¢®Ê©ü„ÇÑ„Ç®„Ç¢„Ç≥„É≥„ÅßÂø´ÈÅ©„Å´`,
                            `üíß ${t} ‚Äî Ëí∏„ÅóÊöë„ÅÑ„ÄÇÊ±ó„Çí„Åã„ÅÑ„Åü„ÇâÂ°©ÂàÜ„ÇÇ`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÊπøÂ∫¶„Åß„Åπ„Åü„Å§„Åè„ÄÇ„Ç∑„É£„ÉØ„Éº„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`
                        ]);
                    } else if (isPartlyCloudy && !isNight) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî ÊôÇ„ÄÖÈõ≤„Åå„Åã„Åã„Çä„Åæ„Åô„ÅåÊöë„ÅÑ„ÄÇÊ∞¥ÂàÜË£úÁµ¶„Çí`,
                            `‚õÖ ${t} ‚Äî ËñÑÊõá„Çä„Åß„ÇÇÊöë„ÅÑ„ÄÇÊ≤πÊñ≠„Åõ„Åö„Å´`,
                            `‚õÖ ${t} ‚Äî Èõ≤„Åå„ÅÇ„Å£„Å¶„ÇÇ„Åó„Å£„Åã„ÇäÊöë„ÅÑ`
                        ]);
                    } else if (isOvercast && feelsHotter) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„ÇÇËí∏„ÅóÊöë„ÅÑ„ÄÇÊπøÂ∫¶„ÅåÈ´ò„ÇÅ„Åß„Åô`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÊπøÂ∫¶„ÅåÈ´ò„ÅÑ„ÄÇ„Ç∏„É°„Ç∏„É°`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„ÇäÁ©∫„Åß„ÇÇ‰ΩìÊÑüÊ∏©Â∫¶„ÅØÈ´ò„ÇÅ`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Å£„Å¶„ÅÑ„Åæ„Åô„ÅåËí∏„ÅóÊöë„ÅÑ„ÄÇÈ¢®„Åå„ÅÇ„Çã„Å®Ê•Ω`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„ÇÇÂ§èÊó•„ÄÇÊ∞¥ÂàÜ„ÇíÂøò„Çå„Åö„Å´`,
                            `‚òÅÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„ÅØ„Å™„Åè„Å¶„ÇÇÊöë„ÅÑ`
                        ]);
                    } else if (isLightBreeze && !isNight) {
                        comment = pick([
                            `üå¥ ${t} ‚Äî Â§èÊó•„ÄÇÈ¢®„Åå„ÅÇ„Å£„Å¶Â∞ë„ÅóÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `üå¥ ${t} ‚Äî È¢®„ÅåÂøÉÂú∞„Çà„ÅÑÂ§èÊó•`,
                            `üå¥ ${t} ‚Äî È¢®„Åå„ÅÇ„Çã„Å®‰ΩìÊÑüÊ∏©Â∫¶„Åå‰∏ã„Åå„Çã`
                        ]);
                    } else {
                        comment = pick([
                            `üå¥ ${t} ‚Äî Â§èÊó•„Åß„Åô„ÄÇÂÜ∑„Åü„ÅÑÈ£≤„ÅøÁâ©„ÅåÁæéÂë≥„Åó„ÅÑ`,
                            `üçπ ${t} ‚Äî Êöë„ÅÑÔºÅÂÜ∑„Åü„ÅÑ„ÇÇ„ÅÆ„ÅåÊ¨≤„Åó„Åè„Å™„Çã`,
                            `üå¥ ${t} ‚Äî Â§è„Çâ„Åó„ÅÑÊöë„Åï„ÄÇÊ∞¥ÂàÜË£úÁµ¶„Çí`
                        ]);
                    }
                }
                // WARM 25-28 (Â§èÊó•) - Expanded
                else if (temp >= 25) {
                    if (isNight && isVeryHumid) {
                        comment = pick([
                            `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÂ§ú„ÄÇÊâáÈ¢®Ê©ü„Åã„Ç®„Ç¢„Ç≥„É≥„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üåô ${t} ‚Äî ÁÜ±Â∏ØÂ§úÊ∞óÂë≥„ÄÇÁ™ì„ÇíÈñã„Åë„Å¶È¢®„ÇíÈÄö„Åó„Å¶`,
                            `üåô ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „Ç∏„É°„Ç∏„É°„Åó„ÅüÂ§ú„ÄÇÈô§Êπø„Åô„Çã„Å®Âø´ÈÅ©`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî Êöñ„Åã„ÅÑÂ§ú„ÄÇÁ™ì„ÇíÈñã„Åë„Å¶ÂØù„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ„Åã„ÇÇ`,
                            `üåô ${t} ‚Äî ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÂ§ú„ÄÇÁ™ì„ÇíÈñã„Åë„Å¶Â§úÈ¢®„Çí`,
                            `üåô ${t} ‚Äî Êöñ„Åã„ÅÑÂ§ú„ÄÇËô´„ÅÆÂ£∞„ÅåËÅû„Åì„Åà„Åù„ÅÜ`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `‚ú® ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÊúùÔºÅÁµ∂Â•Ω„ÅÆ„ÅäÂá∫„Åã„ÅëÊó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî Êöë„ÅÑÊúù„ÄÇÊ¥óÊøØÁâ©„Åå„Åô„Åê‰πæ„Åç„Åæ„Åô`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊúùÔºÅ‰ªäÊó•„ÅØÊ¥ªÂãïÁöÑ„Å´`
                        ]);
                    } else if (isClear && isDry && isAfternoon) {
                        comment = pick([
                            `‚ú® ${t} ‚Äî „Ç´„É©„ÉÉ„Å®ÁàΩ„ÇÑ„Åã„Å™Êô¥„ÇåÔºÅÊúÄÈ´ò„ÅÆ„ÅäÂá∫„Åã„ÅëÊó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÅÆÂ§èÊó•„ÄÇÂ§ñ„Å´Âá∫„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `‚ú® ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇ„Ç´„Éï„Çß„ÅÆ„ÉÜ„É©„ÇπÂ∏≠„Åå„Åä„Åô„Åô„ÇÅ`
                        ]);
                    } else if (isClear && isDry && !isNight) {
                        comment = pick([
                            `‚ú® ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÈôΩÊ∞ó„ÄÇÊ¥óÊøØÁâ©„Åå„Çà„Åè‰πæ„Åç„Åæ„Åô`,
                            `‚òÄÔ∏è ${t} ‚Äî „Ç´„É©„ÉÉ„Å®„Åó„ÅüÂ§èÊó•„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `‚ú® ${t} ‚Äî È¢®„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ1Êó•„Å´„Å™„Çä„Åù„ÅÜ`
                        ]);
                    } else if (isClear && isHighUV && !isNight) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„Åü„Å£„Å∑„Çä„ÄÇUV„Ç±„Ç¢„ÇíÂøò„Çå„Åö„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî Á¥´Â§ñÁ∑ö„ÅåÂº∑„ÇÅ„ÄÇÂ∏ΩÂ≠ê„ÇÑÊó•ÁÑº„ÅëÊ≠¢„ÇÅ„Çí`,
                            `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„ÅåÂº∑„ÅÑ„ÄÇ„Çµ„É≥„Ç∞„É©„Çπ„Åå„ÅÇ„Çã„Å®Ê•Ω`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåá ${t} ‚Äî Â§ïÊñπ„ÅÆÂøÉÂú∞„Çà„ÅÑÈ¢®„ÄÇÊï£Ê≠©„Å´„Å¥„Å£„Åü„Çä`,
                            `üåÜ ${t} ‚Äî Â§ïÊöÆ„ÇåÊôÇ„ÅÆÊ∞óÊåÅ„Å°„Çà„Åï„ÄÇ„ÅäÊï£Ê≠©Êó•Âíå`,
                            `üåá ${t} ‚Äî Â§ïÊ∂º„Åø„Å´„Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑÊ∞óÊ∏©`
                        ]);
                    } else if (isClear && !isNight) {
                        comment = pick([
                            `üòä ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÆ„ÅÑ„ÅÑÊô¥„Çå„ÄÇÂçäË¢ñ„Åß„Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî Â§èÊó•ÔºÅÂ§ñ„Å´Âá∫„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üòä ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Â§èÊó•„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`
                        ]);
                    } else if (isExtremelyHumid) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „Ç∏„É°„Ç∏„É°Êõá„ÇäÁ©∫„ÄÇÊâáÈ¢®Ê©ü„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üíß ${t} ‚Äî ÊπøÂ∫¶„ÅåÈ´ò„Åè„Å¶Ëí∏„ÅóÊöë„ÅÑ„ÄÇÈô§Êπø„Çí`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî „É†„Ç∑„É†„Ç∑„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅÆÈô§Êπø„É¢„Éº„Éâ„Çí`
                        ]);
                    } else if (isVeryHumid && isAfternoon) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÂçàÂæå„ÅØËí∏„ÅóÊöë„ÅÑ„ÄÇÂÜ∑„Åü„ÅÑÈ£≤„ÅøÁâ©„Çí`,
                            `üíß ${t} ‚Äî ÂçàÂæå„ÅØÊπøÂ∫¶„Åß‰∏çÂø´„ÄÇÊ∂º„Åó„ÅÑÂ†¥ÊâÄ„Å∏`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÂçàÂæå„ÄÇ„Ç¢„Ç§„Çπ„Ç≥„Éº„Éí„Éº„ÅåÁæéÂë≥„Åó„ÅÑ`
                        ]);
                    } else if (isVeryHumid) {
                        comment = pick([
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ëí∏„ÅóÊöë„ÅÑÊõá„ÇäÁ©∫„ÄÇÊâáÈ¢®Ê©ü„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üíß ${t} ‚Äî „Ç∏„É°„Ç∏„É°„ÄÇÈô§ÊπøÂô®„Åå„ÅÇ„Çã„Å®Ê•Ω`,
                            `üíß ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÊπøÂ∫¶È´ò„ÇÅ„ÄÇÈ´™„Åå„Åæ„Å®„Åæ„Çâ„Å™„ÅÑÂ≠£ÁØÄ`
                        ]);
                    } else if (isPartlyCloudy && isSpring && !isNight) {
                        comment = pick([
                            `üå∏ ${t} ‚Äî Êò•„Çâ„Åó„ÅÑÈôΩÊ∞ó„ÄÇ„ÅäËä±Ë¶ã„Å´„Å¥„Å£„Åü„Çä`,
                            `üå∏ ${t} ‚Äî Êò•„ÅÆÊöñ„Åã„Åï„ÄÇÊ°ú„ÅØË¶ãÈ†É„Åã„ÇÇ`,
                            `üå∏ ${t} ‚Äî Êò•ÁàõÊº´„ÄÇÂ§ñ„Åß„É©„É≥„ÉÅ„Åå„Åó„Åü„Åè„Å™„Çã`
                        ]);
                    } else if (isPartlyCloudy && !isNight) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî ËñÑÊõá„Çä„Åß„Åô„ÅåÊöñ„Åã„ÅÑ„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `‚õÖ ${t} ‚Äî ÊôÇ„ÄÖÊó•„ÅåÂ∑Æ„Åô„ÄÇ„Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑÊ∞óÊ∏©`,
                            `‚õÖ ${t} ‚Äî Êöñ„Åã„ÅÑÊõá„ÇäÁ©∫„ÄÇÊ∂º„Åó„Åè„ÇÇÊöë„Åè„ÇÇ„Å™„ÅÑ`
                        ]);
                    } else if (isOvercast && isLightBreeze) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„Åô„ÅåÈ¢®„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî È¢®„Åå„ÅÇ„Å£„Å¶ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„ÇÇ„Ç´„É©„ÉÉ„Å®„Åó„Å¶Âø´ÈÅ©`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî Êõá„Çä„Åß„Åô„ÅåÊöñ„Åã„ÅÑ„ÄÇËñÑÁùÄ„ÅßÈÅé„Åî„Åõ„Åæ„Åô`,
                            `‚òÅÔ∏è ${t} ‚Äî Êöñ„Åã„ÅÑÊõá„ÇäÁ©∫„ÄÇÊó•ÁÑº„Åë„Åó„Å™„Åè„Å¶„É©„ÉÉ„Ç≠„Éº`,
                            `‚õÖ ${t} ‚Äî „Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑÊ∞óÊ∏©„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`
                        ]);
                    } else {
                        comment = pick([
                            `üåø ${t} ‚Äî ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÊ∞óÊ∏©„ÄÇÁ™ì„ÇíÈñã„Åë„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üòä ${t} ‚Äî „Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑÂ§èÊó•„ÄÇÂø´ÈÅ©„Å´ÈÅé„Åî„Åõ„Åæ„Åô`,
                            `üåø ${t} ‚Äî „ÅÑ„ÅÑÊ∞óÊ∏©„ÄÇ„Ç®„Ç¢„Ç≥„É≥„Å™„Åó„Åß„ÇÇÂø´ÈÅ©`
                        ]);
                    }
                }
                // COMFORTABLE 22-25 (Âø´ÈÅ©) - 6 variations each
                else if (temp >= 22) {
                    if (isNight && isCalm) {
                        comment = pick([
                            `üåô ${t} ‚Äî Èùô„Åã„ÅßÁ©è„ÇÑ„Åã„Å™Â§ú„ÄÇ„Çà„ÅèÁú†„Çå„Åù„ÅÜ`,
                            `üåô ${t} ‚Äî Á™ì„ÇíÈñã„Åë„Å¶ÂØù„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÂ§ú`,
                            `üåô ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÂ§úÈ¢®„ÄÇ„É™„É©„ÉÉ„ÇØ„Çπ„Çø„Ç§„É†`,
                            `üåô ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Â§ú„ÄÇË™≠Êõ∏„Åß„ÇÇ„ÅÑ„Åã„Åå`,
                            `üåô ${t} ‚Äî Ëô´„ÅÆÂ£∞„ÅåÂøÉÂú∞„Çà„ÅÑÂ§ú`,
                            `üåô ${t} ‚Äî „ÇÜ„Å£„Åü„Çä„Å®„Åó„ÅüÂ§ú„ÅÆ„Å≤„Å®„Å®„Åç`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Â§ú„ÄÇ„É™„É©„ÉÉ„ÇØ„Çπ„Çø„Ç§„É†„Å´ÊúÄÈÅ©`,
                            `üåô ${t} ‚Äî „ÇÜ„Å£„Åü„Çä„Åó„ÅüÂ§ú„ÄÇË™≠Êõ∏„Åß„ÇÇ„ÅÑ„Åã„Åå`,
                            `üåô ${t} ‚Äî ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÂ§ú„Åß„Åô`,
                            `üåô ${t} ‚Äî Èùô„Åã„Å™Â§ú„ÇíÊ•Ω„Åó„Çì„Åß`,
                            `üåô ${t} ‚Äî „Åä„ÅÜ„Å°ÊôÇÈñì„Å´„Å¥„Å£„Åü„Çä„ÅÆÂ§ú`,
                            `üåô ${t} ‚Äî ÂøÉ„ÅåËêΩ„Å°ÁùÄ„ÅèÂ§ú„Åß„Åô„Å≠`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Êúù„ÄÇÊï£Ê≠©„ÇÑ„Ç∏„Éß„ÇÆ„É≥„Ç∞„Å´ÊúÄÈÅ©`,
                            `‚òÄÔ∏è ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊúùÔºÅ1Êó•„ÅÆ„Çπ„Çø„Éº„Éà„Å´ÊúÄÈ´ò`,
                            `‚ú® ${t} ‚Äî Êúù„ÅÆÁ©∫Ê∞ó„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ„ÄÇÊ∑±ÂëºÂê∏„Åó„Åü„Åè„Å™„Çã`,
                            `üåÖ ${t} ‚Äî Ê∏Ö„ÄÖ„Åó„ÅÑÊúù„ÄÇ‰ªäÊó•„ÅØËâØ„ÅÑÊó•„Å´„Å™„Çä„Åù„ÅÜ`,
                            `üçÄ ${t} ‚Äî Êúù„Åã„ÇâÁàΩ„ÇÑ„ÅãÔºÅÊ¥ªÂãïÁöÑ„Å™1Êó•„Çí`,
                            `‚òÄÔ∏è ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊúù„ÄÇ‰Ωï„ÅãÂßã„ÇÅ„Åü„Åè„Å™„Çã`
                        ]);
                    } else if (isClear && isDry && isAfternoon) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇ„Ç´„Éï„Çß„ÉÜ„É©„ÇπÊó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇÂÖ¨Âúí„Åß„ÅÆ„Çì„Å≥„Çä„ÇÇËâØ„ÅÑ`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÂçàÂæå„ÄÇÁ™ìËæ∫„ÅßË™≠Êõ∏„Åß„ÇÇ`,
                            `üåø ${t} ‚Äî Êú®Êºè„ÇåÊó•„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑÂçàÂæå`,
                            `üçÄ ${t} ‚Äî ÂçàÂæå„ÅÆ„ÉÜ„Ç£„Éº„Çø„Ç§„É†„Å´„Å¥„Å£„Åü„Çä`,
                            `‚òÄÔ∏è ${t} ‚Äî „ÅÆ„Çì„Å≥„ÇäÈÅé„Åî„Åó„Åü„Åè„Å™„ÇãÂçàÂæå`
                        ]);
                    } else if (isClear && isDry && !isNight) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„ÅßÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÈôΩÊ∞ó„ÄÇÊï£Ê≠©„Å´ÊúÄÈÅ©`,
                            `‚òÄÔ∏è ${t} ‚Äî „Ç´„É©„ÉÉ„Å®Êô¥„Çå„Å¶ÊúÄÈ´ò„ÅÆÂ§©Ê∞ó`,
                            `‚ú® ${t} ‚Äî Áµ∂Â•Ω„ÅÆË°åÊ•ΩÊó•Âíå„Åß„Åô`,
                            `üåø ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÈôΩÊ∞ó„ÄÇÂ§ñ„Å´Âá∫„Åü„Åè„Å™„Çã`,
                            `üçÄ ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÆ„ÅÑ„ÅÑÊô¥„Çå„ÄÇÊ∑±ÂëºÂê∏Êó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî ÊúÄÈ´ò„ÅÆ„ÅäÂá∫„Åã„ÅëÊó•Âíå„Åß„Åô„Å≠`
                        ]);
                    } else if (isClear && isSpring && !isNight) {
                        comment = pick([
                            `üå∑ ${t} ‚Äî Êò•„ÅÆÈôΩÊ∞ó„ÄÇÊñ∞Á∑ë„ÅåÁú©„Åó„ÅÑ`,
                            `üå∏ ${t} ‚Äî Êò•„Çâ„Çì„Åæ„Çì„ÄÇ„ÅäÂá∫„Åã„ÅëÊó•Âíå`,
                            `üçÄ ${t} ‚Äî Êò•„ÅÆÁàΩ„ÇÑ„Åã„Åï„ÄÇÂ§ñ„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üå∑ ${t} ‚Äî Êò•„ÅÆÈ¢®„ÅåÂøÉÂú∞„Çà„ÅÑ`,
                            `üå∏ ${t} ‚Äî Êò•„ÇíÊÑü„Åò„ÇãÈôΩÊ∞ó„Åß„Åô„Å≠`,
                            `üçÄ ${t} ‚Äî Êñ∞Á∑ë„ÅåÁæé„Åó„ÅÑÂ≠£ÁØÄ`
                        ]);
                    } else if (isClear && isAutumn && !isNight) {
                        comment = pick([
                            `üçÅ ${t} ‚Äî ÁßãÊô¥„Çå„ÅÆÂøÉÂú∞„Çà„Åï„ÄÇÁ¥ÖËëâÁã©„Çä„Å´„ÅÑ„ÅÑÂ≠£ÁØÄ`,
                            `üçÇ ${t} ‚Äî Áßã„ÅÆÊæÑ„Çì„Å†Á©∫Ê∞ó„ÄÇ„ÅäÊï£Ê≠©Êó•Âíå`,
                            `‚ú® ${t} ‚Äî Áßã„ÅÆË°åÊ•ΩÊó•Âíå„ÄÇ„Å©„Åì„Åã„Å∏Âá∫„Åã„Åë„Åü„Åè„Å™„Çã`,
                            `üçÅ ${t} ‚Äî Áßã„Çâ„Åó„ÅÑÁàΩ„ÇÑ„Åã„Åï„ÄÇÁ¥ÖËëâ„ÅåË¶ãÈ†É„Åã„ÇÇ`,
                            `üçÇ ${t} ‚Äî ÁßãÈ¢®„ÅåÂøÉÂú∞„Çà„ÅÑ„ÄÇ„Çµ„Ç§„ÇØ„É™„É≥„Ç∞Êó•Âíå`,
                            `‚ú® ${t} ‚Äî Áßã„ÅÆÁ©∫„ÅåÁ∂∫È∫ó„Å™Êó•`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåá ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÂ§ïÊñπ„ÄÇÊï£Ê≠©Êó•Âíå`,
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„ÅÆÈ¢®„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üåá ${t} ‚Äî Â§ïÊöÆ„ÇåÊôÇ„ÅÆ„ÅäÊï£Ê≠©„Å´„Å¥„Å£„Åü„Çä`,
                            `üåÜ ${t} ‚Äî Â§ïÁÑº„Åë„ÅåÁ∂∫È∫ó„Åù„ÅÜ„Å™Â§ïÊñπ`,
                            `üåá ${t} ‚Äî Ê∂º„Åó„Åè„Å™„Å£„Å¶„Åç„Åü„ÄÇÊï£Ê≠©„Å´„ÅÑ„ÅÑ`,
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„ÅÆ„Å≤„Å®„Å®„Åç„ÇíÊ•Ω„Åó„Çì„Åß`
                        ]);
                    } else if (isClear && !isNight) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Êô¥„Çå„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ‰∏ÄÊó•„Å´`,
                            `üòä ${t} ‚Äî „ÅÑ„ÅÑÂ§©Ê∞óÔºÅ‰Ωï„Åã„ÅÑ„ÅÑ„Åì„Å®„ÅÇ„Çä„Åù„ÅÜ`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÆ„ÅÑ„ÅÑÈôΩÊ∞ó„Åß„Åô„Å≠`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ„ÄÇËâØ„ÅÑ‰∏ÄÊó•„Çí`,
                            `üòä ${t} ‚Äî Á©è„ÇÑ„Åã„Å™ÈôΩÊ∞ó„ÄÇ„ÅÆ„Çì„Å≥„Çä„Åó„Åü„ÅÑ`,
                            `‚ú® ${t} ‚Äî ‰ªäÊó•„ÅØÂ§ñ„Å´Âá∫„Åü„Åè„Å™„ÇãÂ§©Ê∞ó`
                        ]);
                    } else if (isVeryHumid && pp >= 40) {
                        comment = `üåßÔ∏è ${t} ‚Äî ÊπøÊ∞ó„ÅåÂ§ö„ÇÅ„ÄÇ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®„ÅåÈôç„Çä„Åù„ÅÜ`;
                    } else if (isVeryHumid) {
                        comment = `üíß ${t} ‚Äî ÊπøÊ∞ó„ÅåÈ´ò„ÇÅ„ÄÇËí∏„ÅóËí∏„Åó„Åó„Åæ„Åô`;
                    } else if (isPartlyCloudy && isLightBreeze && !isNight) {
                        comment = `‚õÖ ${t} ‚Äî È¢®„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÂ§©Ê∞ó`;
                    } else if (isPartlyCloudy && !isNight) {
                        comment = `‚õÖ ${t} ‚Äî ËñÑÊõá„Çä„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÊ∞óÊ∏©„Åß„Åô`;
                    } else if (isOvercast) {
                        comment = `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„Åô„ÅåÂø´ÈÅ©„Å™Ê∞óÊ∏©`;
                    } else {
                        comment = pick([
                            `‚òï ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Ê∞óÊ∏©„ÄÇ„Ç≥„Éº„Éí„Éº„Åß„ÇÇ„ÅÑ„Åã„ÅåÔºü`,
                            `üçµ ${t} ‚Äî „ÇÜ„Å£„Åü„Çä„Åó„ÅüÊôÇÈñì„ÇíÈÅé„Åî„Åõ„Åù„ÅÜ`,
                            `‚òï ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÊ∞óÊ∏©„ÄÇ„ÅÆ„Çì„Å≥„ÇäÈÅé„Åî„Åó„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    }
                }
                // COMFORTABLE 18-22 (ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ) - 1.5x variations
                else if (temp >= 18) {
                    if (isNight && isCalm) {
                        comment = pick([
                            `üåô ${t} ‚Äî Èùô„Åã„ÅßÂøÉÂú∞„Çà„ÅÑÂ§ú„ÄÇÁ™ì„ÇíÈñã„Åë„Çã„Å®Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üåô ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Â§úÈ¢®„ÄÇ„É™„É©„ÉÉ„ÇØ„Çπ„Çø„Ç§„É†`,
                            `üåô ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÂ§ú„ÄÇ„ÇÜ„Å£„Åè„Çä‰ºë„ÇÅ„Åù„ÅÜ`,
                            `üåô ${t} ‚Äî ÈùôÂØÇ„ÅÆÂ§ú„ÄÇË™≠Êõ∏„Å´„Å¥„Å£„Åü„Çä`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Â§ú„ÄÇ„Çà„ÅèÁú†„Çå„Åù„ÅÜ`,
                            `üåô ${t} ‚Äî Âø´ÈÅ©„Å™Â§ú„ÄÇ„Åä„ÅÜ„Å°ÊôÇÈñì„ÇíÊ•Ω„Åó„Çì„Åß`,
                            `üåô ${t} ‚Äî ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÂ§ú„Åß„Åô„Å≠`,
                            `üåô ${t} ‚Äî ÂøÉËêΩ„Å°ÁùÄ„ÅèÂ§ú„ÄÇ„ÇÜ„Å£„Åè„Çä„Å®`
                        ]);
                    } else if (isClear && isDry && isAutumn && !isNight) {
                        comment = pick([
                            `üçÇ ${t} ‚Äî ÁßãÊô¥„Çå„ÅÆÁàΩ„ÇÑ„Åã„Åï„ÄÇË™≠Êõ∏Êó•Âíå„Åß„Åô„Å≠`,
                            `üçÅ ${t} ‚Äî Áßã„ÅÆÁ©∫„ÅåÁ∂∫È∫ó„ÄÇÊï£Ê≠©„Å´„Å¥„Å£„Åü„Çä`,
                            `üçÇ ${t} ‚Äî Áßã„Çâ„Åó„ÅÑÂøÉÂú∞„Çà„Åï„ÄÇÂ§ñ„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üçÅ ${t} ‚Äî Áßã„ÅÆÁàΩ„ÇÑ„Åã„Å™Á©∫Ê∞ó„ÇíÊ•Ω„Åó„Çì„Åß`
                        ]);
                    } else if (isClear && isDry && isMorning && isExcellentVisibility) {
                        // Ë¶ñÁ®ã50km‰ª•‰∏ä„ÅÆÊô¥„Çå„ÅüÊúù - ÂØåÂ£´Â±±„ÅåË¶ã„Åà„ÇãÂèØËÉΩÊÄß
                        comment = pick([
                            `üóª ${t} ‚Äî Á©∫Ê∞ó„ÅåÊæÑ„Çì„Åß„ÅÑ„Åæ„ÅôÔºÅÈÅ†„Åè„ÅÆÂ±±„ÅåË¶ã„Åà„Çã„Åã„ÇÇ`,
                            `‚ú® ${t} ‚Äî Ë¶ñÁïåËâØÂ•ΩÔºÅÊù°‰ª∂Ê¨°Á¨¨„ÅßÂØåÂ£´Â±±„ÅåË¶ã„Åà„Çã„Åã„ÇÇ`,
                            `üóª ${t} ‚Äî ÊæÑ„ÅøÂàá„Å£„ÅüÊúù„ÄÇÈÅ†„Åè„Åæ„ÅßË¶ãÊ∏°„Åõ„ÇãÁµ∂Â•Ω„ÅÆÊó•`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî Ê∏Ö„ÄÖ„Åó„ÅÑÊúù„ÄÇ„Ç¶„Ç©„Éº„Ç≠„É≥„Ç∞Êó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÊúùÔºÅ1Êó•„ÅÆ„Çπ„Çø„Éº„Éà„Å´„Å¥„Å£„Åü„Çä`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊúù„ÄÇÊ∑±ÂëºÂê∏„Åó„Åü„Åè„Å™„Çã`,
                            `üçÄ ${t} ‚Äî Êúù„ÅÆÁ©∫Ê∞ó„ÅåÊúÄÈ´ò„ÄÇÊ¥ªÂãïÁöÑ„Å´ÈÅé„Åî„Åõ„Åù„ÅÜ`
                        ]);
                    } else if (isClear && isDry && isAfternoon) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇ„ÉÜ„É©„ÇπÂ∏≠„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇÂ§ñ„Åß„ÅÆ„Çì„Å≥„Çä„ÇÇ`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÂçàÂæå„ÄÇ„Ç´„Éï„ÇßÊó•Âíå`,
                            `üçÄ ${t} ‚Äî ÂçàÂæå„ÅÆÈôΩÊ∞ó„ÇíÊ•Ω„Åó„Çì„Åß`
                        ]);
                    } else if (isClear && isDry && !isNight) {
                        comment = pick([
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™ÈôΩÊ∞ó„ÄÇ‰∏äÁùÄ„Å™„Åó„Åß„ÇÇÂø´ÈÅ©`,
                            `‚òÄÔ∏è ${t} ‚Äî „Ç´„É©„ÉÉ„Å®Êô¥„Çå„Å¶Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `‚ú® ${t} ‚Äî Áµ∂Â•Ω„ÅÆ„ÅäÂá∫„Åã„ÅëÊó•Âíå`,
                            `üçÄ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™1Êó•„Å´„Å™„Çä„Åù„ÅÜ`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊúù„ÄÇÊó•‰∏≠„ÅØÊöñ„Åã„Åè„Å™„Çä„Åù„ÅÜ`,
                            `üåÖ ${t} ‚Äî ÊúùÊó•„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ„ÄÇËâØ„ÅÑ1Êó•„Çí`,
                            `‚òÄÔ∏è ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Êúù„ÄÇ‰ªäÊó•„ÇÇÈ†ëÂºµ„Çå„Åù„ÅÜ`,
                            `üåÖ ${t} ‚Äî Ê∏Ö„ÄÖ„Åó„ÅÑÊúù„ÄÇ‰Ωï„ÅãÂßã„ÇÅ„Åü„Åè„Å™„Çã`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåá ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÂ§ïÊñπ„ÄÇÊï£Ê≠©„Å´„ÅÑ„ÅÑÊ∞óÂÄô`,
                            `üåÜ ${t} ‚Äî Â§ïÊöÆ„ÇåÊôÇ„ÅÆÈ¢®„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`,
                            `üåá ${t} ‚Äî Â§ïÊñπ„ÅÆÊï£Ê≠©„Å´„Å¥„Å£„Åü„Çä`,
                            `üåÜ ${t} ‚Äî Â§ïÊó•„ÅåÁ∂∫È∫ó„Å™ÊôÇÈñìÂ∏Ø`
                        ]);
                    } else if (isClear && !isNight) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Êô¥„Çå„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ‰∏ÄÊó•„Å´`,
                            `üòä ${t} ‚Äî „ÅÑ„ÅÑÂ§©Ê∞óÔºÅÊ∞óÂàÜ„ÇÇ‰∏ä„Åå„Çã`,
                            `‚ú® ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÆ„ÅÑ„ÅÑÈôΩÊ∞ó„Åß„Åô„Å≠`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶Ê∞óÊåÅ„Å°„ÅÑ„ÅÑ„ÄÇËâØ„ÅÑ‰∏ÄÊó•„Çí`
                        ]);
                    } else if (isExtremelyDry) {
                        comment = pick([
                            `üí® ${t} ‚Äî ‰πæÁá•Ê≥®ÊÑèÔºÅÂä†ÊπøÂô®„ÇÑ„Éè„É≥„Éâ„ÇØ„É™„Éº„É†„Çí`,
                            `üí® ${t} ‚Äî Á©∫Ê∞ó„Åå„Ç´„É©„Ç´„É©„ÄÇ‰øùÊπø„ÇíÂøò„Çå„Åö„Å´`,
                            `üí® ${t} ‚Äî ‰πæÁá•„ÅßÈ¢®ÈÇ™„Çí„Å≤„Åç„ÇÑ„Åô„ÅÑ„ÄÇÂØæÁ≠ñ„Çí`
                        ]);
                    } else if (isVeryDry) {
                        comment = pick([
                            `üí® ${t} ‚Äî ‰πæÁá•„Åó„ÅüÁ©∫Ê∞ó„ÄÇ„ÅÆ„Å©È£¥„Å®‰øùÊπø„ÇíÂøò„Çå„Åö„Å´`,
                            `üí® ${t} ‚Äî ‰πæÁá•Ê∞óÂë≥„ÄÇ„Åì„Åæ„ÇÅ„Å´Ê∞¥ÂàÜ„Çí`,
                            `üí® ${t} ‚Äî Á©∫Ê∞ó„Åå‰πæ„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇ‰øùÊπø„Çí`
                        ]);
                    } else if (isVeryHumid && pp >= 40) {
                        comment = pick([
                            `üåßÔ∏è ${t} ‚Äî ÊπøÊ∞ó„ÅåÈ´ò„ÅÑ„ÄÇ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®„ÅåÈôç„Çä„Åù„ÅÜ`,
                            `üåßÔ∏è ${t} ‚Äî Ëí∏„ÅóËí∏„Åó„Åô„Çã„ÄÇÈõ®„ÅåËøë„ÅÑ„Åã„ÇÇ`,
                            `üåßÔ∏è ${t} ‚Äî ÊπøÊ∞óÂ§ö„ÇÅ„ÄÇÂÇò„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`
                        ]);
                    } else if (isVeryHumid) {
                        comment = pick([
                            `üíß ${t} ‚Äî ÊπøÊ∞ó„ÅåÈ´ò„ÇÅ„ÄÇÈô§Êπø„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üíß ${t} ‚Äî Ëí∏„ÅóËí∏„Åó„Åó„Åæ„Åô„ÄÇ„Ç®„Ç¢„Ç≥„É≥„ÅÆÈô§Êπø„É¢„Éº„Éâ„Çí`,
                            `üíß ${t} ‚Äî ÊπøÊ∞óÂ§ö„ÇÅ„ÄÇÈ´™„Åå„Åæ„Å®„Åæ„Çâ„Å™„ÅÑÂ≠£ÁØÄ`
                        ]);
                    } else if (isOvercast && isSpring && !isNight) {
                        comment = pick([
                            `üå∏ ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Êò•Êõá„Çä„ÄÇËä±Á≤â„ÅåÊ∞ó„Å´„Å™„ÇãÂ≠£ÁØÄ`,
                            `üå∑ ${t} ‚Äî Êò•„Çâ„Åó„ÅÑÊõá„ÇäÁ©∫„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÊ∞óÊ∏©`,
                            `üå∏ ${t} ‚Äî Êò•„ÅÆÊõá„Çä„ÄÇËä±Á≤âÂØæÁ≠ñ„ÇíÂøò„Çå„Åö„Å´`
                        ]);
                    } else if (isOvercast && isLightBreeze) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„Åô„ÅåÈ¢®„ÅåÂøÉÂú∞„ÅÑ„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„ÇäÁ©∫„Åß„ÇÇÈ¢®„Åå„ÅÇ„Å£„Å¶Âø´ÈÅ©`,
                            `‚òÅÔ∏è ${t} ‚Äî È¢®„Åå„Åù„Çà„ÅÑ„ÅßÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„ÇäÁ©∫„Åß„Åô„ÅåÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„Åß„ÇÇÂø´ÈÅ©„Å™Ê∞óÊ∏©`,
                            `‚òÅÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Êõá„Çä„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ„Åß„Åô`
                        ]);
                    } else if (isPartlyCloudy && !isNight) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî ËñÑÊõá„Çä„ÅßÂøÉÂú∞„Çà„ÅÑÊ∞óÊ∏©`,
                            `‚õÖ ${t} ‚Äî Èõ≤„Åå„ÅÇ„Å£„Å¶„ÇÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑ`,
                            `‚õÖ ${t} ‚Äî „Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑÂ§©Ê∞ó`
                        ]);
                    } else {
                        comment = pick([
                            `‚òï ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Ê∞óÊ∏©„ÄÇ„ÇÜ„Å£„Åü„ÇäÈÅé„Åî„Åó„Åæ„Åó„Çá„ÅÜ`,
                            `üçµ ${t} ‚Äî ÂøÉÂú∞„Çà„ÅÑÊ∞óÊ∏©„ÄÇ„Ç≥„Éº„Éí„Éº„Åß„ÇÇ`,
                            `‚òï ${t} ‚Äî Âø´ÈÅ©„Å™Ê∞óÊ∏©„ÄÇ„ÅÆ„Çì„Å≥„Çä„Åó„Åü„ÅÑ`,
                            `üçµ ${t} ‚Äî Á©è„ÇÑ„Åã„Å™1Êó•„Å´„Å™„Çä„Åù„ÅÜ`
                        ]);
                    }
                }
                // COOL 14-18 („ÇÑ„ÇÑÊ∂º„Åó„ÅÑ) - 1.5x variations
                else if (temp >= 14) {
                    if (isNight && isVeryHumid) {
                        comment = pick([
                            `üåô ${t} ‚Äî „Å≤„Çì„ÇÑ„Çä„Å®Êπø„Å£„ÅüÂ§ú„ÄÇÈõ®„ÅåËøë„ÅÑ„Åã„ÇÇ`,
                            `üåô ${t} ‚Äî ËÇåÂØí„ÅèËí∏„Åó„ÅüÂ§ú„ÄÇÂ§©Ê∞ó„ÅÆÂ§âÂåñ„Å´Ê≥®ÊÑè`,
                            `üåô ${t} ‚Äî ÊπøÊ∞ó„ÅÆ„ÅÇ„ÇãÊ∂º„Åó„ÅÑÂ§ú`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî Â∞ë„ÅóËÇåÂØí„ÅÑÂ§ú„ÄÇËñÑÊâã„ÅÆ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`,
                            `üåô ${t} ‚Äî Ê∂º„Åó„ÅÑÂ§ú„ÄÇÁ™ì„ÇíÈñâ„ÇÅ„Å¶‰ºë„Åø„Åæ„Åó„Çá„ÅÜ`,
                            `üåô ${t} ‚Äî ÂøÉÂú∞„Çà„ÅèÊ∂º„Åó„ÅÑÂ§ú„ÄÇ„Åê„Å£„Åô„ÇäÁú†„Çå„Åù„ÅÜ`,
                            `üåô ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Â§ú„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß„ÇÇ`
                        ]);
                    } else if (isClear && isDry && isAutumn && !isNight) {
                        comment = pick([
                            `üçÅ ${t} ‚Äî Áßã„ÅÆË°åÊ•ΩÊó•Âíå„ÄÇËªΩ„ÅÑ‰∏äÁùÄ„ÅßÁ¥ÖËëâÁã©„Çä„Å∏`,
                            `üçÇ ${t} ‚Äî ÁßãÊô¥„Çå„ÄÇ„ÅäÂá∫„Åã„Åë„Å´„Å¥„Å£„Åü„Çä`,
                            `üçÅ ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÁßãÊô¥„Çå„ÄÇÊï£Ê≠©Êó•Âíå`,
                            `üçÇ ${t} ‚Äî Áßã„ÅÆÁàΩ„ÇÑ„Åã„Åï„ÄÇÂ§ñ„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑ`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `üåÖ ${t} ‚Äî ÁàΩ„ÇÑ„Åã„Å™Êúù„ÄÇÊó•‰∏≠„ÅØÊöñ„Åã„Åè„Å™„Çä„Åæ„Åô`,
                            `‚òÄÔ∏è ${t} ‚Äî „Å≤„Çì„ÇÑ„Çä„Åó„ÅüÊúù„ÄÇ‰∏äÁùÄ„ÇíÂøò„Çå„Åö„Å´`,
                            `üåÖ ${t} ‚Äî ÂÜ∑„ÅàËæº„ÇÄÊúù„ÄÇÊó•‰∏≠„ÅØÁ©è„ÇÑ„Åã„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî Êúù„ÅØÊ∂º„Åó„ÅÑ„Åß„Åô„ÅåËâØ„ÅÑÂ§©Ê∞ó`
                        ]);
                    } else if (isClear && isDry && isAfternoon) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„ÅüÂçàÂæå„ÄÇ„ÅäÊï£Ê≠©Êó•Âíå`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÅÆÊó•Â∑Æ„Åó„ÅåÂøÉÂú∞„ÅÑ„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî Á©è„ÇÑ„Åã„Å™ÂçàÂæå„ÄÇÂ§ñ„Åß„ÅÆ„Çì„Å≥„Çä`,
                            `‚òÄÔ∏è ${t} ‚Äî ÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÂçàÂæå„ÇíÊ•Ω„Åó„Çì„Åß`
                        ]);
                    } else if (isClear && isDry && !isNight) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶ÁàΩ„ÇÑ„Åã„Åß„Åô„ÅåÊ∂º„Åó„ÅÑ„ÄÇËñÑÊâã„ÅÆ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`,
                            `üß• ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Å¶„ÇÇÊ∂º„Åó„ÅÑ„ÄÇ‰∏äÁùÄ„Çí`,
                            `‚òÄÔ∏è ${t} ‚Äî Ê∞óÊåÅ„Å°„ÅÑ„ÅÑÊô¥„Çå„ÄÇÁæΩÁπî„Çã„ÇÇ„ÅÆ„Çí`,
                            `üß• ${t} ‚Äî Ê∂º„Åó„ÅÑÊô¥„Çå„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî ËÇåÂØí„ÅÑÊúù„ÄÇÊó•‰∏≠„ÅØÊöñ„Åã„Åè„Å™„Çä„Åæ„Åô`,
                            `üåÖ ${t} ‚Äî Êúù„ÅØÂÜ∑„Åà„Åæ„Åô„ÄÇ‰∏äÁùÄ„ÇíÊåÅ„Å£„Å¶`,
                            `‚òÄÔ∏è ${t} ‚Äî Êúù„ÅØÊ∂º„Åó„ÅÑ„Åß„Åô„ÅåÊô¥„Çå`,
                            `üåÖ ${t} ‚Äî ÂÜ∑„ÅàËæº„ÇÄÊúù„ÄÇ„Åß„ÇÇÊó•‰∏≠„ÅØÁ©è„ÇÑ„Åã`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„ÅØ„Å≤„Çì„ÇÑ„Çä„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`,
                            `üåá ${t} ‚Äî Â§ïÊñπ„Åã„ÇâÂÜ∑„Åà„Å¶„Åç„Åæ„Åô`,
                            `üåÜ ${t} ‚Äî Â§ïÊöÆ„Çå„ÅØÊ∂º„Åó„ÅÑ„ÄÇÁæΩÁπî„Çã„ÇÇ„ÅÆ„Çí`,
                            `üåá ${t} ‚Äî Â§ú„Å´Âêë„Åë„Å¶ÂÜ∑„Åà„Å¶„Åç„Åæ„Åô`
                        ]);
                    } else if (isClear && !isNight) {
                        comment = pick([
                            `üß• ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„Åå„Å≤„Çì„ÇÑ„Çä„ÄÇ‰∏äÁùÄ„ÇíÂøò„Çå„Åö„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Åß„ÇÇÊ∂º„Åó„ÅÑ„ÄÇËñÑÊâã„ÅÆ‰∏äÁùÄ„Çí`,
                            `üß• ${t} ‚Äî Êó•Â∑Æ„Åó„ÅØ„ÅÇ„Å£„Å¶„ÇÇÁ©∫Ê∞ó„ÅØÂÜ∑„Åü„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„Åå‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`
                        ]);
                    } else if (isVeryHumid && pp >= 40) {
                        comment = pick([
                            `üå´Ô∏è ${t} ‚Äî Êπø„Å£„ÅΩ„Åè„Å¶ËÇåÂØí„ÅÑ„ÄÇ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®`,
                            `üåßÔ∏è ${t} ‚Äî Ëí∏„ÅóËí∏„Åó„Åó„Å¶Ê∂º„Åó„ÅÑ„ÄÇÂÇò„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`,
                            `üå´Ô∏è ${t} ‚Äî ÊπøÊ∞ó„ÅåÂ§ö„ÅÑ„ÄÇÈõ®„ÅåÈôç„Çä„Åù„ÅÜ`
                        ]);
                    } else if (isVeryHumid) {
                        comment = pick([
                            `üíß ${t} ‚Äî ÊπøÊ∞ó„ÅÆÂ§ö„ÅÑÊ∂º„Åó„ÅÑÊó•`,
                            `üíß ${t} ‚Äî Ëí∏„ÅóËí∏„Åó„Åó„Å¶Ê∂º„Åó„ÅÑ„ÄÇÈô§Êπø„Åå„Åä„Åô„Åô„ÇÅ`,
                            `üíß ${t} ‚Äî ÊπøÊ∞ó„ÅåÈ´ò„ÇÅ„ÄÇÊ¥óÊøØÁâ©„ÅØÈÉ®Â±ãÂπ≤„Åó„Åã„Å™`
                        ]);
                    } else if (isOvercast && isAutumn) {
                        comment = pick([
                            `üçÇ ${t} ‚Äî ÁßãÊõá„Çä„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„ÅåÊÅã„Åó„ÅÑ`,
                            `üçÅ ${t} ‚Äî Êõá„Çä„ÅßËÇåÂØí„ÅÑ„ÄÇ„Éõ„ÉÉ„Éà„Ç≥„Éº„Éí„Éº„Åß„ÇÇ`,
                            `üçÇ ${t} ‚Äî Áßã„ÅÆÊõá„ÇäÁ©∫„ÄÇ„ÅÆ„Çì„Å≥„ÇäÈÅé„Åî„Åó„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    } else if (isOvercast && isSpring && !isNight) {
                        comment = pick([
                            `üå∏ ${t} ‚Äî Êò•Êõá„Çä„ÄÇËä±Á≤âÂØæÁ≠ñ„ÇíÂøò„Çå„Åö„Å´`,
                            `üå∑ ${t} ‚Äî Êò•„Çâ„Åó„ÅÑÊõá„Çä„ÄÇÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÊ∞óÊ∏©`,
                            `üå∏ ${t} ‚Äî Á©è„ÇÑ„Åã„Å™Êò•Êõá„Çä`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî Êõá„Çä„ÅßÂ∞ë„ÅóËÇåÂØí„ÅÑ„ÄÇÈï∑Ë¢ñ„Åå„Å°„Çá„ÅÜ„Å©„ÅÑ„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„ÇäÁ©∫„ÅßÊ∂º„Åó„ÅÑ„ÄÇ‰∏äÁùÄ„Çí`,
                            `‚õÖ ${t} ‚Äî Êõá„Çä„Åß„Åô„ÅåÈÅé„Åî„Åó„ÇÑ„Åô„ÅÑÊ∞óÊ∏©`
                        ]);
                    } else if (isLightBreeze && !isNight) {
                        comment = pick([
                            `üçÇ ${t} ‚Äî È¢®„ÅåÊ∂º„Åó„ÅÑ„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üçÉ ${t} ‚Äî È¢®„ÅåÂøÉÂú∞„Çà„ÅÑÊ∂º„Åó„Åï`,
                            `üçÇ ${t} ‚Äî È¢®„Åå„ÅÇ„Å£„Å¶Â∞ë„ÅóËÇåÂØí„ÅÑ`
                        ]);
                    } else if (isEvening) {
                        comment = pick([
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„Å´„Å™„Å£„Å¶Ê∂º„Åó„Åè„Å™„Çä„Åæ„Åó„Åü„ÄÇ‰∏äÁùÄ„Çí`,
                            `üåá ${t} ‚Äî Â§ïÊñπ„ÅØÂÜ∑„Åà„Åæ„Åô„Å≠„ÄÇÊ∏©„Åã„Åè„Åó„Å¶`,
                            `üåÜ ${t} ‚Äî Â§ïÊöÆ„Çå„ÅÆÊ∂º„Åó„Åï„ÄÇÁæΩÁπî„Çã„ÇÇ„ÅÆ„Çí`
                        ]);
                    } else {
                        comment = pick([
                            `üçÇ ${t} ‚Äî Áßã„ÅÆÁ©∫Ê∞ó„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„ÅåÊÅã„Åó„Åè„Å™„Çä„Åæ„Åô„Å≠`,
                            `üß• ${t} ‚Äî Ê∂º„Åó„ÅÑÊ∞óÊ∏©„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üçÇ ${t} ‚Äî Áßã„Çâ„Åó„ÅÑÊ∂º„Åó„Åï„ÄÇ„Éõ„ÉÉ„Éà„Éâ„É™„É≥„ÇØ„Åß„ÇÇ`,
                            `üß• ${t} ‚Äî Â∞ë„ÅóËÇåÂØí„ÅÑ„ÄÇÁæΩÁπî„Çã„ÇÇ„ÅÆ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`
                        ]);
                    }
                }
                // COOL 10-14 (ËÇåÂØí„ÅÑ) - 1.5x variations
                else if (temp >= 10) {
                    if (isNight && isVeryHumid) {
                        comment = pick([
                            `üåô ${t} ‚Äî Êπø„Å£„ÅüÂÜ∑„Åü„ÅÑÂ§ú„ÄÇÈõ®„ÅåËøë„ÅÑ„Åã„ÇÇ`,
                            `üåô ${t} ‚Äî Ëí∏„ÅóËí∏„Åó„Åó„Å¶ÂÜ∑„Åà„ÇãÂ§ú`,
                            `üåô ${t} ‚Äî Â∞ë„ÅóÊπøÊ∞ó„ÅÆ„ÅÇ„ÇãÂØí„ÅÑÂ§ú`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî ÂÜ∑„ÅàËæº„ÇÄÂ§ú„ÄÇÊöñ„Åã„Åè„Åó„Å¶„Åä‰ºë„Åø„Åè„Å†„Åï„ÅÑ`,
                            `üåô ${t} ‚Äî ÂØí„ÅÑÂ§ú„ÄÇÊ∏©„Åã„ÅÑÂ∏ÉÂõ£„Åß‰ºë„Åø„Åæ„Åó„Çá„ÅÜ`,
                            `üåô ${t} ‚Äî ËÇåÂØí„ÅÑÂ§ú„ÄÇÊöñÊàø„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `üåô ${t} ‚Äî ÂÜ∑„Åà„ÇãÂ§ú„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß„ÇÇ`
                        ]);
                    } else if (isClear && isDry && isMorning && isNorthWind && hasStrongGusts) {
                        // ÂåóÈ¢®ÔºãÁ™ÅÈ¢®„ÅÆÂØí„ÅÑÊúù
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî ÂåóÈ¢®„Å®Á™ÅÈ¢®„Åß‰ΩìÊÑüÊ∏©Â∫¶„ÉÄ„Ç¶„É≥„ÄÇ„Åó„Å£„Åã„ÇäÈò≤ÂØí„Çí`,
                            `üí® ${t} ‚Äî ÂåóÈ¢®„ÅåÂº∑„ÅèÂêπ„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇÂÇò„ÅåÈ£õ„Å∞„Åï„Çå„ÇÑ„Åô„ÅÑ`,
                            `üßä ${t} ‚Äî ÂÜ∑„Åü„ÅÑÂåóÈ¢®„Å®Á™ÅÈ¢®„ÄÇ„Éû„Éï„É©„ÉºÂøÖÈ†à`
                        ]);
                    } else if (isClear && isDry && isMorning && isNorthWind) {
                        // ÂåóÈ¢®„ÅÆÂØí„ÅÑÊúù
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî Âåó„Åã„Çâ„ÅÆÂÜ∑„Åü„ÅÑÈ¢®„ÄÇ‰ΩìÊÑüÊ∏©Â∫¶„Åå‰∏ã„Åå„Å£„Å¶„ÅÑ„Åæ„Åô`,
                            `üí® ${t} ‚Äî ÂåóÈ¢®„ÅåÂêπ„ÅÑ„Å¶„ÅÑ„Åæ„Åô„ÄÇÈ°î„ÅåÂÜ∑„Åü„ÅèÊÑü„Åò„ÇãÊúù`,
                            `üßä ${t} ‚Äî ÂÜ∑„Åü„ÅÑÂåóÈ¢®„ÄÇÊöñ„Åã„ÅÑ‰∏äÁùÄ„ÅßÂá∫„Åã„Åë„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    } else if (isClear && isDry && isMorning) {
                        comment = pick([
                            `üåÖ ${t} ‚Äî ÂÜ∑„ÅàËæº„ÇÄÊúù„ÄÇÊó•‰∏≠„ÅØÊöñ„Åã„Åè„Å™„ÇãË¶ãËæº„Åø`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂØí„ÅÑÊúù„Åß„Åô„ÅåÊô¥„Çå„ÄÇ‰∏äÁùÄ„ÇíÂøò„Çå„Åö„Å´`,
                            `üåÖ ${t} ‚Äî „Å≤„Çì„ÇÑ„Çä„Åó„ÅüÊúù„ÄÇÊó•‰∏≠„ÅØÁ©è„ÇÑ„Åã„Å´`,
                            `‚òÄÔ∏è ${t} ‚Äî Êúù„ÅØÂÜ∑„Åà„Åæ„Åô„ÅåËâØ„ÅÑÂ§©Ê∞ó`
                        ]);
                    } else if (isClear && isDry && isAfternoon) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„ÅüÂçàÂæå„Åß„Åô„ÅåÊ∂º„Åó„ÅÑ„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®Âø´ÈÅ©`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂçàÂæå„ÇÇÊ∂º„Åó„ÅÑ„ÄÇÁæΩÁπî„Çã„ÇÇ„ÅÆ„Çí`,
                            `üß• ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåËÇåÂØí„ÅÑÂçàÂæå`,
                            `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„ÅØ„ÅÇ„Çã„Åë„Å©ÂÜ∑„Åà„Çã`
                        ]);
                    } else if (isClear && isEvening) {
                        // Evening specific - no sunlight mentions
                        comment = pick([
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„Åã„ÇâÂÜ∑„ÅàËæº„Åø„Åæ„Åô„ÄÇ‰∏äÁùÄ„Çí`,
                            `üåá ${t} ‚Äî Êó•„ÅåÊ≤à„ÇÄ„Å®ÊÄ•„Å´ÂØí„Åè„Å™„Çä„Åæ„Åô`,
                            `üåÜ ${t} ‚Äî Â§ïÊöÆ„Çå„ÅØËÇåÂØí„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `üåá ${t} ‚Äî Â§ú„Å´Âêë„Åë„Å¶ÂÜ∑„ÅàËæº„Åø„Åæ„Åô`
                        ]);
                    } else if (isClear && isDry && (isMorning || isAfternoon)) {
                        comment = pick([
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Åß„Åô„ÅåËÇåÂØí„ÅÑ„ÄÇ„Åó„Å£„Åã„Çä‰∏äÁùÄ„Çí`,
                            `üß• ${t} ‚Äî Êô¥„Çå„Åß„ÇÇÂØí„ÅÑ„ÄÇ‰∏äÁùÄÂøÖÈ†à`,
                            `üß• ${t} ‚Äî Á©∫Ê∞ó„ÅåÂÜ∑„Åü„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `üß• ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåÂÜ∑„Åà„Åæ„Åô`
                        ]);
                    } else if (isClear && isWinter && (isMorning || isAfternoon)) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÄÇÊó•Â∑Æ„Åó„ÅØÊöñ„Åã„ÅÑ„Åß„Åô„ÅåÁ©∫Ê∞ó„ÅØÂÜ∑„Åü„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂÜ¨„ÅÆÊó•Â∑Æ„Åó„ÄÇÂ§ñ„ÅØÂØí„ÅÑ„Åß„Åô`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåÂÜ¨„ÅÆÂØí„Åï`,
                            `‚òÄÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÄÇÈ¢®„ÅåÂÜ∑„Åü„ÅÑ`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„ÅØ„Åê„Å£„Å®ÂÜ∑„Åà„Åæ„Åô„ÄÇ‰∏äÁùÄÂøÖÈ†à`,
                            `üåá ${t} ‚Äî Â§ïÊöÆ„Çå„ÅØÂØí„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `üåÜ ${t} ‚Äî Â§ú„Å´Âêë„Åë„Å¶ÂÜ∑„ÅàËæº„Åø„Åæ„Åô`,
                            `üåá ${t} ‚Äî Â§ïÊñπ„Åã„Çâ‰∏ÄÊ∞ó„Å´ÂØí„Åè„Å™„Çä„Åæ„Åô`
                        ]);
                    } else if (isClear) {
                        comment = pick([
                            `üß• ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåÂÜ∑„Åà„Åæ„Åô„ÄÇ‰∏äÁùÄÂøÖÈ†à`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Åß„ÇÇÂØí„ÅÑ„ÄÇ„Åó„Å£„Åã„ÇäÈò≤ÂØí„Çí`,
                            `üß• ${t} ‚Äî Á©∫Ê∞ó„ÅåÂÜ∑„Åü„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`
                        ]);
                    } else if (isVeryHumid) {
                        comment = pick([
                            `üå´Ô∏è ${t} ‚Äî Êπø„Å£„ÅΩ„Åè„Å¶Â∫ïÂÜ∑„Åà„ÄÇÊöñÊàø„Çí„Å§„Åë„Åæ„Åó„Çá„ÅÜ`,
                            `üåßÔ∏è ${t} ‚Äî „Åò„ÇÅ„Åò„ÇÅ„Åó„Å¶ÂØí„ÅÑ„ÄÇÊöñÊàø„ÅåÊ¨≤„Åó„ÅÑ`,
                            `üå´Ô∏è ${t} ‚Äî ÊπøÊ∞ó„Åß‰ΩôË®à„Å´ÂØí„ÅèÊÑü„Åò„Åæ„Åô`
                        ]);
                    } else if (isOvercast && isWinter) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî ÂÜ¨Êõá„Çä„ÄÇÊöñÊàø„ÅåÊÅã„Åó„ÅÑ‰∏ÄÊó•`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÂØí„ÄÖ„Åó„ÅÑ„ÄÇÊ∏©„Åã„ÅèÈÅé„Åî„Åó„Å¶`,
                            `‚òÅÔ∏è ${t} ‚Äî ÂÜ¨„ÅÆÊõá„ÇäÁ©∫„ÄÇÊöñÊàø„Çí„Å§„Åë„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    } else if (isOvercast && isLightBreeze) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÈ¢®„ÅåÂÜ∑„Åü„ÅÑ„ÄÇ‰∏äÁùÄ„Çí„Åó„Å£„Åã„Çä`,
                            `üå¨Ô∏è ${t} ‚Äî È¢®„Åå„Å≤„Çì„ÇÑ„Çä„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„ÅßËÇåÂØí„ÅÑ„ÄÇÈò≤ÂØí„Çí`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚õÖ ${t} ‚Äî Êõá„Çä„ÅßËÇåÂØí„ÅÑ„ÄÇ„Çª„Éº„Çø„Éº„ÇÑ„Ç´„Éº„Éá„Ç£„Ç¨„É≥„Çí`,
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„ÇäÁ©∫„ÅßÂØí„ÄÖ„Åó„ÅÑ„ÄÇÊöñ„Åã„Åè`,
                            `‚õÖ ${t} ‚Äî Êõá„Çä„ÅßÂÜ∑„Åà„Çã„ÄÇ‰∏äÁùÄ„ÇíÂøò„Çå„Åö„Å´`
                        ]);
                    } else if (feelsColder) {
                        comment = `üß• ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî È¢®„Åß‰ΩìÊÑüÊ∏©Â∫¶„ÅØ‰Ωé„ÇÅ`;
                    } else {
                        comment = pick([
                            `üß• ${t} ‚Äî Ê∂º„Åó„Åï„ÇíÈÄö„ÇäË∂ä„Åó„Å¶ÂØí„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `üß• ${t} ‚Äî ËÇåÂØí„ÅÑ„ÄÇ‰∏äÁùÄ„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`,
                            `üß• ${t} ‚Äî ÂÜ∑„Åà„ÇãÊ∞óÊ∏©„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß„ÇÇ`,
                            `üß• ${t} ‚Äî ÂØí„Åè„Å™„Å£„Å¶„Åç„Åæ„Åó„Åü„ÄÇÈò≤ÂØí„Çí`
                        ]);
                    }
                }
                // CHILLY 5-10 (ÂØí„ÅÑ) - 1.5x variations
                else if (temp >= 5) {
                    if (isNight && isVeryHumid && pp >= 40) {
                        comment = pick([
                            `üåô ${t} ‚Äî Êπø„Å£„ÅüÂÜ∑„Åü„ÅÑÂ§ú„ÄÇ${pp}%„ÅÆÁ¢∫Áéá„ÅßÈõ®`,
                            `üåô ${t} ‚Äî „Åò„ÇÅ„Åò„ÇÅ„Åó„Å¶ÂØí„ÅÑÂ§ú„ÄÇÈõ®„ÅåËøë„ÅÑ„Åã„ÇÇ`,
                            `üåô ${t} ‚Äî ÊπøÂ∫¶È´ò„ÅèÂ∫ïÂÜ∑„Åà„Åô„ÇãÂ§ú„ÄÇÂÇò„ÇíÁî®ÊÑè„Åó„Å¶`
                        ]);
                    } else if (isNight && isVeryHumid) {
                        comment = pick([
                            `üåô ${t} ‚Äî Êπø„Å£„ÅüÂÜ∑„Åü„ÅÑÂ§ú„ÄÇÂ∫ïÂÜ∑„Åà„Åó„Åæ„Åô`,
                            `üåô ${t} ‚Äî „Åò„ÇÅ„Åò„ÇÅ„Åó„Å¶ÂØí„ÅÑÂ§ú`,
                            `üåô ${t} ‚Äî ÊπøÂ∫¶È´ò„ÅèÂ∫ïÂÜ∑„Åà„Åô„ÇãÂ§ú`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üåô ${t} ‚Äî ÂÜ∑„ÅàËæº„ÇÄÂ§ú„ÄÇÊöñÊàø„Çí„Å§„Åë„Å¶„ÇÜ„Å£„Åè„Çä‰ºë„Åø„Åæ„Åó„Çá„ÅÜ`,
                            `üåô ${t} ‚Äî ÂØí„ÅÑÂ§ú„ÄÇÊ∏©„Åã„ÅÑÂ∏ÉÂõ£„ÅßÁú†„Çä„Åæ„Åó„Çá„ÅÜ`,
                            `üåô ${t} ‚Äî ÂÜ∑„Åà„ÇãÂ§ú„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß„É™„É©„ÉÉ„ÇØ„Çπ`,
                            `üåô ${t} ‚Äî ÊöñÊàø„ÅåÊÅã„Åó„ÅÑÂ§ú„ÄÇ„ÇÜ„Å£„Åè„Çä‰ºë„Çì„Åß`
                        ]);
                    } else if (isClear && isExtremelyDry && (isMorning || isAfternoon)) {
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî „Ç≠„É™„ÉÉ„Å®Êô¥„Çå„ÄÇÁ©∫Ê∞ó„Åå„Ç´„É©„Ç´„É©„ÄÇ‰øùÊπøÂøÖÈ†à`,
                            `üí® ${t} ‚Äî ‰πæÁá•„Åó„ÅüÊô¥„Çå„ÄÇËÇå„Åå„Ç¨„Çµ„Ç¨„Çµ„Å´`,
                            `üå¨Ô∏è ${t} ‚Äî Êô¥„Çå„Åß„Åô„Åå‰πæÁá•Ê≥®ÊÑè„ÄÇ‰øùÊπø„Çí`
                        ]);
                    } else if (isClear && isVeryDry && (isMorning || isAfternoon)) {
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî „Ç≠„É™„ÉÉ„Å®ÂÜ∑„Åü„ÅÑÊô¥„Çå„ÄÇÁ©∫Ê∞ó„Åå‰πæÁá•„Åó„Å¶„ÅÑ„Åæ„Åô`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„Åå‰πæÁá•„ÅßÂîá„ÅåËçí„Çå„Åù„ÅÜ`,
                            `üå¨Ô∏è ${t} ‚Äî ‰πæ„ÅÑ„ÅüÂÜ∑Ê∞ó„ÄÇ„ÅÆ„Å©È£¥„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî Èúú„ÅåÈôç„Çä„Çã„Çà„ÅÜ„Å™Êúù„ÄÇÊó•‰∏≠„ÇÇÂØí„ÅÑ`,
                            `üåÖ ${t} ‚Äî Âáç„Åà„ÇãÊúù„ÄÇÊöñ„Åã„Åè„Åó„Å¶Âá∫„Åã„Åë„Å¶`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ∑„ÅàËæº„Çì„Å†Êúù„ÄÇËªä„ÅÆ„Éï„É≠„É≥„Éà„Ç¨„É©„Çπ„Å´Èúú`,
                            `üåÖ ${t} ‚Äî ÂØí„ÅÑÊúù„ÄÇÊ∏©„Åã„ÅÑÊúùÈ£ü„Åß‰Ωì„ÇíÊ∏©„ÇÅ„Å¶`
                        ]);
                    } else if (isClear && isAfternoon) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÅÆÂçàÂæå„ÄÇÊó•Â∑Æ„Åó„Åå„ÅÇ„Çã„Å®Â∞ë„ÅóÊöñ„Åã„ÅÑ`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåÂØí„ÅÑÂçàÂæå„ÄÇÈò≤ÂØíÂøÖÈ†à`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂçàÂæå„ÇÇÂÜ∑„Åà„Çã„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„ÅØ„ÅÇ„Çã„Åë„Å©Á©∫Ê∞ó„ÅØÂÜ∑„Åü„ÅÑ`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåÜ ${t} ‚Äî Êó•„ÅåÊ≤à„ÇÄ„Å®ÊÄ•„Å´ÂÜ∑„Åà„Åæ„Åô„ÄÇÈò≤ÂØíÂØæÁ≠ñ„Çí`,
                            `üåá ${t} ‚Äî Â§ïÊñπ„Åã„Çâ‰∏ÄÊ∞ó„Å´ÂÜ∑„ÅàËæº„Åø„Åæ„Åô`,
                            `üåÜ ${t} ‚Äî Â§ú„Å´Âêë„Åë„Å¶Âé≥„Åó„ÅÑÂØí„Åï„Å´`,
                            `üåá ${t} ‚Äî Â§ïÊöÆ„Çå„ÅØÂØí„ÅÑ„ÄÇÊó©„ÇÅ„Å´Â∏∞ÂÆÖ„Çí`
                        ]);
                    } else if (isClear) {
                        comment = pick([
                            `‚õÑ ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Åæ„Åô„ÅåÂØí„ÅÑ„Åß„Åô„ÄÇ„Åó„Å£„Åã„ÇäÈò≤ÂØí„Çí`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÄÇÂØí„ÅïÂØæÁ≠ñ„Çí‰∏áÂÖ®„Å´`,
                            `‚õÑ ${t} ‚Äî Êô¥„Çå„Åß„ÇÇÂÜ∑„Åà„Çã„ÄÇ„Ç≥„Éº„ÉàÂøÖÈ†à`
                        ]);
                    } else if (isExtremelyHumid || isVeryHumid) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî ÊπøÂ∫¶È´ò„ÅèÂ∫ïÂÜ∑„Åà„ÄÇÈõ™„ÅÆ‰∫àÊÑü`,
                            `üå®Ô∏è ${t} ‚Äî „Åò„ÇÅ„Åò„ÇÅ„Åó„Å¶Âáç„Åà„Åù„ÅÜ„ÄÇÈõ™„Åã`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êπø„Å£„ÅüÂØí„Åï„ÄÇ‰Ωì„ÅÆËäØ„Åã„ÇâÂÜ∑„Åà„Çã`
                        ]);
                    } else if (isHumid) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÊπøÂ∫¶„ÅåÈ´ò„ÅèÂ∫ïÂÜ∑„Åà„Åó„Åæ„Åô„ÄÇÊöñÊàø„ÅßÊöñ„Åæ„Çä„Åæ„Åó„Çá„ÅÜ`,
                            `ü•∂ ${t} ‚Äî „Åò„ÇÅ„Å£„Å®„Åó„ÅüÂØí„Åï„ÄÇÊöñÊàø„ÅåÊ¨≤„Åó„ÅÑ`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÊπøÊ∞ó„Åß‰ΩôË®à„Å´ÂØí„ÅèÊÑü„Åò„Åæ„Åô`
                        ]);
                    } else if (isOvercast && isWinter) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî ÂÜ¨Êõá„Çä„ÄÇÈõ™„Åå„Å°„Çâ„Å§„Åè„Åã„ÇÇ`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÂØí„ÅÑ„ÄÇÈõ™„ÅÆÂèØËÉΩÊÄß„ÅÇ„Çä`,
                            `‚òÅÔ∏è ${t} ‚Äî ÂÜ¨„ÅÆÊõá„ÇäÁ©∫„ÄÇÊöñÊàø„Çí„Å§„Åë„Åæ„Åó„Çá„ÅÜ`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÂØí„ÄÖ„Åó„ÅÑ„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß‰∏ÄÊÅØ„Çí`,
                            `‚õÖ ${t} ‚Äî Êõá„Çä„ÅßÂÜ∑„Åà„Çã„ÄÇ„Éõ„ÉÉ„Éà„Éâ„É™„É≥„ÇØ„ÅßÊ∏©„Åæ„Å£„Å¶`,
                            `‚òÅÔ∏è ${t} ‚Äî ÂØí„ÄÖ„Åó„ÅÑÊõá„ÇäÁ©∫„ÄÇÊöñ„Åã„Åè„Åó„Å¶`
                        ]);
                    } else if (isWindy || isVeryWindy) {
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî È¢®„ÅåÂÜ∑„Åü„ÅÑ„ÄÇ‰ΩìÊÑüÊ∏©Â∫¶„ÅØ„ÇÇ„Å£„Å®‰Ωé„ÅÑ`,
                            `üí® ${t} ‚Äî Âº∑„ÅÑÈ¢®„ÅßÂáç„Åà„Åù„ÅÜ„ÄÇ„Éû„Éï„É©„ÉºÂøÖÈ†à`,
                            `üå¨Ô∏è ${t} ‚Äî È¢®„Åß‰ΩìÊÑü„ÅØÊ∞∑ÁÇπ‰∏ã„Åã„ÇÇ`
                        ]);
                    } else if (feelsColder) {
                        comment = `üß£ ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî È¢®„Åß‰ΩìÊÑü„ÅØ„ÇÇ„Å£„Å®ÂØí„ÅÑ`;
                    } else {
                        comment = pick([
                            `üß£ ${t} ‚Äî „Ç≥„Éº„Éà„Å®„Éû„Éï„É©„Éº„ÅÆÂ≠£ÁØÄ„Åß„Åô„Å≠`,
                            `üß• ${t} ‚Äî „Åó„Å£„Åã„ÇäÈò≤ÂØí„ÄÇÈ¢®ÈÇ™„Å´Ê≥®ÊÑè`,
                            `üß£ ${t} ‚Äî ÂÜ¨Êú¨Áï™„ÄÇÊöñ„Åã„Åè„Åó„Å¶„ÅäÂá∫„Åã„Åë„Çí`,
                            `üß• ${t} ‚Äî ÂØí„ÅÑ„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„ÅåÊÅã„Åó„ÅÑ`
                        ]);
                    }
                }
                // COLD 0-5 („Å®„Å¶„ÇÇÂØí„ÅÑ) - 1.5x variations
                else if (temp >= 0) {
                    if (isNight && isVeryHumid) {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî Êπø„Å£„ÅüÂáç„Åà„ÇãÂ§ú„ÄÇÈõ™„ÅåÈôç„Çã„Åã„ÇÇ`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ∑„Åà„Å¶ÊπøÂ∫¶È´ò„ÅÑÂ§ú„ÄÇÁ©çÈõ™Ê≥®ÊÑè`,
                            `ü•∂ ${t} ‚Äî Âáç„Åà„ÇãÂ§ú„ÄÇÈõ™„ÅÆÊ∞óÈÖç`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî Âáç„Åà„ÇãÂ§ú„ÄÇÊöñÊàø„Çí„Åó„Å£„Åã„ÇäÂäπ„Åã„Åõ„Å¶„Åä‰ºë„Åø„Çí`,
                            `‚ùÑÔ∏è ${t} ‚Äî Ê•µÂØí„ÅÆÂ§ú„ÄÇÊöñ„Åã„Åè„Åó„Å¶‰ºë„Åø„Åæ„Åó„Çá„ÅÜ`,
                            `ü•∂ ${t} ‚Äî Ê∞∑ÁÇπ‰∏ãËøë„ÅÑÂ§ú„ÄÇÊöñÊàø„Éï„É´Á®ºÂÉç„Åß`,
                            `‚ùÑÔ∏è ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂ§ú„ÄÇÊ∏©„Åã„ÅÑ„ÇÇ„ÅÆ„ÇíÈ£≤„Çì„Åß`
                        ]);
                    } else if (willRain && isHumid) {
                        comment = pick([
                            `üå®Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Èõ™„Å´„Å™„Çä„Åù„ÅÜ„ÄÇÁ©ç„ÇÇ„Çã„Åã„ÇÇ`,
                            `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅÆ‰∫àÂ†±„ÄÇÁ©çÈõ™„Å´Ê≥®ÊÑè`,
                            `üå®Ô∏è ${t} ‚Äî Èõ™„Å´„Å™„Çä„Åù„ÅÜ„ÄÇË∑ØÈù¢ÂáçÁµêË≠¶Êàí`
                        ]);
                    } else if (willRain) {
                        comment = pick([
                            `üå®Ô∏è ${t} ‚Äî Èõ™„Å´„Å™„Çä„Åù„ÅÜ„Å™ÂØí„Åï„ÄÇË∑ØÈù¢ÂáçÁµê„Å´„ÅîÊ≥®ÊÑè„Çí`,
                            `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÈôç„Çã„Åã„ÇÇ„ÄÇÊªë„Çä„ÇÑ„Åô„ÅÑ„ÅÆ„ÅßÊ≥®ÊÑè`,
                            `üå®Ô∏è ${t} ‚Äî Èõ™„ÅÆÂèØËÉΩÊÄß„ÄÇÊó©„ÇÅ„ÅÆÂ∏∞ÂÆÖ„Çí`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÊîæÂ∞ÑÂÜ∑Âç¥„ÅßÂáç„Åà„ÇãÊúù„ÄÇË∑ØÈù¢ÂáçÁµêÊ≥®ÊÑè`,
                            `üåÖ ${t} ‚Äî „Ç≠„É≥„Ç≠„É≥„Å´ÂÜ∑„Åà„ÅüÊúù„ÄÇËªä„ÅÆÈÅãËª¢Ê≥®ÊÑè`,
                            `‚ùÑÔ∏è ${t} ‚Äî Èúú„ÅßÁúü„Å£ÁôΩ„Å™Êúù„ÄÇË∂≥ÂÖÉÊ≥®ÊÑè`,
                            `üåÖ ${t} ‚Äî Âáç„Åà„ÇãÊúù„ÄÇÊ∏©„Åã„ÅÑÈ£≤„ÅøÁâ©„Åß‰Ωì„ÇíËµ∑„Åì„Åó„Å¶`
                        ]);
                    } else if (isClear && isAfternoon) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÅÆÂçàÂæå„ÄÇÊó•Â∑Æ„Åó„Åå„ÅÇ„Çã„Å®Â∞ë„Åó„Åæ„Åó`,
                            `‚òÄÔ∏è ${t} ‚Äî Êô¥„Çå„Åß„ÇÇÂØí„ÅÑÂçàÂæå„ÄÇÈò≤ÂØí„Åó„Å£„Åã„Çä`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂçàÂæå„ÇÇÂáç„Åà„Çã„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `‚òÄÔ∏è ${t} ‚Äî Êó•Â∑Æ„Åó„Åå„ÅÇ„Å£„Å¶„ÇÇÂØíÈ¢®„ÅåÂÜ∑„Åü„ÅÑ`
                        ]);
                    } else if (isClear && isEvening) {
                        comment = pick([
                            `üåÜ ${t} ‚Äî Êó•„ÅåÊ≤à„ÇÄ„Å®Ê∞∑ÁÇπ‰∏ã„Å´Ëøë„Å•„Åç„Åæ„Åô„ÄÇÈò≤ÂØí„Çí`,
                            `üåá ${t} ‚Äî Â§ú„ÅØ„Åï„Çâ„Å´ÂÜ∑„ÅàËæº„Åø„Åæ„Åô„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `üåÜ ${t} ‚Äî Â§ïÊñπ„Åã„ÇâÊÄ•ÊøÄ„Å´ÂÜ∑„ÅàËæº„Åø„Åæ„Åô`,
                            `üåá ${t} ‚Äî Êó•Ê≤°Âæå„ÅØÂáç„Åà„ÇãÂØí„Åï„ÄÇÊó©„ÇÅ„Å´Â∏∞ÂÆÖ„Çí`
                        ]);
                    } else if (isClear && (isMorning || isAfternoon)) {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî Âáç„Åà„Çã„Çà„ÅÜ„Å™Êô¥„Çå„ÄÇÊîæÂ∞ÑÂÜ∑Âç¥„ÅßÂÜ∑„ÅàËæº„Çì„Åß„ÅÑ„Åæ„Åô`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êô¥„Çå„ÄÇË¶ã„ÅüÁõÆ„Çà„ÇäÂØí„ÅÑ`,
                            `ü•∂ ${t} ‚Äî Êô¥„Çå„Å¶„ÇÇÊ•µÂØí„ÄÇ„Åó„Å£„Åã„ÇäÈò≤ÂØí„Çí`
                        ]);
                    } else if (isClear && (isEvening || isNight)) {
                        comment = pick([
                            `üåô ${t} ‚Äî Âáç„Åà„ÇãÂ§ú„ÄÇÊöñÊàøÂøÖÈ†à`,
                            `‚ùÑÔ∏è ${t} ‚Äî Ê•µÂØí„ÅÆÂ§ú„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `ü•∂ ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂ§ú„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„ÇÅ„Å´`
                        ]);
                    } else if (isVeryWindy) {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî ÂØíÈ¢®„ÅåË∫´„Å´„Åó„Åø„Çã„ÄÇ‰ΩìÊÑü„ÅØÊ∞∑ÁÇπ‰∏ã`,
                            `üå¨Ô∏è ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂº∑È¢®„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„ÇÅ„Å´`,
                            `ü•∂ ${t} ‚Äî Âº∑È¢®„Åß‰ΩìÊÑü„ÅØÂç±Èô∫„É¨„Éô„É´`
                        ]);
                    } else if (isWindy) {
                        comment = pick([
                            `üå¨Ô∏è ${t} ‚Äî È¢®„ÅåÂÜ∑„Åü„Åè‰ΩìÊÑü„ÅØÊõ¥„Å´‰∏ã„ÄÇÈò≤ÂØíÂøÖÈ†à`,
                            `üí® ${t} ‚Äî È¢®„Åß‰ΩìÊÑü„ÅØÊ∞∑ÁÇπ‰∏ã„ÄÇ„Éû„Éï„É©„ÉºÂøÖÈ†à`,
                            `üå¨Ô∏è ${t} ‚Äî È¢®„ÅåÂÜ∑„Åü„ÅÑ„ÄÇÊöñ„Åã„Åè„Åó„Å¶`
                        ]);
                    } else if (isOvercast && isVeryHumid) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî „Å©„Çì„Çà„ÇäÂØí„ÅÑ„ÄÇÈõ™„ÅåËøë„ÅÑ„Åã„ÇÇ`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êõá„Çä„ÅßÂ∫ïÂÜ∑„Åà„ÄÇÈõ™„ÅÆ‰∫àÊÑü`,
                            `‚òÅÔ∏è ${t} ‚Äî ÂØí„ÄÖ„Åó„ÅÑÊõá„Çä„ÄÇ„ÅÑ„Å§Èõ™„ÅåÈôç„Å£„Å¶„ÇÇ„Åä„Åã„Åó„Åè„Å™„ÅÑ`
                        ]);
                    } else if (isOvercast) {
                        comment = pick([
                            `‚òÅÔ∏è ${t} ‚Äî „Å©„Çì„Çà„ÇäÂØí„ÅÑ„ÄÇÈõ™„ÅÆÊ∞óÈÖç„ÇíÊÑü„Åò„Åæ„Åô`,
                            `‚õÖ ${t} ‚Äî Êõá„Çä„ÅßÂáç„Åà„Çã„ÄÇÊöñÊàø„ÅåÊÅã„Åó„ÅÑ`,
                            `‚òÅÔ∏è ${t} ‚Äî ÂØí„ÄÖ„Åó„ÅÑÊõá„ÇäÁ©∫„ÄÇÊ∏©„Åã„Åè„Åó„Å¶`
                        ]);
                    } else if (feelsColder) {
                        comment = `ü•∂ ${t}Ôºà‰ΩìÊÑü${fl.toFixed(0)}¬∞CÔºâ‚Äî È¢®„Åß‰ΩìÊÑü„ÅØÊ∞∑ÁÇπ‰∏ã`;
                    } else {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî „Åã„Å™„ÇäÂÜ∑„ÅàËæº„Çì„Åß„ÅÑ„Åæ„Åô„ÄÇÂéöÁùÄ„Çí„Åó„Å¶Êöñ„Åã„Åè`,
                            `‚ùÑÔ∏è ${t} ‚Äî Ê•µÂØí„ÄÇÈò≤ÂØíÂØæÁ≠ñ„Çí‰∏áÂÖ®„Å´`,
                            `ü•∂ ${t} ‚Äî Âáç„Åà„ÇãÂØí„Åï„ÄÇÊöñÊàø„Çí„Å§„Åë„Åæ„Åó„Çá„ÅÜ`,
                            `‚ùÑÔ∏è ${t} ‚Äî ÂÜ¨Êú¨Áï™„ÅÆÂØí„Åï„ÄÇÊ∏©„Åã„Åè„Åó„Å¶`
                        ]);
                    }
                }
                // FREEZING -5 to 0 - Expanded
                else if (temp >= -5) {
                    if (isVeryHumid || isExtremelyHumid) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅßÊπøÂ∫¶È´ò„ÅÑ„ÄÇÂ§ßÈõ™„Å´„Å™„Çä„Åù„ÅÜ`,
                            `üå®Ô∏è ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅßÊπøÊ∞ó„Åü„Å£„Å∑„Çä„ÄÇÁ©çÈõ™Ë≠¶Êàí`,
                            `‚ùÑÔ∏è ${t} ‚Äî Èõ™„ÅåÊú¨Èôç„Çä„Å´„Å™„Çä„Åù„ÅÜ„ÄÇ‰∫§ÈÄöÊÉÖÂ†±„ÇíÁ¢∫Ë™ç`
                        ]);
                    } else if (isHumid) {
                        comment = pick([
                            `‚ùÑÔ∏è ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅßÊπøÂ∫¶„ÇÇÈ´ò„ÅÑ„ÄÇÈõ™„ÅåÈôç„Çä„Åù„ÅÜ`,
                            `üå®Ô∏è ${t} ‚Äî Èõ™„ÅÆÊ∞óÈÖç„ÄÇÁ©ç„ÇÇ„Çã„Åã„ÇÇ„Åó„Çå„Åæ„Åõ„Çì`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êù±‰∫¨„ÅßÈõ™„ÄÇÁèç„Åó„ÅÑÂÖâÊôØ„Åß„Åô„Å≠`
                        ]);
                    } else if (isVeryWindy) {
                        comment = pick([
                            `üßä ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅÆÂº∑È¢®„ÄÇÂ§ñÂá∫„ÅØÊ•µÂäõÈÅø„Åë„Å¶`,
                            `‚ùÑÔ∏è ${t} ‚Äî È¢®„Åß‰ΩìÊÑü„ÅØ-10¬∞C‰ª•‰∏ã„ÄÇÂáçÂÇ∑Ê≥®ÊÑè`,
                            `üßä ${t} ‚Äî ÁåõÁÉà„Å´ÂÜ∑„Åü„ÅÑÈ¢®„ÄÇËÇå„ÇíÈú≤Âá∫„Åó„Å™„ÅÑ„Åß`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `üßä ${t} ‚Äî ÊîæÂ∞ÑÂÜ∑Âç¥„ÅßÊ•µÂØí„ÅÆÊúù„ÄÇÊ∞¥ÈÅìÁÆ°ÂáçÁµêÊ≥®ÊÑè`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êô¥„Çå„ÅüÊúù„Åª„Å©ÂÜ∑„Åà„Çã„ÄÇË∑ØÈù¢ÂáçÁµêË≠¶Êàí`,
                            `üßä ${t} ‚Äî Èúú„ÅåÈôç„Çä„Å¶„ÅÑ„Åæ„Åô„ÄÇËªä„ÅÆ„Éï„É≠„É≥„Éà„Ç¨„É©„ÇπÂáçÁµê`
                        ]);
                    } else if (isClear) {
                        comment = pick([
                            `üßä ${t} ‚Äî Âø´Êô¥„Åß„Åô„ÅåÊ•µÂØí„ÄÇÊîæÂ∞ÑÂÜ∑Âç¥„ÅßÁåõÁÉà„Å´ÂÜ∑„Åà„Å¶„ÅÑ„Åæ„Åô`,
                            `‚ùÑÔ∏è ${t} ‚Äî Êô¥„Çå„Å¶„ÅÑ„Å¶„ÇÇÊ∞∑ÁÇπ‰∏ã„ÄÇÈôΩ„Å†„Åæ„Çä„ÇÇÂØí„ÅÑ`,
                            `üßä ${t} ‚Äî ÈùíÁ©∫„Åß„ÇÇÂáç„Åà„ÇãÂØí„Åï„ÄÇÊöñ„Åã„ÅÑÊúçË£Ö„Åß`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `üßä ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„ÅÆÂ§ú„ÄÇÊöñÊàø„Çí„Åó„Å£„Åã„ÇäÂäπ„Åã„Åõ„Å¶`,
                            `‚ùÑÔ∏è ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂ§ú„ÄÇÊ∞¥ÈÅì„ÇíÂ∞ë„ÅóÂá∫„Åó„Å¶„Åä„ÅÑ„Å¶`,
                            `üßä ${t} ‚Äî Ê•µÂØí„ÅÆÂ§ú„ÄÇÊ∏©„Åã„Åè„Åó„Å¶„Åä‰ºë„Åø„Çí`
                        ]);
                    } else {
                        comment = pick([
                            `üßä ${t} ‚Äî Ê∞∑ÁÇπ‰∏ã„Åß„Åô„ÄÇÊ∞¥ÈÅìÁÆ°ÂáçÁµê„Å´„ÅîÊ≥®ÊÑè„Çí`,
                            `‚ùÑÔ∏è ${t} ‚Äî Ë∑ØÈù¢ÂáçÁµê„Å´Âé≥ÈáçÊ≥®ÊÑè„ÄÇÊªë„Çä„ÇÑ„Åô„ÅÑ`,
                            `üßä ${t} ‚Äî Êù±‰∫¨„Åß„ÅØÁèç„Åó„ÅÑÂØí„Åï„ÄÇÊöñ„Åã„Åè„Åó„Å¶`,
                            `‚ùÑÔ∏è ${t} ‚Äî Âáç„Åà„ÇãÂØí„Åï„ÄÇ„Éõ„ÉÉ„Éà„Éâ„É™„É≥„ÇØ„ÅßÊ∏©„Åæ„Å£„Å¶`
                        ]);
                    }
                }
                // EXTREME COLD -5 below - Expanded
                else {
                    if (isVeryHumid || isExtremelyHumid) {
                        comment = pick([
                            `‚ö†Ô∏è ${t}„ÉªÊπøÂ∫¶${h}% ‚Äî Â§ßÈõ™„ÉªÂêπÈõ™„ÅÆÊÅê„Çå„ÄÇ‰∏çË¶Å‰∏çÊÄ•„ÅÆÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`,
                            `üÜò ${t} ‚Äî ÂëΩ„Å´Èñ¢„Çè„ÇãÂØí„Åï„Å®Â§ßÈõ™„ÄÇÁµ∂ÂØæ„Å´Â§ñÂá∫„Åó„Å™„ÅÑ„Åß`,
                            `‚ö†Ô∏è ${t} ‚Äî Ë®òÈå≤ÁöÑÂ§ßÈõ™„ÅÆÂèØËÉΩÊÄß„ÄÇ‰∫§ÈÄöÊ©üÈñ¢„Å´ÂΩ±ÈüøÂ§ß`
                        ]);
                    } else if (isStormWind || isVeryWindy) {
                        comment = pick([
                            `‚ö†Ô∏è ${t} ‚Äî ÁåõÁÉà„Å™ÂØí„Åï„Å®Âº∑È¢®„ÄÇÂëΩ„Å´Èñ¢„Çè„ÇãÂç±Èô∫„ÄÇÂ§ñÂá∫Á¶ÅÊ≠¢`,
                            `üÜò ${t} ‚Äî „Éõ„ÉØ„Ç§„Éà„Ç¢„Ç¶„Éà„ÅÆÂç±Èô∫„ÄÇËªä„ÅÆÈÅãËª¢„ÅØÂé≥Á¶Å`,
                            `‚ö†Ô∏è ${t} ‚Äî ÁåõÂêπÈõ™„ÄÇË¶ñÁïå„Çº„É≠„ÄÇÁµ∂ÂØæ„Å´Â§ñÂá∫„Åó„Å™„ÅÑ„Åß`
                        ]);
                    } else if (temp <= -10) {
                        comment = pick([
                            `‚ö†Ô∏è ${t} ‚Äî Ê•µÂØíÔºÅÊï∞ÂàÜ„ÅßÂáçÂÇ∑„ÅÆÂç±Èô∫„ÄÇÁµ∂ÂØæ„Å´Â§ñÂá∫„Åó„Å™„ÅÑ„Åß`,
                            `üÜò ${t} ‚Äî ÂëΩ„Å´Èñ¢„Çè„ÇãÂØí„Åï„ÄÇÈõªÊ∞ó„ÉªÊ∞¥ÈÅì„Éª„Ç¨„Çπ„ÇíÁ¢∫Ë™ç`,
                            `‚ö†Ô∏è ${t} ‚Äî Ë¶≥Ê∏¨Âè≤‰∏äÊúÄ‰Ωé„É¨„Éô„É´„ÄÇÊöñÊàø„ÇíÊúÄÂ§ß„Å´`,
                            `üÜò ${t} ‚Äî ‰∏ÄÊ≠©„ÇÇÂ§ñ„Å´Âá∫„Å™„ÅÑ„Åß„ÄÇÂáçÂÇ∑„Éª‰Ωé‰ΩìÊ∏©Áóá„ÅÆÂç±Èô∫`
                        ]);
                    } else if (isClear && isMorning) {
                        comment = pick([
                            `‚ö†Ô∏è ${t} ‚Äî Ê•µÂØí„ÅÆÊúù„ÄÇÊ∞¥ÈÅìÁÆ°„ÉªÁµ¶ÊπØÂô®„ÅÆÂáçÁµêÊ≥®ÊÑè`,
                            `üßä ${t} ‚Äî ÊîæÂ∞ÑÂÜ∑Âç¥„ÅßË®òÈå≤ÁöÑÂÜ∑„ÅàËæº„Åø„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`,
                            `‚ö†Ô∏è ${t} ‚Äî ÈúúÊü±„Åå„Åô„Åî„ÅÑ„Åì„Å®„Å´„ÄÇÊªë„Çä„ÇÑ„Åô„ÅÑ`
                        ]);
                    } else if (isNight) {
                        comment = pick([
                            `‚ö†Ô∏è ${t} ‚Äî Ê•µÂØí„ÅÆÂ§ú„ÄÇÊöñÊàø„ÇíÂàá„Çâ„Å™„ÅÑ„Åß`,
                            `üßä ${t} ‚Äî Âáç„Å¶„Å§„ÅèÂ§ú„ÄÇÊ∞¥„ÇíÂ∞ë„ÅóÂá∫„Åó„Å¶„Åä„ÅÑ„Å¶`,
                            `‚ö†Ô∏è ${t} ‚Äî ÂëΩ„ÅÆÂç±Èô∫„Åå„ÅÇ„ÇãÂØí„Åï„ÄÇÊöñÊàø„Éï„É´Á®ºÂÉç„Åß`
                        ]);
                    } else {
                        comment = pick([
                            `ü•∂ ${t} ‚Äî Âé≥„Åó„ÅÑÂÜ∑„ÅàËæº„Åø„ÄÇÁü≠ÊôÇÈñì„Åß„ÇÇÂáçÂÇ∑„Å´Ê≥®ÊÑè`,
                            `‚ö†Ô∏è ${t} ‚Äî Êù±‰∫¨„Åß„ÅØËÄÉ„Åà„Çâ„Çå„Å™„ÅÑÂØí„Åï„ÄÇÂ§ñÂá∫„ÅØÊéß„Åà„Å¶`,
                            `üßä ${t} ‚Äî Ê•µÂØí„ÄÇËÇå„ÇíÈú≤Âá∫„Åô„Çã„Å®„Åô„Åê„Å´ÂáçÂÇ∑„ÅÆÂç±Èô∫`,
                            `‚ö†Ô∏è ${t} ‚Äî Ë®òÈå≤ÁöÑ„Å™ÂØí„Åï„ÄÇÊöñÊàø„Å®Èò≤ÂØí„Çí‰∏áÂÖ®„Å´`
                        ]);
                    }
                }
            }

            // ============================================================
            // SUFFIX CONTROL: „Çµ„Éï„Ç£„ÉÉ„ÇØ„ÇπÊï∞Âà∂Èôê„Å®ÂÑ™ÂÖàÂ∫¶ÁÆ°ÁêÜ
            // ÂÑ™ÂÖà„Çµ„Éï„Ç£„ÉÉ„ÇØ„Çπ: Ë≠¶Â†±„ÄÅÈôçÊ∞¥Ë≠¶Âëä„ÄÅÂ§©Ê∞óÂ§âÂåñ ‚Üí Âà∂Èôê„Å™„Åó
            // ‰ªªÊÑè„Çµ„Éï„Ç£„ÉÉ„ÇØ„Çπ: È¢®„ÄÅ‰ΩìÊÑüÊ∏©Â∫¶„ÄÅËä±Á≤â„ÄÅÊõúÊó•„ÄÅÊ¥óÊøØÁ≠â ‚Üí ÊúÄÂ§ß2„Å§„Åæ„Åß
            // ============================================================
            let optionalSuffixCount = 0;
            const MAX_OPTIONAL_SUFFIXES = 2;

            // ============================================================
            // „ÄêÊúÄÂÑ™ÂÖà„ÄëALERT SUFFIXES - Ë≠¶Â†±„ÅØÊúÄÂàù„Å´Ë°®Á§∫
            // ÂÑ™ÂÖàÈ†Ü‰Ωç: ÁâπÂà•Ë≠¶Â†± > Ë≠¶Â†± > Ê≥®ÊÑèÂ†±Ôºà1„Å§„Å†„ÅëË°®Á§∫Ôºâ
            // ============================================================
            if (currentAlerts.length > 0) {
                const specialWarnings = currentAlerts.filter(a => a.name?.includes('ÁâπÂà•Ë≠¶Â†±'));
                const severeWarnings = currentAlerts.filter(a => a.name?.includes('Ë≠¶Â†±') && !a.name?.includes('ÁâπÂà•'));
                const advisories = currentAlerts.filter(a => a.name?.includes('Ê≥®ÊÑèÂ†±'));

                // ÁâπÂà•Ë≠¶Â†±ÔºàÊúÄÂÑ™ÂÖàÔºâ
                if (specialWarnings.length > 0) {
                    const names = specialWarnings.slice(0, 2).map(a => a.name).join('„Éª');
                    comment += pick([
                        ` üö® ${names}Áô∫‰ª§‰∏≠ÔºÅÂëΩ„ÇíÂÆà„ÇãË°åÂãï„Çí`,
                        ` üÜò ${names}ÔºÅÁõ¥„Å°„Å´ÂÆâÂÖ®Á¢∫‰øù„Çí`
                    ]);
                }
                // Ë≠¶Â†±ÔºàÁâπÂà•Ë≠¶Â†±„Åå„Å™„Åë„Çå„Å∞Ë°®Á§∫Ôºâ
                else if (severeWarnings.length > 0) {
                    const warningNames = severeWarnings.slice(0, 2).map(a => a.name).join('„Éª');
                    comment += ` ‚ö†Ô∏è ${warningNames}Áô∫‰ª§‰∏≠`;
                }
                // Ê≥®ÊÑèÂ†±ÔºàË≠¶Â†±„Åå„Å™„Åë„Çå„Å∞Ë°®Á§∫„ÄÅ„Åü„Å†„ÅóÁ¢∫Áéá50%Ôºâ
                else if (advisories.length > 0 && Math.random() < 0.5) {
                    const advName = advisories[0].name;
                    comment += ` ‚ÑπÔ∏è ${advName}`;
                }
            }

            // ============================================================
            // ADD WIND WARNING (if not already mentioned in weather)
            // ============================================================
            if (isVeryWindy && !isSnow && !isThunderstorm) {
                comment += ' üåÄ Âº∑È¢®„Åß„Åô„ÄÇÈ£õ„Å∞„Åï„Çå„Å™„ÅÑ„Çà„ÅÜÊ≥®ÊÑè';
                optionalSuffixCount++;
            } else if (isWindy && !isRaining && !isSnow && optionalSuffixCount < MAX_OPTIONAL_SUFFIXES) {
                comment += ' üí® È¢®„Åå„ÅÇ„Çä„Åæ„Åô';
                optionalSuffixCount++;
            }

            // ============================================================
            // ADD FEELS LIKE TEMPERATURE DIFFERENCE
            // Â§ß„Åç„Å™Â∑ÆÔºà¬±5¬∞C‰ª•‰∏äÔºâ„ÅØÂÑ™ÂÖàË°®Á§∫„ÄÅÂ∞è„Åï„ÅÑÂ∑ÆÔºà¬±3-5¬∞CÔºâ„ÅØÂà∂Èôê„Ç´„Ç¶„É≥„Éà
            // ============================================================
            const feelsDiff = fl - temp;
            if (!comment.includes('‰ΩìÊÑü') && Math.abs(feelsDiff) >= 3) {
                if (feelsDiff >= 5) {
                    // Â§ß„Åç„Å™Â∑Æ„ÅØÂÑ™ÂÖàÔºàÂà∂Èôê„Ç´„Ç¶„É≥„Éà„Åó„Å™„ÅÑÔºâ
                    comment += ` üå°Ô∏è ‰ΩìÊÑü„ÅØ${fl.toFixed(0)}¬∞CÔºà+${feelsDiff.toFixed(0)}¬∞CÔºâ`;
                } else if (feelsDiff >= 3 && optionalSuffixCount < MAX_OPTIONAL_SUFFIXES) {
                    comment += ` üå°Ô∏è ‰ΩìÊÑü„ÅØ${fl.toFixed(0)}¬∞C„Å®Êöñ„Åã„ÇÅ`;
                    optionalSuffixCount++;
                } else if (feelsDiff <= -5) {
                    // Â§ß„Åç„Å™Â∑Æ„ÅØÂÑ™ÂÖàÔºàÂà∂Èôê„Ç´„Ç¶„É≥„Éà„Åó„Å™„ÅÑÔºâ
                    comment += ` üå°Ô∏è ‰ΩìÊÑü„ÅØ${fl.toFixed(0)}¬∞CÔºà${feelsDiff.toFixed(0)}¬∞CÔºâ`;
                } else if (feelsDiff <= -3 && optionalSuffixCount < MAX_OPTIONAL_SUFFIXES) {
                    comment += ` üå°Ô∏è ‰ΩìÊÑü„ÅØ${fl.toFixed(0)}¬∞C„Å®ÂØí„ÇÅ`;
                    optionalSuffixCount++;
                }
            }

            // ============================================================
            // ADD PRECIPITATION WARNING (Yahoo APIÂÑ™ÂÖà + Open-MeteoÈõ™Âà§ÂÆö)
            // „É°„Ç§„É≥„Ç≥„É°„É≥„Éà„ÅßÊó¢„Å´ÈôçÊ∞¥„Å´„Å§„ÅÑ„Å¶Ë®ÄÂèä„Åó„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ„Çπ„Ç≠„ÉÉ„Éó
            // ============================================================
            const precipType = getPrecipitationType();
            const precipEmoji = precipType === 'snow' ? '‚ùÑÔ∏è' : precipType === 'sleet' ? 'üå®Ô∏è' : '‚òÇÔ∏è';
            const precipName = precipType === 'snow' ? 'Èõ™' : precipType === 'sleet' ? '„Åø„Åû„Çå' : 'Èõ®';

            // „É°„Ç§„É≥„Ç≥„É°„É≥„Éà„ÅåÊó¢„Å´ÈôçÊ∞¥„Å´„Å§„ÅÑ„Å¶Ë®ÄÂèä„Åó„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
            const mainCommentHasPrecip = isRaining || isRainingOpenMeteo || isSnowActual || isSleetActual ||
                isHeavySnow || isSnow || isSleet || isHeavyRain || isModerateRain || isRain || isDrizzle;

            // Yahoo APIÂÆüÊ∏¨„Éá„Éº„Çø„ÇíÂÑ™ÂÖàÔºà„Åü„Å†„Åó„É°„Ç§„É≥„ÅßË®ÄÂèäÊ∏à„Åø„Å™„Çâ„Çπ„Ç≠„ÉÉ„ÉóÔºâ
            if (!mainCommentHasPrecip && actualPrecipState.isRaining && actualPrecipState.consecutiveMinutes >= 10) {
                // ÁèæÂú®Èôç„Å£„Å¶„ÅÑ„ÇãÂ†¥Âêà - actualPrecipState„Åã„ÇâÊÉÖÂ†±ÂèñÂæó
                const intensity = getPrecipIntensityLabel(actualPrecipState.rainfall, actualPrecipState.precipType);
                const currentEmoji = actualPrecipState.precipType === 'snow' ? '‚ùÑÔ∏è' :
                    actualPrecipState.precipType === 'sleet' ? 'üå®Ô∏è' : 'üåßÔ∏è';
                comment += ` ${currentEmoji} ${intensity}„ÅåÈôç„Å£„Å¶„ÅÑ„Åæ„Åô`;

                // ‰ªäÂæåÈõ™„Å´Â§â„Çè„Çã‰∫àÂ†±„Åå„ÅÇ„Çã„ÅãÁ¢∫Ë™ç
                const currentHour = new Date().getHours();
                if (actualPrecipState.precipType === 'rain' || actualPrecipState.precipType === 'sleet') {
                    for (let i = 1; i <= 3; i++) {
                        const futureType = getPrecipitationType(currentHour + i);
                        if (futureType === 'snow') {
                            comment += ` ‚Üí Á¥Ñ${i}ÊôÇÈñìÂæå„Å´Èõ™„Å´Â§â„Çè„ÇãË¶ãËæº„Åø`;
                            break;
                        }
                    }
                }
            } else if (!mainCommentHasPrecip && actualPrecipState.rainfall > 0) {
                // Èôç„ÇäÂßã„ÇÅÔºà10ÂàÜÊú™Ê∫ÄÔºâ
                const currentEmoji = actualPrecipState.precipType === 'snow' ? '‚ùÑÔ∏è' :
                    actualPrecipState.precipType === 'sleet' ? 'üå®Ô∏è' : 'üåßÔ∏è';
                const currentName = actualPrecipState.precipType === 'snow' ? 'Èõ™' :
                    actualPrecipState.precipType === 'sleet' ? '„Åø„Åû„Çå' : 'Èõ®';
                comment += ` ${currentEmoji} ${currentName}„ÅåÈôç„ÇäÂßã„ÇÅ„Å¶„ÅÑ„Åæ„Åô`;
            } else if (!mainCommentHasPrecip && willRain && pp >= 70) {
                // Yahoo API„Åß„ÅØÈôç„Å£„Å¶„ÅÑ„Å™„ÅÑ„Åå„ÄÅOpen-Meteo„ÅßÈ´òÁ¢∫Áéá„ÅßÈôçÊ∞¥‰∫àÂ†±
                comment += ` ${precipEmoji} ${precipName}„ÅÆ‰∫àÂ†±„ÄÇ${precipType === 'snow' ? 'Â§ñÂá∫„ÅØÊéß„Åà„ÇÅ„Å´' : precipType === 'sleet' ? 'Ë∂≥ÂÖÉ„Å´Ê≥®ÊÑè' : 'ÂÇò„ÇíÊåÅ„Å£„Å¶„ÅÑ„Åç„Åæ„Åó„Çá„ÅÜ'}`;
            } else if (!mainCommentHasPrecip && willRain && pp >= 50) {
                comment += ` üåÇ ÈôçÊ∞¥Á¢∫ÁéáÈ´ò„ÇÅ„ÄÇ${precipType === 'snow' ? 'Èõ™„Å´Â§â„Çè„Çã„Åã„ÇÇ' : 'Âøµ„ÅÆ„Åü„ÇÅÂÇò„Çí'}`;
            }

            // ============================================================
            // ADD WEATHER FORECAST (worsening/improving)
            // ============================================================
            const willWorsen = weatherData?.willWorsen;
            const willImprove = weatherData?.willImprove;
            const maxFuturePrecip = weatherData?.maxFuturePrecipProb || 0;
            const tempIn3h = weatherData?.tempIn3Hours;

            if (willWorsen && maxFuturePrecip >= 60 && !actualPrecipState.isRaining) {
                comment += ' ‚ö†Ô∏è Êï∞ÊôÇÈñìÂæå„Å´Â§©Ê∞ó„ÅåÂ¥©„Çå„Åù„ÅÜ„Åß„Åô';
            } else if (willWorsen && maxFuturePrecip >= 40 && !actualPrecipState.isRaining) {
                comment += ' üå•Ô∏è „Åì„ÅÆÂæå„ÄÅÈõ≤„ÅåÂ¢ó„Åà„Å¶„Åç„Åù„ÅÜ';
            }

            if (willImprove && !actualPrecipState.isRaining) {
                comment += ' üå§Ô∏è „Åì„Çå„Åã„ÇâÊô¥„Çå„Å¶„Åç„Åæ„Åô';
            } else if (willImprove && actualPrecipState.isRaining) {
                const stopMsg = actualPrecipState.precipType === 'snow' ? 'Èõ™„ÅåÂº±„Åæ„Çä„Åù„ÅÜ' :
                    actualPrecipState.precipType === 'sleet' ? '„Åø„Åû„Çå„Åå‰∏ä„Åå„Çä„Åù„ÅÜ' : 'Èõ®„Åå‰∏ä„Åå„Çä„Åù„ÅÜ';
                comment += ` üåà „ÇÇ„ÅÜÂ∞ë„Åó„Åß${stopMsg}`;
            }

            // Temperature change forecast
            if (tempIn3h && Math.abs(tempIn3h - temp) >= 4) {
                if (tempIn3h > temp) {
                    comment += ` üìà 3ÊôÇÈñìÂæå„ÅØ${tempIn3h.toFixed(0)}¬∞C„Å´‰∏äÊòá`;
                } else {
                    comment += ` üìâ 3ÊôÇÈñìÂæå„ÅØ${tempIn3h.toFixed(0)}¬∞C„Å´‰∏ãÈôç`;
                }
            }

            // ============================================================
            // SEASONAL EVENT COMMENTS
            // ============================================================
            const day = now.getDate();

            // „ÇØ„É™„Çπ„Éû„Çπ (12/24-25)
            if (month === 12 && (day === 24 || day === 25)) {
                comment += pick([
                    ' üéÑ „É°„É™„Éº„ÇØ„É™„Çπ„Éû„ÇπÔºÅÁ¥†Êïµ„Å™1Êó•„Çí',
                    ' üéÖ „ÇØ„É™„Çπ„Éû„ÇπÔºÅÊ∏©„Åã„ÅèÈÅé„Åî„Åó„Å¶„Å≠',
                    ' üåü ËÅñÂ§ú„Å´Âπ∏„Åõ„ÅåË®™„Çå„Åæ„Åô„Çà„ÅÜ„Å´'
                ]);
            }
            // Â§ßÊô¶Êó• (12/31)
            else if (month === 12 && day === 31) {
                comment += pick([
                    ' üéä Â§ßÊô¶Êó•ÔºÅ‰ªäÂπ¥„ÇÇ„ÅäÁñ≤„Çå„Åï„Åæ„Åß„Åó„Åü',
                    ' üîî Âπ¥Ë∂ä„Åó„Åæ„Åß„ÅÇ„Å®Â∞ë„ÅóÔºÅ',
                    ' ‚ú® ËâØ„ÅÑ„ÅäÂπ¥„Çí„ÅäËøé„Åà„Åè„Å†„Åï„ÅÑ'
                ]);
            }
            // ÂÖÉÊó• (1/1)
            else if (month === 1 && day === 1) {
                comment += pick([
                    ' üéç „ÅÇ„Åë„Åæ„Åó„Å¶„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ',
                    ' üåÖ Êñ∞Âπ¥„Åä„ÇÅ„Åß„Å®„ÅÜÔºÅÁ¥†Êïµ„Å™1Âπ¥„Å´',
                    ' üêâ ‰ªäÂπ¥„ÇÇ„Çà„Çç„Åó„Åè„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô'
                ]);
            }
            // „Éê„É¨„É≥„Çø„Ç§„É≥ (2/14)
            else if (month === 2 && day === 14) {
                comment += pick([
                    ' üíù „Éè„ÉÉ„Éî„Éº„Éê„É¨„É≥„Çø„Ç§„É≥ÔºÅ',
                    ' üç´ ‰ªäÊó•„ÅØ„Éê„É¨„É≥„Çø„Ç§„É≥„Éá„Éº',
                    ' üíï Á¥†Êïµ„Å™„Éê„É¨„É≥„Çø„Ç§„É≥„Çí'
                ]);
            }
            // „Å≤„Å™Á•≠„Çä (3/3)
            else if (month === 3 && day === 3) {
                comment += ' üéé „Å≤„Å™Á•≠„ÇäÔºÅ„ÅäÈõõÊßò„ÇíÈ£æ„Çä„Åæ„Åó„Åü„ÅãÔºü';
            }
            // GW (4/29-5/5)
            else if ((month === 4 && day >= 29) || (month === 5 && day <= 5)) {
                comment += pick([
                    ' üå∏ GWÔºÅ„ÅäÂá∫„Åã„ÅëÊó•Âíå„Åß„Åô„Å≠',
                    ' üéè „Ç¥„Éº„É´„Éá„É≥„Ç¶„Ç£„Éº„ÇØÔºÅ',
                    ' üåø ÈÄ£‰ºë„ÇíÊ•Ω„Åó„Çì„Åß'
                ]);
            }
            // ‰∏ÉÂ§ï (7/7)
            else if (month === 7 && day === 7) {
                comment += pick([
                    ' üéã ‰∏ÉÂ§ïÔºÅÈ°ò„ÅÑ‰∫ã„ÅØ‰Ωï„Åß„Åô„ÅãÔºü',
                    ' ‚≠ê ÁπîÂß´„Å®ÂΩ¶Êòü„ÅåÂá∫‰ºö„ÅÜÊó•',
                    ' üåå Êô¥„Çå„Åü„ÇâÂ§©„ÅÆÂ∑ù„ÅåË¶ã„Åà„Çã„Åã„Å™'
                ]);
            }
            // „ÅäÁõÜ (8/13-16)
            else if (month === 8 && day >= 13 && day <= 16) {
                comment += pick([
                    ' üèÆ „ÅäÁõÜ„Åß„Åô„Å≠„ÄÇ„ÅîÂÖàÁ•ñÊßò„Å´ÊÑüË¨ù„Çí',
                    ' üéÜ „ÅäÁõÜ‰ºë„Åø„ÄÅ„ÇÜ„Å£„Åè„ÇäÈÅé„Åî„Åó„Å¶',
                    ' üçâ Â§èÁúü„Å£Áõõ„Çä„ÅÆ„ÅäÁõÜ„Åß„Åô'
                ]);
            }
            // „Éè„É≠„Ç¶„Ç£„É≥ (10/31)
            else if (month === 10 && day === 31) {
                comment += pick([
                    ' üéÉ „Éè„ÉÉ„Éî„Éº„Éè„É≠„Ç¶„Ç£„É≥ÔºÅ',
                    ' üëª „Éà„É™„ÉÉ„ÇØ„Ç™„Ç¢„Éà„É™„Éº„ÉàÔºÅ',
                    ' ü¶á „Éè„É≠„Ç¶„Ç£„É≥„ÅÆÂ§ú„ÄÅÊ•Ω„Åó„Çì„Åß'
                ]);
            }

            // ============================================================
            // HEALTH ADVICE SUFFIXES (expanded x2)
            // ============================================================
            if (isPollenSeason && !isRaining && isMorning) {
                comment += pick([
                    ' üåº Ëä±Á≤â„ÅåÈ£õ„Å≥„ÇÑ„Åô„ÅÑÊúù„ÄÇ„Éû„Çπ„ÇØ„Çí',
                    ' ü§ß Êúù„ÅØËä±Á≤â„ÅåÂ§ö„ÇÅ„ÄÇÂØæÁ≠ñ„Çí‰∏áÂÖ®„Å´',
                    ' üåº Ëä±Á≤âÊ≥®ÊÑè„ÅÆÊúù„ÄÇÁõÆËñ¨„ÇÇÂøò„Çå„Åö„Å´',
                    ' ü§ß Ëä±Á≤â„ÅåËàû„ÅÑ„ÇÑ„Åô„ÅÑÊôÇÈñìÂ∏Ø„ÄÇ„Éû„Çπ„ÇØÂøÖÈ†à',
                    ' üåº Êúù„ÅÆËä±Á≤â„Éî„Éº„ÇØ„ÄÇÁ™ì„ÇíÈñâ„ÇÅ„Å¶',
                    ' ü§ß Ëä±Á≤âÈ£õÊï£‰∏≠„ÄÇÂ∏∞ÂÆÖÂæå„ÅØÊúç„ÇíÊâï„Å£„Å¶'
                ]);
            } else if (isPollenSeason && !isRaining && isAfternoon) {
                comment += pick([
                    ' üåº ÂçàÂæå„ÇÇËä±Á≤â„Å´Ê≥®ÊÑè',
                    ' ü§ß Ëä±Á≤â„ÅØÂ§ïÊñπ„Åæ„ÅßÁ∂ö„Åç„Åæ„Åô',
                    ' üåº Ê¥óÊøØÁâ©„ÅÆÂ§ñÂπ≤„Åó„ÅØË¶ÅÊ≥®ÊÑè',
                    ' ü§ß Ëä±Á≤âÂØæÁ≠ñ„ÇíÁ∂ôÁ∂ö„Åó„Å¶'
                ]);
            } else if (isPollenSeason && !isRaining) {
                comment += pick([
                    ' üåº Ëä±Á≤â„Ç∑„Éº„Ç∫„É≥„ÄÇÂØæÁ≠ñ„ÇíÂøò„Çå„Åö„Å´',
                    ' ü§ß Ëä±Á≤â„ÅåÈ£õ„Çì„Åß„ÅÑ„Åæ„Åô„ÄÇ„ÅîÊ≥®ÊÑè„Çí',
                    ' üåº Ëä±Á≤âÊÉÖÂ†±„Çí„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶',
                    ' ü§ß Ëä±Á≤âÁóá„ÅÆÊñπ„ÅØ„ÅäÂ§ß‰∫ã„Å´'
                ]);
            }

            if (isDrySkinRisk && isWinter && isMorning) {
                comment += pick([
                    ' üíß Á©∫Ê∞ó„Åå„Ç´„É©„Ç´„É©„ÄÇ‰øùÊπø„ÇíÂøò„Çå„Åö„Å´',
                    ' üß¥ ‰πæÁá•Ê≥®ÊÑè„ÄÇ„Éè„É≥„Éâ„ÇØ„É™„Éº„É†„Çí',
                    ' üí® ‰πæÁá•„Åó„ÅüÊúù„ÄÇ„É™„ÉÉ„Éó„ÇØ„É™„Éº„É†„ÇÇ',
                    ' üíß ‰πæÁá•„ÅßËÇåËçí„ÇåÊ≥®ÊÑè„ÄÇ‰øùÊπø„Çí'
                ]);
            } else if (isDrySkinRisk && isWinter) {
                comment += pick([
                    ' üíß Á©∫Ê∞ó„Åå‰πæÁá•‰∏≠„ÄÇ„ÅÆ„Å©È£¥„Åå„ÅÇ„Çã„Å®ÂÆâÂøÉ',
                    ' üß¥ ‰πæÁá•Ê≥®ÊÑè„ÄÇÂä†ÊπøÂô®„Çí„Å§„Åë„Åæ„Åó„Çá„ÅÜ',
                    ' üí® „Ç´„É©„Ç´„É©Á©∫Ê∞ó„ÄÇÊ∞¥ÂàÜ„ÇÇ„Åì„Åæ„ÇÅ„Å´',
                    ' üíß ‰πæÁá•„Åß„Ç¶„Ç§„É´„Çπ„ÇÇÊ¥ªÁô∫„Å´„ÄÇÂØæÁ≠ñ„Çí'
                ]);
            }

            if (isDangerWBGT && !isThunderstorm && !isRaining) {
                comment += pick([
                    ` üÜò WBGT${wbgt.toFixed(0)} ÈÅãÂãïÁ¶ÅÊ≠¢„É¨„Éô„É´`,
                    ` üÜò WBGT${wbgt.toFixed(0)} Â±ãÂ§ñÊ¥ªÂãï„ÅØÂé≥Á¶Å`,
                    ` üÜò WBGT${wbgt.toFixed(0)} ÁÜ±‰∏≠ÁóáË≠¶Êàí„Ç¢„É©„Éº„Éà`,
                    ` üÜò WBGT${wbgt.toFixed(0)} Â§ñÂá∫„ÅØÊéß„Åà„Å¶`
                ]);
            } else if (isHighWBGT && !isRaining) {
                comment += pick([
                    ` ‚ö†Ô∏è WBGT${wbgt.toFixed(0)} ÈÅãÂãï„ÅØÊéß„Åà„ÇÅ„Å´`,
                    ` ‚ö†Ô∏è WBGT${wbgt.toFixed(0)} „Åì„Åæ„ÇÅ„Å´‰ºëÊÜ©„Çí`,
                    ` ‚ö†Ô∏è WBGT${wbgt.toFixed(0)} ÊøÄ„Åó„ÅÑÈÅãÂãï„ÅØÈÅø„Åë„Å¶`,
                    ` ‚ö†Ô∏è WBGT${wbgt.toFixed(0)} Ê∂º„Åó„ÅÑÂ†¥ÊâÄ„Åß‰ºëÊÜ©„Çí`
                ]);
            } else if (isModerateWBGT && !isRaining && isAfternoon) {
                comment += pick([
                    ' ‚ö° Êöë„ÅïÊåáÊï∞Ê≥®ÊÑè„É¨„Éô„É´„ÄÇÈÅ©Â∫¶„Å´‰ºëÊÜ©„Çí',
                    ' ‚ö° ÈÅãÂãïÊôÇ„ÅØÊ∞¥ÂàÜË£úÁµ¶„ÇíÂøò„Çå„Åö„Å´',
                    ' ‚ö° Êó•Èô∞„Åß„ÅÆ‰ºëÊÜ©„ÇíÂøÉ„Åå„Åë„Å¶'
                ]);
            }

            // ============================================================
            // SEASONAL EVENT SUFFIXES (expanded x2)
            // ============================================================
            if (isNewYear && isClear && !isNight) {
                comment += pick([
                    ' üéç ÂàùË©£Êó•Âíå„Åß„Åô„Å≠',
                    ' üéç ËâØ„ÅÑÂπ¥„Å´„Å™„Çä„Åæ„Åô„Çà„ÅÜ„Å´',
                    ' ‚õ©Ô∏è ÂàùË©£„ÅØ„ÅÑ„Åã„ÅåÔºü',
                    ' üåÖ Êñ∞Âπ¥„Çâ„Åó„ÅÑÊ∏Ö„ÄÖ„Åó„Åï',
                    ' üéç „ÅäÊ≠£ÊúàÊ∞óÂàÜ„ÇíÊ∫ÄÂñ´',
                    ' ‚õ©Ô∏è Á•ûÁ§æ‰ªèÈñ£„Å∏ÂàùË©£Êó•Âíå'
                ]);
            } else if (isNewYear && isNight) {
                comment += pick([
                    ' üéç Êñ∞Âπ¥„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô',
                    ' ‚ú® Á¥†Êïµ„Å™„ÅäÊ≠£Êúà„Çí',
                    ' üåô Á©è„ÇÑ„Åã„Å™Ê≠£Êúà„ÅÆÂ§ú„Åß„Åô„Å≠',
                    ' üéç ‰∏â„ÅåÊó•„Çí„ÇÜ„Å£„Åè„Çä„ÅäÈÅé„Åî„Åó„Åè„Å†„Åï„ÅÑ'
                ]);
            } else if (isCherryBlossom && isClear && !isNight && !isRaining) {
                comment += pick([
                    ' üå∏ „ÅäËä±Ë¶ã„Å´„Å¥„Å£„Åü„Çä„ÅÆÈôΩÊ∞ó',
                    ' üå∏ Ê°ú„ÅåË¶ãÈ†É„Åã„ÇÇ',
                    ' üå∑ Êò•ÁàõÊº´„ÄÇ„ÅäËä±Ë¶ãÊó•Âíå',
                    ' üå∏ Ê°ú„ÅÆ‰∏ã„Åß„ÅäÂºÅÂΩì„ÇÇËâØ„ÅÑ„Åß„Åô„Å≠',
                    ' üå∏ Ëä±Ë¶ã„ÅÆË®àÁîª„ÅØ„ÅÑ„Åã„ÅåÔºü',
                    ' üå∑ Êò•„ÅÆÈôΩÊ∞ó„ÇíÊ•Ω„Åó„Çì„Åß'
                ]);
            } else if (isGoldenWeek && isClear && !isRaining) {
                comment += pick([
                    ' üéè GWÊó•ÂíåÔºÅ',
                    ' üéè ÈÄ£‰ºë„ÇíÊ•Ω„Åó„Çì„ÅßÔºÅ',
                    ' üéå „Ç¥„Éº„É´„Éá„É≥„Ç¶„Ç£„Éº„ÇØÊ∫ÄÂñ´Êó•Âíå',
                    ' üöó „Éâ„É©„Ç§„ÉñÊó•Âíå„Åß„Åô„Å≠',
                    ' üéè „ÅäÂá∫„Åã„Åë„ÇíÊ•Ω„Åó„Çì„Åß',
                    ' üåø Êñ∞Á∑ë„ÅåÊ∞óÊåÅ„Å°„ÅÑ„ÅÑÂ≠£ÁØÄ'
                ]);
            } else if (isFireworkSeason && isClear) {
                comment += pick([
                    ' üéÜ Ëä±ÁÅ´Â§ß‰ºöÊó•Âíå',
                    ' üéá Â§è„ÅÆÂ§ú„ÇíÊ•Ω„Åó„Çì„Åß',
                    ' üéÜ Ëä±ÁÅ´„ÅåÁ∂∫È∫ó„Å´Ë¶ã„Åà„Åù„ÅÜ',
                    ' üèÆ Â§èÁ•≠„ÇäÊó•Âíå',
                    ' üéá Êµ¥Ë°£„Åß„ÅäÂá∫„Åã„Åë„ÇÇËâØ„ÅÑ„Åß„Åô„Å≠',
                    ' üéÜ Â§è„ÅÆÈ¢®Áâ©Ë©©„ÇíÊ•Ω„Åó„Çì„Åß'
                ]);
            } else if (isAutumnLeaves && isClear && !isNight) {
                comment += pick([
                    ' üçÅ Á¥ÖËëâÁã©„ÇäÊó•Âíå',
                    ' üçÇ Áßã„ÅÆË°åÊ•ΩÊó•Âíå',
                    ' üçÅ Á¥ÖËëâ„ÅåË¶ãÈ†É„Åã„ÇÇ',
                    ' üçÇ Áßã„ÅÆÊôØËâ≤„ÇíÊ•Ω„Åó„Çì„Åß',
                    ' üçÅ „Ç´„É°„É©„ÇíÊåÅ„Å£„Å¶„ÅäÂá∫„Åã„Åë„Çí',
                    ' üçÇ Áßã„ÅÆÂë≥Ë¶ö„ÇÇÊ•Ω„Åó„Çì„Åß'
                ]);
            } else if (isChristmasDay) {
                // 12/25 „ÇØ„É™„Çπ„Éû„ÇπÂΩìÊó•
                comment += pick([
                    ' üéÑ „É°„É™„Éº„ÇØ„É™„Çπ„Éû„ÇπÔºÅ',
                    ' üéÖ Á¥†Êïµ„Å™„ÇØ„É™„Çπ„Éû„Çπ„ÇíÔºÅ',
                    ' üéÅ „Éó„É¨„Çº„É≥„Éà„ÅØÂ±ä„Åç„Åæ„Åó„Åü„ÅãÔºü',
                    ' ‚≠ê Ê•Ω„Åó„ÅÑ„ÇØ„É™„Çπ„Éû„Çπ„ÇíÔºÅ'
                ]);
            } else if (isChristmasEve) {
                // 12/24 „ÇØ„É™„Çπ„Éû„Çπ„Ç§„Éñ
                comment += pick([
                    ' üéÑ „ÇØ„É™„Çπ„Éû„Çπ„Ç§„Éñ„Åß„Åô„Å≠',
                    ' üéÖ Á¥†Êïµ„Å™„Ç§„Éñ„ÇíÔºÅ',
                    ' üéÅ „Çµ„É≥„Çø„Åï„Çì„ÅåÊù•„Çã„Åã„ÇÇ',
                    ' ‚≠ê ËÅñ„Å™„ÇãÂ§ú„ÇíÊ•Ω„Åó„Çì„Åß'
                ]);
            } else if (isChristmasEveEve && isClear) {
                // 12/23 ÂâçÊó•
                comment += pick([
                    ' üéÑ ÊòéÊó•„ÅØ„Ç§„Éñ„Åß„Åô„Å≠',
                    ' üéÖ „ÇØ„É™„Çπ„Éû„ÇπÊ∫ñÂÇô„ÅØ„ÅäÊ∏à„Åø„Åß„Åô„ÅãÔºü'
                ]);
            } else if (isYearEnd) {
                comment += pick([
                    ' üéç ËâØ„ÅÑ„ÅäÂπ¥„Çí',
                    ' ‚ú® Á¥†Êïµ„Å™Âπ¥Êú´„Çí',
                    ' üßπ Â§ßÊéÉÈô§„ÅØÈÄ≤„Çì„Åß„Åæ„Åô„ÅãÔºü',
                    ' üéç Âπ¥Êú´„ÅÆÊÖå„Åü„Å†„Åó„Åï„ÇÇÊ•Ω„Åó„Çì„Åß',
                    ' ‚ú® ‰ªäÂπ¥„ÇÇ„ÅäÁñ≤„ÇåÊßò„Åß„Åó„Åü',
                    ' üéç ËâØ„ÅÑÂπ¥Ë∂ä„Åó„Çí'
                ]);
            }

            // ============================================================
            // DAY OF WEEK SUFFIXES (expanded x2)
            // ‰ªªÊÑèÊÉÖÂ†±„Å™„ÅÆ„ÅßÁ¢∫ÁéáÂà∂ÈôêÔºà50%Ôºâ„Å®„Çµ„Éï„Ç£„ÉÉ„ÇØ„ÇπÊï∞Âà∂Èôê„ÇíÈÅ©Áî®
            // ============================================================
            if (isWeekend && isClear && !isRaining && isMorning && temp >= 15 && temp <= 28 &&
                optionalSuffixCount < MAX_OPTIONAL_SUFFIXES && Math.random() < 0.5) {
                const weekendTips = [
                    ' üèÉ „ÅäÂá∫„Åã„ÅëÊó•ÂíåÔºÅ',
                    ' üß∫ Ê¥óÊøØÊó•Âíå„Åß„Åô„Å≠',
                    ' üö≤ „Çµ„Ç§„ÇØ„É™„É≥„Ç∞Êó•Âíå',
                    ' üå≥ ÂÖ¨Âúí„Åß„Éî„ÇØ„Éã„ÉÉ„ÇØ„ÇÇËâØ„ÅÑ',
                    ' ‚òï „Ç´„Éï„Çß„Åß„ÅÆ„Çì„Å≥„Çä„ÇÇ',
                    ' üì∑ ÂÜôÁúüÊó•Âíå„Åß„Åô„Å≠'
                ];
                comment += pick(weekendTips);
                optionalSuffixCount++;
            } else if (isWeekend && isClear && !isRaining && isAfternoon && temp >= 15 && temp <= 28 &&
                optionalSuffixCount < MAX_OPTIONAL_SUFFIXES && Math.random() < 0.5) {
                const weekendAfternoonTips = [
                    ' üõçÔ∏è „ÅäË≤∑„ÅÑÁâ©Êó•Âíå',
                    ' üç∞ „Ç´„Éï„Çß„Çø„Ç§„É†„Å´„Å¥„Å£„Åü„Çä',
                    ' üé¨ Êò†ÁîªÈ§®„ÇÇ„ÅÑ„ÅÑ„Åß„Åô„Å≠',
                    ' üö∂ Êï£Ê≠©Êó•Âíå„Åß„Åô'
                ];
                comment += pick(weekendAfternoonTips);
                optionalSuffixCount++;
            } else if (isWeekend && isEvening && !isRaining && temp >= 10) {
                const weekendEveningTips = [
                    ' üçΩÔ∏è Â§ñÈ£üÊó•Âíå„Åã„ÇÇ',
                    ' üåÉ Â§úÊôØ„ÇíË¶ã„Å´Ë°å„Åè„ÅÆ„ÇÇ„ÅÑ„ÅÑ',
                    ' üé≠ ÈÄ±Êú´„ÅÆÂ§ú„ÇíÊ•Ω„Åó„Çì„Åß'
                ];
                comment += pick(weekendEveningTips);
            } else if (isMonday && isMorning && !isRaining &&
                optionalSuffixCount < MAX_OPTIONAL_SUFFIXES && Math.random() < 0.6) {
                comment += pick([
                    ' üí™ ‰ªäÈÄ±„ÇÇÈ†ëÂºµ„Çä„Åæ„Åó„Çá„ÅÜ',
                    ' ‚òï „Ç≥„Éº„Éí„Éº„ÅßÁõÆ„ÇíË¶ö„Åæ„Åó„Å¶',
                    ' üåü ËâØ„ÅÑ1ÈÄ±Èñì„Å´„Å™„Çä„Åæ„Åô„Çà„ÅÜ„Å´',
                    ' üíº ‰ªäÈÄ±„ÇÇ„Éï„Ç°„Ç§„ÉàÔºÅ',
                    ' üåà ÊúàÊõú„Çí‰πó„ÇäË∂ä„Åà„Çå„Å∞Ê•Ω„Å´„Å™„Çã',
                    ' üí™ ‰ªäÈÄ±„ÅÆÁõÆÊ®ô„ÅØ‰Ωï„Åß„Åô„ÅãÔºü'
                ]);
                optionalSuffixCount++;
            } else if (isMonday && isMorning && isRaining) {
                comment += pick([
                    ' ‚òî Èõ®„ÅÆÊúàÊõú„Å†„Åë„Å©È†ëÂºµ„Å£„Å¶',
                    ' üåßÔ∏è Ë∂≥ÂÖÉ„Å´Ê∞ó„Çí„Å§„Åë„Å¶Âá∫Âã§„Çí',
                    ' ‚òÇÔ∏è ÂÇò„ÇíÂøò„Çå„Åö„Å´„ÄÇËâØ„ÅÑ1ÈÄ±Èñì„Çí'
                ]);
            } else if (isFriday && isAfternoon) {
                comment += pick([
                    ' üéâ „ÇÇ„ÅÜ„Åô„ÅêÈÄ±Êú´ÔºÅ',
                    ' ‚ú® „ÅÇ„Å®Â∞ë„Åó„ÅßÈÄ±Êú´',
                    ' üåü ÈáëÊõúÊó•„ÅÆÂçàÂæå„ÄÇ„ÇÇ„ÅÜ‰∏ÄË∏è„ÇìÂºµ„Çä'
                ]);
            } else if (isFriday && isEvening) {
                comment += pick([
                    ' üçª ÈÄ±Êú´„Åß„Åô„Å≠',
                    ' üéä TGIFÔºÅÈÄ±Êú´„ÇíÊ•Ω„Åó„Çì„Åß',
                    ' üç∫ „ÅäÁñ≤„ÇåÊßò„Åß„Åó„ÅüÔºÅ',
                    ' üéâ ÈÄ±Êú´„ÅÆÂßã„Åæ„ÇäÔºÅ',
                    ' üåÉ ÈáëÊõú„ÅÆÂ§ú„ÇíÊ∫ÄÂñ´„Åó„Åæ„Åó„Çá„ÅÜ',
                    ' üç∑ „ÇÜ„Å£„Åè„Çä‰ºë„Çì„Åß„Åè„Å†„Åï„ÅÑ„Å≠'
                ]);
            }

            // ============================================================
            // HYDRATION REMINDER (expanded x2)
            // ============================================================
            if (isDehydrationRisk && !isRaining && !isNight) {
                const hydrationTips = [
                    ' üíß Ê∞¥ÂàÜË£úÁµ¶„Çí',
                    ' ü•§ „Åì„Åæ„ÇÅ„Å´Ê∞¥ÂàÜ„Çí',
                    ' üí¶ ËÑ±Ê∞¥„Å´Ê≥®ÊÑè',
                    ' üßä ÂÜ∑„Åü„ÅÑÈ£≤„ÅøÁâ©„ÅßÊ∞¥ÂàÜË£úÁµ¶„Çí',
                    ' üíß „ÅÆ„Å©„ÅåÊ∏á„ÅèÂâç„Å´Ê∞¥ÂàÜ„Çí',
                    ' ü•§ „Çπ„Éù„Éâ„É™„ÇÇ„Åä„Åô„Åô„ÇÅ'
                ];
                if (!comment.includes('Ê∞¥ÂàÜ') && !comment.includes('üíß') && !comment.includes('ü•§')) {
                    comment += pick(hydrationTips);
                }
            }

            // ============================================================
            // LAUNDRY & OUTDOOR SUFFIXES (NEW)
            // ============================================================
            if (isClear && isDry && !isRaining && isMorning && !isNight && temp >= 15 && temp <= 30 && !isWeekend) {
                if (Math.random() < 0.3) { // 30% chance to show
                    comment += pick([
                        ' üß∫ Ê¥óÊøØÁâ©„Åå„Çà„Åè‰πæ„Åç„Åù„ÅÜ',
                        ' üëï Â∏ÉÂõ£Âπ≤„ÅóÊó•Âíå',
                        ' üåû „Ç∑„Éº„ÉÑ„ÇíÊ¥ó„ÅÜ„ÅÆ„Å´„Å¥„Å£„Åü„Çä'
                    ]);
                }
            }

            // ============================================================
            // PET SAFETY SUFFIXES (NEW)
            // ============================================================
            if (temp >= 30 && isClear && isAfternoon && !isRaining) {
                if (Math.random() < 0.25) { // 25% chance
                    comment += pick([
                        ' üêï „Éö„ÉÉ„Éà„ÅÆÊï£Ê≠©„ÅØ„Ç¢„Çπ„Éï„Ç°„É´„Éà„ÅåÂÜ∑„ÇÅ„Å¶„Åã„Çâ',
                        ' üê∂ „ÉØ„É≥„Å°„ÇÉ„Çì„ÅÆËÇâÁêÉÁÅ´ÂÇ∑Ê≥®ÊÑè',
                        ' üêæ „ÅäÊï£Ê≠©„ÅØÊ∂º„Åó„ÅÑÊôÇÈñìÂ∏Ø„Å´'
                    ]);
                }
            }
            // (Ë≠¶Â†±Âá¶ÁêÜ„ÅØ‰∏äÈÉ®„ÅÆÂÑ™ÂÖà„Çµ„Éï„Ç£„ÉÉ„ÇØ„Çπ„Çª„ÇØ„Ç∑„Éß„É≥„Å´ÁßªÂãïÊ∏à„Åø)

            // Save comment and condition key for next comparison
            lastComment = comment;
            lastConditionKey = conditionKey;

            // Update Weather Hero Section
            const heroTempEl = document.getElementById('heroTemp');
            const tempParts = temp.toFixed(1).split('.');
            const newTempHtml = `${tempParts[0]}<span class="temp-decimal">.${tempParts[1]}</span>`;

            // Only trigger animation if temperature actually changed
            if (heroTempEl.innerHTML !== newTempHtml) {
                heroTempEl.innerHTML = newTempHtml;
                // Trigger pulse animation
                heroTempEl.classList.remove('temp-updated');
                void heroTempEl.offsetWidth; // Force reflow to restart animation
                heroTempEl.classList.add('temp-updated');
            }

            // Apply temperature-based color
            heroTempEl.classList.remove('temp-freezing', 'temp-cold', 'temp-cool', 'temp-mild', 'temp-warm', 'temp-hot', 'temp-extreme');
            if (temp < 0) heroTempEl.classList.add('temp-freezing');
            else if (temp < 10) heroTempEl.classList.add('temp-cold');
            else if (temp < 15) heroTempEl.classList.add('temp-cool');
            else if (temp < 20) heroTempEl.classList.add('temp-mild');
            else if (temp < 25) heroTempEl.classList.add('temp-warm');
            else if (temp < 30) heroTempEl.classList.add('temp-hot');
            else heroTempEl.classList.add('temp-extreme');

            // Update --temp-hue CSS variable for dynamic gradient colors
            // Blue (220) for cold ‚Üí Green (120) for mild ‚Üí Orange (30) ‚Üí Red (0) for hot
            const tempHue = temp <= -10 ? 220 :      // Freezing: deep blue
                temp <= 0 ? 200 :         // Very cold: blue
                    temp <= 10 ? 180 :        // Cold: cyan
                        temp <= 15 ? 160 :        // Cool: teal
                            temp <= 20 ? 120 :        // Mild: green
                                temp <= 25 ? 60 :         // Warm: yellow-green
                                    temp <= 30 ? 30 :         // Hot: orange
                                        temp <= 35 ? 15 :         // Very hot: orange-red
                                            0;                        // Extreme: red
            document.documentElement.style.setProperty('--temp-hue', tempHue);

            // Frost intensity: increases as temperature drops below 5¬∞C
            // 5¬∞C = 0% frost, 0¬∞C = 30% frost, -10¬∞C = 100% frost
            let frostIntensity = 0;
            if (temp < 5) {
                frostIntensity = Math.min(1, (5 - temp) / 15); // 0 at 5¬∞C, 1 at -10¬∞C
            }
            document.documentElement.style.setProperty('--frost-intensity', frostIntensity);

            // Update weather icon
            document.getElementById('heroWeatherIcon').textContent = emoji;

            document.getElementById('heroCondition').textContent = getWeatherConditionName(wc);
            document.getElementById('heroFeelsLike').textContent = fl.toFixed(1);
            document.getElementById('heroHumidity').textContent = Math.round(humidity);
            document.getElementById('heroWind').textContent = ws.toFixed(1);
            document.getElementById('heroPrecip').textContent = pp || 0;

            // Update comment section (remove temperature display)
            let cleanComment = comment
                .replace(/<span class="temp-highlight">[0-9.-]+¬∞C<\/span>/g, '')
                .replace(/[„Éª‚Äî]\s*/g, '')
                .trim();
            // Remove leading dash or bullet that may remain
            cleanComment = cleanComment.replace(/^[‚Äî„Éª\-]\s*/, '');
            document.getElementById('weatherComment').innerHTML = cleanComment;
            document.getElementById('greetingSection').classList.add('show');
        }

        // Get weather condition name from WMO code + cloud cover (Enhanced)
        function getWeatherConditionName(code, cloudCover = null) {
            // For clear/cloudy conditions (codes 0-3), use cloud cover for precision
            if (code >= 0 && code <= 3 && cloudCover !== null) {
                if (cloudCover <= 10) return 'Âø´Êô¥';
                if (cloudCover <= 25) return '„Åª„ÅºÊô¥„Çå';
                if (cloudCover <= 50) return 'Êô¥„Çå';
                if (cloudCover <= 70) return 'Êô¥„ÇåÊôÇ„ÄÖÊõá„Çä';
                if (cloudCover <= 85) return '„ÇÑ„ÇÑÊõá„Çä';
                return 'Êõá„Çä';
            }

            // Standard WMO code mapping for other conditions
            const conditions = {
                0: 'Âø´Êô¥',
                1: '„Åª„ÅºÊô¥„Çå',
                2: 'Êô¥„ÇåÊôÇ„ÄÖÊõá„Çä',
                3: 'Êõá„Çä',
                45: 'Èúß',
                48: 'ÁùÄÊ∞∑ÊÄß„ÅÆÈúß',
                51: 'Âº±„ÅÑÈúßÈõ®',
                53: 'ÈúßÈõ®',
                55: 'Âº∑„ÅÑÈúßÈõ®',
                56: 'ÁùÄÊ∞∑ÊÄß„ÅÆÈúßÈõ®',
                57: 'Âº∑„ÅÑÁùÄÊ∞∑ÊÄßÈúßÈõ®',
                61: 'Âº±„ÅÑÈõ®',
                63: 'Èõ®',
                65: 'Âº∑„ÅÑÈõ®',
                66: 'ÁùÄÊ∞∑ÊÄß„ÅÆÈõ®',
                67: 'Âº∑„ÅÑÁùÄÊ∞∑ÊÄß„ÅÆÈõ®',
                71: 'Âº±„ÅÑÈõ™',
                73: 'Èõ™',
                75: 'Â§ßÈõ™',
                77: 'ÈúßÈõ™',
                80: '„Å´„Çè„ÅãÈõ®',
                81: '„ÇÑ„ÇÑÂº∑„ÅÑ„Å´„Çè„ÅãÈõ®',
                82: 'ÊøÄ„Åó„ÅÑ„Å´„Çè„ÅãÈõ®',
                85: '„Å´„Çè„ÅãÈõ™',
                86: 'ÊøÄ„Åó„ÅÑ„Å´„Çè„ÅãÈõ™',
                95: 'Èõ∑Èõ®',
                96: 'Èõ∑Èõ®ÔºàÈõπ„Çí‰º¥„ÅÜÔºâ',
                99: 'ÊøÄ„Åó„ÅÑÈõ∑Èõ®ÔºàÈõπÔºâ'
            };
            return conditions[code] || '--';
        }

        function updateCharts() { updateChart24h(); updateChartWeek(); updateChartMonthly(); updateChartYearly(); }

        const baseOptions = {
            responsive: true,
            maintainAspectRatio: false,
            // Optimized interaction for mobile touch
            interaction: {
                intersect: false,
                mode: 'index',
                axis: 'x'  // Only detect on x-axis for smoother sliding
            },
            // Smooth animations for mobile
            animation: {
                duration: 150
            },
            hover: {
                animationDuration: 0,
                mode: 'index',
                intersect: false
            },
            // Reduce redraws on resize
            resizeDelay: 100,
            // Layout padding for touch
            layout: {
                padding: { left: 5, right: 10, top: 5, bottom: 5 }
            },
            // Dataset element animations
            elements: {
                point: {
                    radius: 0,  // Hide points for cleaner look
                    hoverRadius: 5,
                    hitRadius: 10  // Larger hit area for touch
                },
                line: {
                    tension: 0.3  // Smooth curves
                }
            },
            plugins: {
                legend: { labels: { color: '#94a3b8', font: { size: 11, weight: '500' }, usePointStyle: true, padding: 20 } },
                tooltip: {
                    enabled: true,
                    backgroundColor: 'rgba(15, 23, 42, 0.95)',
                    titleColor: '#f8fafc',
                    bodyColor: '#cbd5e1',
                    borderColor: 'rgba(99, 102, 241, 0.4)',
                    borderWidth: 1,
                    padding: 14,
                    cornerRadius: 12,
                    displayColors: true,
                    titleFont: { weight: '600' },
                    // Smooth tooltip transitions
                    animation: {
                        duration: 80,
                        easing: 'easeOutQuart'
                    },
                    // Tooltip stays put on touch devices
                    position: 'nearest',
                    callbacks: {
                        label: function (context) {
                            let label = context.dataset.label || '';
                            if (label) label += ': ';
                            if (context.parsed.y !== null) {
                                const unit = label.includes('ÊπøÂ∫¶') ? '%' : '¬∞C';
                                label += context.parsed.y.toFixed(1) + unit;
                            }
                            return label;
                        }
                    }
                }
            },
            scales: {
                x: { grid: { color: 'rgba(148, 163, 184, 0.06)' }, ticks: { color: '#64748b', font: { size: 10 }, maxRotation: 45 } },
                y: { grid: { color: 'rgba(148, 163, 184, 0.06)' }, ticks: { color: '#64748b', font: { size: 10 }, callback: function (value) { return value + '¬∞C'; } } }
            }
        };

        const crosshairPlugin = {
            id: 'crosshair',
            afterDraw: (chart) => {
                if (chart.tooltip?._active?.length) {
                    const ctx = chart.ctx;
                    const x = chart.tooltip._active[0].element.x;
                    ctx.save();
                    ctx.beginPath();
                    ctx.moveTo(x, chart.chartArea.top);
                    ctx.lineTo(x, chart.chartArea.bottom);
                    ctx.lineWidth = 1;
                    ctx.strokeStyle = 'rgba(139, 92, 246, 0.4)';
                    ctx.setLineDash([4, 4]);
                    ctx.stroke();
                    ctx.restore();
                }
            }
        };

        function updateChart24h() {
            // Use weeklyData if available, otherwise fall back to recentData
            const sourceData = weeklyData.length > 0 ? weeklyData : recentData;
            if (!sourceData.length) return;

            const now = Date.now();
            const cutoff24h = new Date(now - 24 * 60 * 60 * 1000);  // 24h ago
            const cutoff48h = new Date(now - 48 * 60 * 60 * 1000);  // 48h ago (for yesterday comparison)

            // Use only 48h of data (no zoom/pan needed)
            let chartData = sourceData.filter(d => d.date >= cutoff48h);

            // Sort by date
            chartData.sort((a, b) => a.date - b.date);

            // Prepare data for Chart.js with time scale
            const tempData = chartData.map(d => ({ x: d.date, y: d.temperature }));
            const humidData = chartData.map(d => ({ x: d.date, y: d.humidity }));

            // Create "yesterday comparison" data by shifting each point +24h
            const yesterdayData = chartData
                .filter(d => d.date < cutoff24h)
                .map(d => ({
                    x: new Date(d.date.getTime() + 24 * 60 * 60 * 1000),  // Shift +24h
                    y: d.temperature
                }));

            // Detect mobile screen
            const isMobile = window.innerWidth <= 600;
            const tickFontSize = isMobile ? 8 : 10;
            const showAxisTitle = !isMobile;

            const ctx = document.getElementById('chart24h').getContext('2d');
            if (charts.chart24h) charts.chart24h.destroy();
            charts.chart24h = new Chart(ctx, {
                type: 'line',
                plugins: [crosshairPlugin],
                data: {
                    datasets: [
                        {
                            label: 'Ê∞óÊ∏©',
                            data: tempData,
                            borderColor: '#fb923c',
                            backgroundColor: 'rgba(251, 146, 60, 0.05)',
                            fill: false,
                            tension: 0.4,
                            borderWidth: 3,
                            pointRadius: 0,
                            pointHoverRadius: 6,
                            yAxisID: 'y',
                            order: 1
                        },
                        {
                            label: 'ÂâçÊó•„ÅÆÊ∞óÊ∏©',
                            data: yesterdayData,
                            borderColor: '#94a3b8',
                            borderDash: [4, 4],
                            backgroundColor: 'transparent',
                            fill: false,
                            tension: 0.4,
                            borderWidth: 1.5,
                            pointRadius: 0,
                            pointHoverRadius: 4,
                            yAxisID: 'y',
                            order: 2,
                            spanGaps: true
                        },
                        {
                            label: 'ÊπøÂ∫¶',
                            data: humidData,
                            borderColor: 'transparent',
                            backgroundColor: 'rgba(34, 211, 238, 0.12)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 0,
                            pointRadius: 0,
                            pointHoverRadius: 0,
                            yAxisID: 'y1',
                            order: 3
                        }
                    ]
                },
                options: {
                    ...baseOptions,
                    scales: {
                        x: {
                            type: 'time',
                            time: {
                                unit: 'hour',
                                displayFormats: {
                                    hour: 'M/d HÊôÇ',
                                    day: 'M/d'
                                },
                                tooltipFormat: 'M/d H:mm'
                            },
                            min: cutoff24h,  // Initial view: last 24 hours
                            max: new Date(now),
                            ticks: {
                                color: '#94a3b8',
                                font: { size: tickFontSize },
                                maxTicksLimit: isMobile ? 6 : 12,
                                maxRotation: 0
                            },
                            grid: { color: 'rgba(148, 163, 184, 0.06)' }
                        },
                        y: {
                            grid: { color: 'rgba(148, 163, 184, 0.06)' },
                            position: 'left',
                            title: { display: showAxisTitle, text: '¬∞C', color: '#fb923c', font: { size: 11, weight: '600' } },
                            ticks: {
                                color: '#fb923c',
                                font: { size: tickFontSize },
                                callback: function (value) { return value + '¬∞'; }
                            }
                        },
                        y1: {
                            grid: { drawOnChartArea: false },
                            position: 'right',
                            title: { display: showAxisTitle, text: '%', color: '#22d3ee', font: { size: 11, weight: '600' } },
                            ticks: {
                                color: '#22d3ee',
                                font: { size: tickFontSize },
                                callback: function (value) { return value + '%'; }
                            }
                        }
                    },
                    plugins: {
                        ...baseOptions.plugins,
                        tooltip: {
                            ...baseOptions.plugins.tooltip,
                            // Only trigger tooltip from Ê∞óÊ∏© (today's data)
                            filter: function (tooltipItem) {
                                return tooltipItem.dataset.label === 'Ê∞óÊ∏©' || tooltipItem.dataset.label === 'ÊπøÂ∫¶';
                            },
                            callbacks: {
                                ...baseOptions.plugins.tooltip.callbacks,
                                label: function (context) {
                                    let label = context.dataset.label || '';
                                    if (label) label += ': ';
                                    if (context.parsed.y !== null && context.parsed.y !== undefined) {
                                        const unit = label.includes('ÊπøÂ∫¶') ? '%' : '¬∞C';
                                        label += context.parsed.y.toFixed(1) + unit;
                                    }
                                    return label;
                                },
                                afterBody: function (tooltipItems) {
                                    if (!tooltipItems.length) return '';

                                    // hoveredTime is milliseconds timestamp from parsed.x
                                    const hoveredTime = tooltipItems[0].parsed.x;

                                    // Find corresponding yesterday's temp from yesterdayData
                                    // yesterdayData has {x: Date, y: temperature}
                                    const yesterdayPoint = yesterdayData.find(d => {
                                        const dataTime = d.x.getTime ? d.x.getTime() : d.x;
                                        return Math.abs(dataTime - hoveredTime) < 2 * 60 * 1000;  // 2min tolerance
                                    });

                                    if (yesterdayPoint) {
                                        return `‚ñ† ÂâçÊó•„ÅÆÊ∞óÊ∏©: ${yesterdayPoint.y.toFixed(1)}¬∞C`;
                                    }
                                    return '';
                                }
                            }
                        }
                    }
                }
            });
        }

        function updateChartWeek() {
            const sourceData = weeklyData.length > 0 ? weeklyData : recentData;
            if (!sourceData.length) return;
            const sampled = sourceData.filter((_, i) => i % 30 === 0);

            const ctx = document.getElementById('chartWeek').getContext('2d');
            if (charts.chartWeek) charts.chartWeek.destroy();
            charts.chartWeek = new Chart(ctx, {
                type: 'line',
                plugins: [crosshairPlugin],
                data: {
                    labels: sampled.map(d => {
                        const days = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
                        const date = d.date.toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric' });
                        const day = days[d.date.getDay()];
                        const time = d.date.toLocaleTimeString('ja-JP', { hour: '2-digit' });
                        return `${date}(${day}) ${time}`;
                    }),
                    datasets: [{ label: 'Ê∞óÊ∏©', data: sampled.map(d => d.temperature), borderColor: '#a78bfa', backgroundColor: 'rgba(167, 139, 250, 0.1)', fill: true, tension: 0.4, borderWidth: 2, pointRadius: 0, pointHoverRadius: 5 }]
                },
                options: baseOptions
            });
        }

        function updateChartMonthly() {
            if (!dailyData.length) return;
            const monthly = {};
            dailyData.forEach(d => {
                const key = `${d.date.getFullYear()}-${String(d.date.getMonth() + 1).padStart(2, '0')}`;
                if (!monthly[key]) monthly[key] = { temps: [], mins: [], date: new Date(d.date.getFullYear(), d.date.getMonth(), 1) };
                monthly[key].temps.push(d.max);
                monthly[key].mins.push(d.min);
            });
            const data = Object.values(monthly).map(m => ({ date: m.date, max: Math.max(...m.temps), min: Math.min(...m.mins) })).sort((a, b) => a.date - b.date);

            const ctx = document.getElementById('chartMonthly').getContext('2d');
            if (charts.chartMonthly) charts.chartMonthly.destroy();
            charts.chartMonthly = new Chart(ctx, {
                type: 'bar',
                plugins: [crosshairPlugin],
                data: {
                    labels: data.map(d => d.date.toLocaleDateString('ja-JP', { year: '2-digit', month: 'short' })),
                    datasets: [
                        { label: 'ÊúÄÈ´ò', data: data.map(d => d.max), backgroundColor: 'rgba(248, 113, 113, 0.75)', borderColor: '#f87171', borderWidth: 0, borderRadius: 6 },
                        { label: 'ÊúÄ‰Ωé', data: data.map(d => d.min), backgroundColor: 'rgba(96, 165, 250, 0.75)', borderColor: '#60a5fa', borderWidth: 0, borderRadius: 6 }
                    ]
                },
                options: baseOptions
            });
        }

        function updateChartYearly() {
            if (!dailyData.length) return;
            const ctx = document.getElementById('chartYearly').getContext('2d');
            if (charts.chartYearly) charts.chartYearly.destroy();
            charts.chartYearly = new Chart(ctx, {
                type: 'line',
                plugins: [crosshairPlugin],
                data: {
                    labels: dailyData.map(d => {
                        const days = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
                        const year = d.date.getFullYear();
                        const date = d.date.toLocaleDateString('ja-JP', { month: 'numeric', day: 'numeric' });
                        const day = days[d.date.getDay()];
                        return `${year}/${date}(${day})`;
                    }),
                    datasets: [
                        { label: 'Êó•ÊúÄÈ´ò', data: dailyData.map(d => d.max), borderColor: '#f87171', backgroundColor: 'rgba(248, 113, 113, 0.12)', fill: '+1', tension: 0.3, borderWidth: 1.5, pointRadius: 0, pointHoverRadius: 4 },
                        { label: 'Êó•ÊúÄ‰Ωé', data: dailyData.map(d => d.min), borderColor: '#60a5fa', backgroundColor: 'rgba(96, 165, 250, 0.08)', fill: false, tension: 0.3, borderWidth: 1.5, pointRadius: 0, pointHoverRadius: 4 }
                    ]
                },
                options: baseOptions
            });
        }

        function updateCountdown() {
            if (!nextUpdateTime) return;
            const remaining = Math.max(0, nextUpdateTime - Date.now());
            const minutes = Math.floor(remaining / 60000);
            const seconds = Math.floor((remaining % 60000) / 1000);
            document.getElementById('nextUpdate').textContent = `${minutes}:${String(seconds).padStart(2, '0')}`;
        }

        async function init() {
            await fetchAll();
            loadSunTimes(); // Load sunrise/sunset times
            nextUpdateTime = Date.now() + UPDATE_INTERVAL;
            setInterval(updateCountdown, 1000);
            setInterval(() => { fetchAll(); nextUpdateTime = Date.now() + UPDATE_INTERVAL; }, UPDATE_INTERVAL);

            // Fix chart resize issue - redraw charts completely on resize
            let resizeTimeout;
            window.addEventListener('resize', () => {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => { updateCharts(); }, 250);
            });

            // Pull-to-refresh for mobile
            let touchStartY = 0;
            let isPulling = false;
            const pullIndicator = document.getElementById('pullToRefresh');

            document.addEventListener('touchstart', (e) => {
                if (window.scrollY === 0) {
                    touchStartY = e.touches[0].clientY;
                    isPulling = true;
                }
            }, { passive: true });

            document.addEventListener('touchmove', (e) => {
                if (!isPulling) return;
                const touchY = e.touches[0].clientY;
                const pullDistance = touchY - touchStartY;

                if (pullDistance > 50 && window.scrollY === 0) {
                    pullIndicator.classList.add('visible');
                } else {
                    pullIndicator.classList.remove('visible');
                }
            }, { passive: true });

            document.addEventListener('touchend', async () => {
                if (pullIndicator.classList.contains('visible')) {
                    pullIndicator.classList.add('refreshing');
                    pullIndicator.querySelector('span').textContent = 'Êõ¥Êñ∞‰∏≠...';

                    await fetchAll();
                    nextUpdateTime = Date.now() + UPDATE_INTERVAL;

                    pullIndicator.querySelector('span').textContent = 'Êõ¥Êñ∞ÂÆå‰∫ÜÔºÅ';
                    setTimeout(() => {
                        pullIndicator.classList.remove('visible', 'refreshing');
                        pullIndicator.querySelector('span').textContent = 'Âºï„Å£Âºµ„Å£„Å¶Êõ¥Êñ∞';
                    }, 1000);
                }
                isPulling = false;
            });
        }

        // Toggle AI advisor expand/collapse
        function toggleAiAdvisor() {
            const textEl = document.getElementById('aiAdvisorText');
            const expandBtn = document.getElementById('aiAdvisorExpand');

            if (textEl.dataset.truncated === 'true') {
                // Expand to full text
                textEl.innerHTML = textEl.dataset.fullText;
                textEl.dataset.truncated = 'false';
                expandBtn.textContent = 'Èñâ„Åò„Çã';
            } else {
                // Collapse back
                const fullText = textEl.dataset.fullText;
                // Re-truncate (we need original plain text, but can approximate)
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = fullText;
                const plainText = tempDiv.textContent;

                let breakPoint = 150;
                while (breakPoint > 100 && plainText[breakPoint] !== ' ') {
                    breakPoint--;
                }
                const truncated = plainText.substring(0, breakPoint) + '...';
                textEl.innerHTML = truncated;
                textEl.dataset.truncated = 'true';
                expandBtn.textContent = 'Á∂ö„Åç„ÇíË°®Á§∫';
            }
        }

        // =====================================================
        // CHART CARD DRAG & DROP REORDERING (Enhanced)
        // =====================================================
        function initChartReordering() {
            const chartsGrid = document.getElementById('chartsGrid');
            if (!chartsGrid) return;

            let draggedElement = null;
            let placeholder = null;
            let touchStartY = 0;
            let touchStartX = 0;
            let longPressTimer = null;
            let isTouchDragging = false;
            let originalRect = null;

            // Load saved order from localStorage
            const savedOrder = localStorage.getItem('chartOrder');
            if (savedOrder) {
                try {
                    const order = JSON.parse(savedOrder);
                    const cards = Array.from(chartsGrid.querySelectorAll('.chart-card'));
                    const sortedCards = order.map(id => cards.find(c => c.dataset.chartId === id)).filter(Boolean);

                    // Add any missing cards (new charts)
                    cards.forEach(card => {
                        if (!sortedCards.includes(card)) sortedCards.push(card);
                    });

                    sortedCards.forEach(card => chartsGrid.appendChild(card));
                    console.log('[Charts] Loaded saved order:', order);
                } catch (e) {
                    console.log('[Charts] Failed to load saved order');
                }
            }

            // Create placeholder element
            function createPlaceholder(height) {
                const ph = document.createElement('div');
                ph.className = 'drag-placeholder';
                ph.style.height = height + 'px';
                return ph;
            }

            // Haptic feedback for mobile
            function vibrate() {
                if (navigator.vibrate) {
                    navigator.vibrate(50);
                }
            }

            // Add drop animation
            function animateDrop(card) {
                card.classList.add('drop-animation');
                setTimeout(() => card.classList.remove('drop-animation'), 400);
            }

            // ========== PC MOUSE DRAG ==========

            // Drag start
            chartsGrid.addEventListener('dragstart', (e) => {
                const card = e.target.closest('.chart-card');
                if (!card) return;

                draggedElement = card;
                originalRect = card.getBoundingClientRect();

                // Create and insert placeholder
                placeholder = createPlaceholder(originalRect.height);
                card.parentNode.insertBefore(placeholder, card.nextSibling);

                card.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/plain', card.dataset.chartId);

                // Set drag image (slightly transparent)
                if (e.dataTransfer.setDragImage) {
                    const clone = card.cloneNode(true);
                    clone.style.opacity = '0.8';
                    clone.style.position = 'absolute';
                    clone.style.top = '-9999px';
                    document.body.appendChild(clone);
                    e.dataTransfer.setDragImage(clone, originalRect.width / 2, 30);
                    setTimeout(() => document.body.removeChild(clone), 0);
                }
            });

            // Drag end
            chartsGrid.addEventListener('dragend', (e) => {
                const card = e.target.closest('.chart-card');
                if (card) {
                    card.classList.remove('dragging');
                    animateDrop(card);
                }

                // Remove placeholder
                if (placeholder && placeholder.parentNode) {
                    placeholder.parentNode.removeChild(placeholder);
                    placeholder = null;
                }

                document.querySelectorAll('.chart-card.drag-over').forEach(el => {
                    el.classList.remove('drag-over');
                });

                draggedElement = null;
                saveChartOrder();
            });

            // Drag over
            chartsGrid.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';

                const afterElement = getDragAfterElement(chartsGrid, e.clientY);
                const dragging = chartsGrid.querySelector('.dragging');

                if (!dragging) return;

                // Move placeholder to indicate drop position
                if (placeholder) {
                    if (afterElement == null) {
                        chartsGrid.appendChild(placeholder);
                    } else {
                        chartsGrid.insertBefore(placeholder, afterElement);
                    }
                }

                // Move actual card
                if (afterElement == null) {
                    chartsGrid.appendChild(dragging);
                } else {
                    chartsGrid.insertBefore(dragging, afterElement);
                }
            });

            // Drop
            chartsGrid.addEventListener('drop', (e) => {
                e.preventDefault();
                document.querySelectorAll('.chart-card.drag-over').forEach(el => {
                    el.classList.remove('drag-over');
                });
            });

            // ========== MOBILE TOUCH DRAG ==========

            const dragHandles = chartsGrid.querySelectorAll('.drag-handle');

            dragHandles.forEach(handle => {
                // Touch start - begin long press detection
                handle.addEventListener('touchstart', (e) => {
                    const card = handle.closest('.chart-card');
                    if (!card) return;

                    touchStartY = e.touches[0].clientY;
                    touchStartX = e.touches[0].clientX;

                    // Long press to start drag (500ms)
                    longPressTimer = setTimeout(() => {
                        isTouchDragging = true;
                        draggedElement = card;
                        originalRect = card.getBoundingClientRect();

                        vibrate();
                        card.classList.add('touch-ready');

                        // Create placeholder
                        placeholder = createPlaceholder(originalRect.height);
                        card.parentNode.insertBefore(placeholder, card.nextSibling);

                        // Make card follow finger
                        card.classList.add('touch-dragging');
                        card.style.width = originalRect.width + 'px';
                        card.style.left = originalRect.left + 'px';
                        card.style.top = originalRect.top + 'px';

                        setTimeout(() => card.classList.remove('touch-ready'), 300);
                    }, 500);
                }, { passive: true });

                // Touch move
                handle.addEventListener('touchmove', (e) => {
                    if (!isTouchDragging || !draggedElement) return;

                    e.preventDefault();

                    const touch = e.touches[0];
                    const deltaY = touch.clientY - touchStartY;
                    const deltaX = touch.clientX - touchStartX;

                    // Move card with finger
                    draggedElement.style.transform = `translate(${deltaX}px, ${deltaY}px) scale(1.02)`;

                    // Determine drop position
                    const afterElement = getDragAfterElement(chartsGrid, touch.clientY);

                    if (placeholder) {
                        if (afterElement == null) {
                            chartsGrid.appendChild(placeholder);
                        } else if (afterElement !== draggedElement) {
                            chartsGrid.insertBefore(placeholder, afterElement);
                        }
                    }
                }, { passive: false });

                // Touch end
                handle.addEventListener('touchend', (e) => {
                    // Clear long press timer
                    if (longPressTimer) {
                        clearTimeout(longPressTimer);
                        longPressTimer = null;
                    }

                    if (!isTouchDragging || !draggedElement) return;

                    // Move card to placeholder position
                    if (placeholder && placeholder.parentNode) {
                        placeholder.parentNode.insertBefore(draggedElement, placeholder);
                        placeholder.parentNode.removeChild(placeholder);
                        placeholder = null;
                    }

                    // Reset card styles
                    draggedElement.classList.remove('touch-dragging');
                    draggedElement.style.width = '';
                    draggedElement.style.left = '';
                    draggedElement.style.top = '';
                    draggedElement.style.transform = '';

                    animateDrop(draggedElement);
                    vibrate();

                    isTouchDragging = false;
                    draggedElement = null;

                    saveChartOrder();
                }, { passive: true });

                // Touch cancel
                handle.addEventListener('touchcancel', () => {
                    if (longPressTimer) {
                        clearTimeout(longPressTimer);
                        longPressTimer = null;
                    }

                    if (draggedElement) {
                        draggedElement.classList.remove('touch-dragging', 'touch-ready');
                        draggedElement.style.width = '';
                        draggedElement.style.left = '';
                        draggedElement.style.top = '';
                        draggedElement.style.transform = '';
                    }

                    if (placeholder && placeholder.parentNode) {
                        placeholder.parentNode.removeChild(placeholder);
                        placeholder = null;
                    }

                    isTouchDragging = false;
                    draggedElement = null;
                }, { passive: true });
            });
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.chart-card:not(.dragging):not(.touch-dragging)')];

            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;

                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function saveChartOrder() {
            const chartsGrid = document.getElementById('chartsGrid');
            if (!chartsGrid) return;

            const order = Array.from(chartsGrid.querySelectorAll('.chart-card'))
                .map(card => card.dataset.chartId)
                .filter(Boolean);

            localStorage.setItem('chartOrder', JSON.stringify(order));
            console.log('[Charts] Saved order:', order);
        }

        // Initialize reordering after DOM is ready
        document.addEventListener('DOMContentLoaded', initChartReordering);

        init();
    </script>
</body>

</html>